import{p as l,e as j,i as b,E as T,m as F,s as g,Y as C,r as h,U as P,y as V,l as u,v as _,n as q,q as N}from"./start-C5OgI2kj.js";import{A as k}from"./index-Baxyqz_z.js";import{r as Y}from"./index-BQHPBdKf.js";import{g as W}from"./getDecorationStrategy-CCd6cq6g.js";import{a as S}from"./subscribable-Cqm5UN_u-CZjzLfrM.js";import{t as z}from"./subscribableState-Y8YW7N9Z-BMiZmink.js";import{d as w}from"./distinctUntilChanged-6npf-yF3.js";import{s as R}from"./switchMap-CzTQ1pQg.js";import{E as U}from"./mergeAll-jza3F776.js";import{d as B}from"./debounceTime-RJRE2uYN.js";import{s as G}from"./startWith-CARy4SXH.js";import{e as $}from"./RectFns-ndpeBtT0-CdOd3O5S.js";import"./async-CpPJMEP8.js";import"./AsyncScheduler-DuJTneVg.js";import"./concat-jxnVidBz.js";function H(r){return{x:r.x,y:r.y,width:r.width,height:r.height}}var I=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),A=r=>{throw TypeError(r)},E=(r,e,o)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&A("Object expected");var t;t===void 0&&(t=e[I("dispose")]),typeof t!="function"&&A("Object not disposable"),r.push([o,t,e])}return e},D=(r,e,o)=>{var t=typeof SuppressedError=="function"?SuppressedError:function(i,d,s,n){return n=Error(s),n.name="SuppressedError",n.error=i,n.suppressed=d,n},p=i=>e=o?new t(i,e,"An error was suppressed during disposal"):(o=!0,i),c=i=>{for(;i=r.pop();)try{var d=i[1]&&i[1].call(i[2]);if(i[0])return Promise.resolve(d).then(c,s=>(p(s),c()))}catch(s){p(s)}if(o)throw e};return c()};const me=r=>l(b([g(r.getExecutionScopeDefinition("document-session")),g(r.getExecutionScopeDefinition("document-group")),r.getPlugin("ui"),r.getPlugin("text-decoration"),r.getPlugin("document-session")]),j(([e,o,t,p,c])=>{var i=[];try{const n=E(i,new DisposableStack);return n.use(e.onStart(async a=>l(b([a.resolve(t.provides.MainViewContainer),a.resolve(p.provides.TextDecorationsView),a.resolve(c.provides.TextDocumentInfo),a.resolve(k),a.resolve(T)]),F(([m,f,y,O,M])=>J(m,f,y,O,M))))),n.use(o.onStart(async a=>l(b([a.resolve(c.provides.DocumentSessionManager),a.resolve(k),a.resolve(T)]),F(([m,f,y])=>K(m,f,y))))),g(n.move())}catch(n){var d=n,s=!0}finally{D(i,d,s)}}));function J(r,e,o,t,p){var c=[];try{const s=E(c,new DisposableStack),n=W(p.client),a=()=>r.add(()=>Y.createElement(e,{width:"100%",height:"100%"}),{slot:"default"});if(n==="showAllDocuments")s.use(a()),s.use(L(o,t));else if(n==="showActiveDocumentOnly")s.use(l(S(o.hasFocus),w(),R(m=>m?new C(()=>{const f=a();return()=>f[Symbol.dispose]()}):U),h())),s.use(Q(o,t));else throw new P(n);return s.move()}catch(s){var i=s,d=!0}finally{D(c,i,d)}}function K(r,e,o){var t=[];try{const i=E(t,new DisposableStack);return W(o.client)==="showActiveDocumentOnly"&&i.use(l(z(r.activeDocumentId),w(),B(500),V(d=>d===null),h(()=>{u.verbose("No active document focused - hiding current window"),v(e.hide(),d=>u.error("Unexpected error calling appWindow.hide()",d))}))),i.move()}catch(i){var p=i,c=!0}finally{D(t,p,c)}}function L(r,e){return l(x(r.geometry),h(o=>{o?v(e.setScreenRect(o),t=>u.error("Unexpected error calling appWindow.setScreenRect()",t)):v(e.hide(),t=>u.error("Unexpected error calling appWindow.hide()",t))}))}function Q(r,e){return l(S(r.hasFocus),w(),R(o=>o?x(r.geometry):U),h(o=>{o?v(e.setScreenRect(o),t=>u.error("Unexpected error calling appWindow.setScreenRect()",t)):v(e.hide(),t=>u.error("Unexpected error calling appWindow.hide()",t))}))}function x(r){return l(S(r),_(e=>e.geometry),_(e=>e?H({x:e.windowFrame.x+e.viewportFrame.x+e.documentFrame.x,y:e.windowFrame.y+e.viewportFrame.y+e.documentFrame.y,width:e.documentFrame.width,height:e.documentFrame.height}):null),G(null),w((e,o)=>e&&o?$(e,o):!e&&!o))}function v(r,e){return l(r,q(N(e)))}export{me as activate};
//# sourceMappingURL=index-BtItLJiT.js.map

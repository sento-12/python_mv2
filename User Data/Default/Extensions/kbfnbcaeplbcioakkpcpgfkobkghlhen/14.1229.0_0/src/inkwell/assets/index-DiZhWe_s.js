import{p as d,g as M,j as g,ak as T,E as k,m as F,s as y,au as C,K as S,a4 as P,v as w,U as V,z as q,A as z,l as u,w as _,q as N,r as B,av as G}from"./index-DbtAbjfk.js";import{g as W}from"./getDecorationStrategy-oPtrNUm-.js";import{d as h}from"./distinctUntilChanged-xQxyKspb.js";import{s as R}from"./switchMap-DLIF-D2S.js";import{E as U}from"./mergeAll-Ci-uq6t1.js";import{d as K}from"./debounceTime-DhvmbvtD.js";import{s as Y}from"./startWith-LiRdE3gi.js";import{e as $}from"./RectFns-ndpeBtT0-CdOd3O5S.js";import"./async-C23VpIJo.js";import"./concat-KLZEPRCF.js";var H=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),A=r=>{throw TypeError(r)},E=(r,e,o)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&A("Object expected");var t;t===void 0&&(t=e[H("dispose")]),typeof t!="function"&&A("Object not disposable"),r.push([o,t,e])}return e},D=(r,e,o)=>{var t=typeof SuppressedError=="function"?SuppressedError:function(s,l,n,i){return i=Error(n),i.name="SuppressedError",i.error=s,i.suppressed=l,i},p=s=>e=o?new t(s,e,"An error was suppressed during disposal"):(o=!0,s),c=s=>{for(;s=r.pop();)try{var l=s[1]&&s[1].call(s[2]);if(s[0])return Promise.resolve(l).then(c,n=>(p(n),c()))}catch(n){p(n)}if(o)throw e};return c()};const ce=r=>d(g([y(r.getExecutionScopeDefinition("document-session")),y(r.getExecutionScopeDefinition("document-group")),r.getPlugin("ui"),r.getPlugin("text-decoration"),r.getPlugin("document-session")]),M(([e,o,t,p,c])=>{var s=[];try{const i=E(s,new DisposableStack);return i.use(e.onStart(async a=>d(g([a.resolve(t.provides.MainViewContainer),a.resolve(p.provides.TextDecorationsView),a.resolve(c.provides.TextDocumentInfo),a.resolve(T),a.resolve(k)]),F(([m,v,b,j,x])=>I(m,v,b,j,x))))),i.use(o.onStart(async a=>d(g([a.resolve(c.provides.DocumentSessionManager),a.resolve(T),a.resolve(k)]),F(([m,v,b])=>J(m,v,b))))),y(i.move())}catch(i){var l=i,n=!0}finally{D(s,l,n)}}));function I(r,e,o,t,p){var c=[];try{const n=E(c,new DisposableStack),i=W(p.client),a=()=>r.add(()=>C.createElement(e,{width:"100%",height:"100%"}),{slot:"default"});if(i==="showAllDocuments")n.use(a()),n.use(L(o,t));else if(i==="showActiveDocumentOnly")n.use(d(S(o.hasFocus),h(),R(m=>m?new P(()=>{const v=a();return()=>v[Symbol.dispose]()}):U),w())),n.use(Q(o,t));else throw new V(i);return n.move()}catch(n){var s=n,l=!0}finally{D(c,s,l)}}function J(r,e,o){var t=[];try{const s=E(t,new DisposableStack);return W(o.client)==="showActiveDocumentOnly"&&s.use(d(q(r.activeDocumentId),h(),K(500),z(l=>l===null),w(()=>{u.verbose("No active document focused - hiding current window"),f(e.hide(),l=>u.error("Unexpected error calling appWindow.hide()",l))}))),s.move()}catch(s){var p=s,c=!0}finally{D(t,p,c)}}function L(r,e){return d(O(r.geometry),w(o=>{o?f(e.setScreenRect(o),t=>u.error("Unexpected error calling appWindow.setScreenRect()",t)):f(e.hide(),t=>u.error("Unexpected error calling appWindow.hide()",t))}))}function Q(r,e){return d(S(r.hasFocus),h(),R(o=>o?O(r.geometry):U),w(o=>{o?f(e.setScreenRect(o),t=>u.error("Unexpected error calling appWindow.setScreenRect()",t)):f(e.hide(),t=>u.error("Unexpected error calling appWindow.hide()",t))}))}function O(r){return d(S(r),_(e=>e.geometry),_(e=>e?G({x:e.windowFrame.x+e.viewportFrame.x+e.documentFrame.x,y:e.windowFrame.y+e.viewportFrame.y+e.documentFrame.y,width:e.documentFrame.width,height:e.documentFrame.height}):null),Y(null),h((e,o)=>e&&o?$(e,o):!e&&!o))}function f(r,e){return d(r,N(B(e)))}export{ce as activate};
//# sourceMappingURL=index-DiZhWe_s.js.map

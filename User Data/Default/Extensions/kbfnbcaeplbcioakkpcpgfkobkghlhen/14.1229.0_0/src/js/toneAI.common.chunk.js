(self.webpackChunk=self.webpackChunk||[]).push([[7725],{74407:(e,t,i)=>{i.r(t),i.d(t,{ToneAIFeature:()=>w});var n=i(39953),s=i(68717),r=i(8867),l=i(32073),o=i(90572),a=i(59179),u=i(29416),d=i(954),A=i(78129),c=i(10883),b=i(68545),g=i(48922),_=i(31854),p=i(42596),T=i(9761),h=i(52303),I=i(58303),v=i(11456),U=i(79992);class w{constructor(e,t,i){this._alertStateService=e,this._getSessionUuid=t,this._gnar=i}initSingleCardAssistantActionsProcessing(e,t){return new r.y((()=>{const i=new l.w0;return this._subscribeToCommonActions(e,t,i),()=>i.unsubscribe()}))}initAssistantCardActionsProcessing(e,t,i,s,b){return new r.y((()=>{const r=new l.w0;this._subscribeToCommonActions(t,b,r),r.add(w._getToneAIAlertObservable(s.pipe(o.h(p.i.isToneAIItem),a.U((e=>e.activeAlert.id))),t).subscribe((e=>{this._gnar.toneAIAssistantMiniCardShow(this._getSessionUuidValue(),w._getToneRewriteType(e))}))),r.add(w._getToneAIAlertObservable(e.pipe(o.h(_.lY.isAlertCardShow),a.U((e=>e.alertId))),t).pipe(u.b(300)).subscribe((e=>{this._gnar.toneAIAssistantFullCardShow(this._getSessionUuidValue(),w._getToneRewriteType(e))}))),r.add(w._getToneAIAlertObservable(e.pipe(o.h(_.lY.isAlertApplyAction),a.U((e=>e.alertId))),t).subscribe((e=>{this._gnar.toneAIAssistantFullCardReplacementApply(this._getSessionUuidValue(),w._getToneRewriteType(e))}))),w._subscribeToMuteOrUndoMuteButtonClick(r,e,i,t,_.lY.isMuteCategoryAction,(e=>{this._gnar.toneAIAssistantFullCardMuteButtonClick(this._getSessionUuidValue(),w._getToneRewriteType(e))})),w._subscribeToMuteOrUndoMuteButtonClick(r,e,i,t,_.lY.isUndoMuteCategoryAction,(e=>{this._gnar.toneAIAssistantFullCardUndoMuteButtonClick(this._getSessionUuidValue(),w._getToneRewriteType(e))}));const g=e.pipe(o.h(_.lY.isToneAIChangeToneAlternativeAction));return r.add(g.pipe(d.O(null),A.G(),o.h((([e,t])=>(null==e?void 0:e.selectedToneAlternativeIdx)!==(null==t?void 0:t.selectedToneAlternativeIdx))),a.U((([e,t])=>{var i,n;return{oldToneAlternativeIdx:null!==(i=null==e?void 0:e.selectedToneAlternativeIdx)&&void 0!==i?i:null,newToneAlternativeIdx:null!==(n=null==t?void 0:t.selectedToneAlternativeIdx)&&void 0!==n?n:null}})),c.M(w._getToneAIAlertObservable(g.pipe(a.U((e=>e.alertId))),t))).subscribe((([{oldToneAlternativeIdx:e,newToneAlternativeIdx:t},i])=>(0,n.zG)(i.extraProperties.toneAI,h.bw((n=>{this._gnar.toneAIAssistantFullCardSliderMove(null!==t?n.toneAlternatives[t].name:"",null!==e?n.toneAlternatives[e].name:"",this._getSessionUuidValue(),w._getToneRewriteType(i))})))))),r.add(w._getToneAIAlertObservable(e.pipe(o.h(_.lY.isAlertIgnoreAction),a.U((e=>e.alertId))),t).subscribe((e=>{this._gnar.toneAIAssistantFullCardDismissButtonClick(this._getSessionUuidValue(),w._getToneRewriteType(e))}))),()=>r.unsubscribe()}))}_subscribeToCommonActions(e,t,i){i.add(this._alertStateService.newlyHighlightedAlerts.pipe(o.h(v.S.isToneAIAlert)).subscribe((e=>{this._gnar.toneAIAlertUnderlineShow(this._getSessionUuidValue(),w._getToneRewriteType(e))}))),i.add(w._getToneAIAlertObservable(t.pipe(o.h(g.$.isToneAI),a.U((e=>e.id))),e).subscribe((e=>{this._gnar.toneAIAlertUnderlineClick(this._getSessionUuidValue(),w._getToneRewriteType(e))})))}_getSessionUuidValue(){return(0,n.zG)(this._getSessionUuid(),I.fS((()=>"")))}static _getToneRewriteType(e){return`${e.patternName.split("/").slice(2).join("/")}${e.patternNameQualifier?`_${e.patternNameQualifier}`:""}`}static _subscribeToMuteOrUndoMuteButtonClick(e,t,i,s,r,l){e.add(w._getToneAIAlertObservable(t.pipe(o.h(r),c.M(i),a.U((([e,t])=>T.nL.hasItems(t)?(0,n.zG)(t.currentLens.items.get(e.id),I.g_((()=>null),(e=>e.value))):null)),o.h(U.fQ),o.h(p.i.isToneAIItem),a.U((e=>e.activeAlert.id))),s).subscribe(l))}static _getToneAIAlertObservable(e,t){return e.pipe(a.U(t.getById),b.oA,o.h(s.bZ.isToneAI))}}},68545:(e,t,i)=>{i.d(t,{cp:()=>o,oA:()=>a});var n=i(58303),s=i(20161),r=i(24666),l=i(36344);function o(e){return(0,s.w)(n.g_((()=>l.E),e))}const a=o(i(84714).of);(0,r.x)(((e,t)=>n.Wi(e)&&n.Wi(t)||n.pC(e)&&n.pC(t)))}}]);
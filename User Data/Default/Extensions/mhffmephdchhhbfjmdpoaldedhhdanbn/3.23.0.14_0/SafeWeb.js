((t,e)=>{"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SafeWeb=e():t.SafeWeb=e()})(this,()=>{{function i(t,a,u,c){return new(u=u||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((c=c.apply(t,a||[])).next())})}function a(r,o){var i,a,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},s={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=s&&e[s=0]?0:c;)try{if(i=1,a&&(u=2&e[0]?a.return:e[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,e[1])).done)return u;switch(a=0,(e=u?[2&e[0],u.value]:e)[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!((u=0<(u=c.trys).length&&u[u.length-1])||6!==e[0]&&2!==e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3]))c.label=e[1];else if(6===e[0]&&c.label<u[1])c.label=u[1],u=e;else{if(!(u&&c.label<u[2])){u[2]&&c.ops.pop(),c.trys.pop();continue}c.label=u[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],a=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}var u={d:(t,e)=>{for(var n in e)u.o(e,n)&&!u.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},c={},S=(u.d(c,{default:()=>o}),Object.defineProperty(s,"HTTP_PROTOCOL",{get:function(){return"http:"},enumerable:!1,configurable:!0}),Object.defineProperty(s,"HTTPS_PROTOCOL",{get:function(){return"https:"},enumerable:!1,configurable:!0}),Object.defineProperty(s,"SECURE_BROWSER",{get:function(){return{APP_TYPE:"SECURE_BROWSER_APP",RATINGS:{UNKNOWN:"unknown",CLEAN:"clean",MALWARE:"malware",PHISHING:"phishing"},SECURE_BROWSER_RATINGS_TO_SW_RATINGS_MAP:{unknown:2,clean:1,malware:5,phishing:3}}},enumerable:!1,configurable:!0}),Object.defineProperty(s,"URLITE",{get:function(){return{APP_TYPE:"URLITE",URL:"https://urlite.ff.avast.com/v1/urlinfo",RATINGS:{MALWARE:"MALWARE",PHISHING:"PHISHING",CLEAN:"CLEAN",REGIONAL_BLOCK:"REGIONAL_BLOCK"},URLITE_RATINGS_TO_SW_RATINGS_MAP:{MALWARE:3,PHISHING:2,CLEAN:1,REGIONAL_BLOCK:4}}},enumerable:!1,configurable:!0}),Object.defineProperty(s,"RATING_TYPE",{get:function(){return{SAFEWEB:3}},enumerable:!1,configurable:!0}),Object.defineProperty(s,"JAPAN_LOCALE",{get:function(){return"ja"},enumerable:!1,configurable:!0}),s);function s(){}f.prototype.getRatingsForURLs=function(t){return i(this,void 0,void 0,function(){return a(this,function(t){throw new Error("Derived class needs to implement this function")})})},f.prototype.getRatingForURL=function(t){return i(this,void 0,void 0,function(){return a(this,function(t){throw new Error("Derived class needs to implement this function")})})};var l=f;function f(){}function _(t,a,u,c){return new(u=u||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((c=c.apply(t,a||[])).next())})}function R(r,o){var i,a,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},s={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=s&&e[s=0]?0:c;)try{if(i=1,a&&(u=2&e[0]?a.return:e[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,e[1])).done)return u;switch(a=0,(e=u?[2&e[0],u.value]:e)[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!((u=0<(u=c.trys).length&&u[u.length-1])||6!==e[0]&&2!==e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3]))c.label=e[1];else if(6===e[0]&&c.label<u[1])c.label=u[1],u=e;else{if(!(u&&c.label<u[2])){u[2]&&c.ops.pop(),c.trys.pop();continue}c.label=u[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],a=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}T.prototype.safeURL=function(t){t=new URL(t);return"".concat(t.protocol,"//").concat(t.hostname).concat(t.pathname)},T.prototype.getNormalizedUrl=function(t){return new URL(t).hostname};var p,N=new T;p=function(t,e){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};var E,E=(E=globalThis).SymBfw,h,M=(h=E.utils).isArray,x=h.isNil,A=h.isString,j=h.createNewGuid,D=E.secureBrowserWrapper,h,K=(h=S.SECURE_BROWSER).RATINGS,V=h.SECURE_BROWSER_RATINGS_TO_SW_RATINGS_MAP;function T(){}let e=(t=>{function e(){return null!==t&&t.apply(this,arguments)||this}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return p(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.getRatingsForURLs=function(n){return _(this,void 0,void 0,function(){var e=this;return R(this,function(t){switch(t.label){case 0:return M(n)?[4,Promise.all(n.map(function(n){return _(e,void 0,void 0,function(){var e;return R(this,function(t){switch(t.label){case 0:return e=N.safeURL(n),[4,this.getRatingForUrl(e)];case 1:return e=t.sent(),x(e)?[2,null]:[2,this._getSafeWebRatingObject(n,e)]}})})}))]:[2];case 1:return[2,t.sent()]}})})},e.prototype.getRatingForUrl=function(e){return _(this,void 0,void 0,function(){return R(this,function(t){switch(t.label){case 0:return A(e)?[4,D.getRatingForUrl(e)]:[2];case 1:return[2,t.sent()]}})})},e.prototype._getNormalizedUrl=function(t){if(A(t))return new URL(t).hostname},e.prototype._getSafeWebRatingObject=function(t,e){return{siteRating:V[e]||V[K.UNKNOWN],fullURL:t,normalizedURL:this._getNormalizedUrl(t),id:j(),showFullReport:!1}},e})(l);function z(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var J={UNKNOWN_TYPE:0,URL:1,HOST:2,URL_LIKE:3},O={0:"OTHER_BLACKLIST",1:"VIRUSLAB_URL_BLOCK",2:"MAILSHELL",3:"APWG",4:"OPEN_PHISH",5:"PHISH_TANK",6:"PT_REALTIME",7:"VIRUSLAB_PHISHING",8:"VIRUSLAB_IOT_BOTNET",9:"VIRUSLAB_UNIFIED",10:"GOOGLE_PHISHING",11:"GOOGLE_MALWARE",13:"GOOGLE_UNIFIED",14:"IPADDR_BLACKLIST_UNIFIED",15:"RULESPACE",17:"URL_INFO_CATEGORIES",18:"GEO_BLOCKLIST_JAPAN",16:"URL_PATTERN",12:"DEBUG"},y={0:"OTHER_FINDING",1:"MALWARE",2:"PHISHING",3:"BOTNET_CNC",4:"BOTNET_ZOMBIE",5:"TYPOSQUATTING",6:"GOVERNMENTAL_BLOCK",7:"ESHOP_SCAM"},q={0:"CATEGORY_INVALID",1:"CATEGORY_ART",2:"CATEGORY_BUSINESS",3:"CATEGORY_BUSINESS_SERVICES",4:"CATEGORY_CARS",5:"CATEGORY_CELEBRITY",6:"CATEGORY_DO_NOT_SHOW",7:"CATEGORY_DOWNLOADS",8:"CATEGORY_DRUGS",9:"CATEGORY_EDUCATION",10:"CATEGORY_ENERGY",11:"CATEGORY_FINANCE",12:"CATEGORY_FOOD",13:"CATEGORY_GAME",14:"CATEGORY_GLAMOUR",15:"CATEGORY_GOVERNMENT",16:"CATEGORY_GROSS",17:"CATEGORY_HACKING",18:"CATEGORY_HATE",19:"CATEGORY_HEALTH",20:"CATEGORY_HOBBIES",21:"CATEGORY_JOB_SEARCH",22:"CATEGORY_KID_FRIENDLY",23:"CATEGORY_LAW",24:"CATEGORY_MAGIC",25:"CATEGORY_MALWARE",26:"CATEGORY_MESSAGING",27:"CATEGORY_MILITARY",28:"CATEGORY_MOVIES",29:"CATEGORY_MUSIC",30:"CATEGORY_NEWS",31:"CATEGORY_NUDITY",32:"CATEGORY_OTHER",33:"CATEGORY_PETS",34:"CATEGORY_PHOTOGRAPHY",35:"CATEGORY_PORNOGRAPHY",36:"CATEGORY_REAL_ESTATE",37:"CATEGORY_SEARCH_ENGINES",38:"CATEGORY_SELFHARM",39:"CATEGORY_SEXUAL",40:"CATEGORY_SHOPPING",41:"CATEGORY_SOCIAL",42:"CATEGORY_SPORTS",43:"CATEGORY_TECHNOLOGY",44:"CATEGORY_TRAVEL",45:"CATEGORY_UNKNOWN",46:"CATEGORY_VIDEO",47:"CATEGORY_VIOLENCE",48:"CATEGORY_VIOLENCE_SEXUAL_CONTENT",49:"CATEGORY_WEDDINGS"},X={0:"DI_UNKNOWN",1:"DI_CLEAN",2:"DI_PARTIALLY_INFECTED",3:"DI_INFECTED"},Z={0:"URL_INFO_CATEGORY_INVALID",1:"URL_INFO_CATEGORY_DATING",2:"URL_INFO_CATEGORY_PORN",3:"URL_INFO_CATEGORY_BANK"},Q={UNKNOWN:0,JP:1};function $(t){var e={};t:for(;!I(t);){var n=P(t);switch(n>>>3){case 0:break t;case 1:e.key=v(t,P(t));break;case 2:e.error=v(t,P(t));break;case 3:var r=e.findings||(e.findings=[]);if(2==(7&n)){for(var o=b(t);!I(t);)r.push(y[P(t)]);t.limit=o}else r.push(y[P(t)]);break;case 4:if(r=e.matched||(e.matched=[]),2==(7&n)){for(o=b(t);!I(t);)r.push(O[P(t)]);t.limit=o}else r.push(O[P(t)]);break;case 5:e.hint_block_incoming=!!C(t);break;case 6:e.hint_block_outgoing=!!C(t);break;case 7:if(r=e.categories||(e.categories=[]),2==(7&n)){for(o=b(t);!I(t);)r.push(q[P(t)]);t.limit=o}else r.push(q[P(t)]);break;case 8:if(r=e.dry_runs||(e.dry_runs=[]),2==(7&n)){for(o=b(t);!I(t);)r.push(y[P(t)]);t.limit=o}else r.push(y[P(t)]);break;case 9:e.domain_info=X[P(t)];break;case 10:e.incomplete=!!C(t);break;case 11:(r=e.warnings||(e.warnings=[])).push(v(t,P(t)));break;case 12:var i=b(t);(r=e.detections||(e.detections=[])).push((t=>{var e={};e:for(;!I(t);){var n=P(t);switch(n>>>3){case 0:break e;case 1:e.name=v(t,P(t));break;case 2:e.active=!!C(t);break;case 3:e.finding=y[P(t)];break;case 4:e.blacklist=O[P(t)];break;default:d(t,7&n)}}return e})(t)),t.limit=i;break;case 13:if(r=e.urlinfo_categories||(e.urlinfo_categories=[]),2==(7&n)){for(o=b(t);!I(t);)r.push(Z[P(t)]);t.limit=o}else r.push(Z[P(t)]);break;default:d(t,7&n)}}return e}function b(t){var e=P(t),n=t.limit;return t.limit=t.offset+e,n}function d(t,e){switch(e){case 0:for(;128&C(t););break;case 2:g(t,P(t));break;case 5:g(t,4);break;case 1:g(t,8);break;default:throw new Error("Unimplemented type: "+e)}}var E=new Float32Array(1),h=(new Uint8Array(E.buffer),new Float64Array(1)),tt=(new Uint8Array(h.buffer),[]);function G(){var t=tt.pop();return t?(t.offset=t.limit=0,t):{bytes:new Uint8Array(64),offset:0,limit:0}}function et(t){tt.push(t)}function g(t,e){if(t.offset+e>t.limit)throw new Error("Skip past limit");t.offset+=e}function I(t){return t.offset>=t.limit}function L(t,e){var n,r=t.bytes,o=t.offset,i=t.limit,e=o+e;return e>r.length&&((n=new Uint8Array(2*e)).set(r),t.bytes=n),i<(t.offset=e)&&(t.limit=e),o}function nt(t,e){var n=t.offset;if(t.limit<n+e)throw new Error("Read past limit");return t.offset+=e,n}function v(t,e){for(var n=nt(t,e),r=String.fromCharCode,o=t.bytes,i="",a=0;a<e;a++){var u=o[a+n],c=void 0,s=void 0,l=void 0,f=void 0;128&u?192==(224&u)?e<=a+1||128!=(192&(c=o[a+n+1]))||(f=(31&u)<<6|63&c)<128?i+="�":(i+=r(f),a++):224==(240&u)?e<=a+2||32896!=(49344&((c=o[a+n+1])|(s=o[a+n+2])<<8))||(f=(15&u)<<12|(63&c)<<6|63&s)<2048||55296<=f&&f<=57343?i+="�":(i+=r(f),a+=2):240!=(248&u)||e<=a+3||8421504!=(12632256&((c=o[a+n+1])|(s=o[a+n+2])<<8|(l=o[a+n+3])<<16))||(f=(7&u)<<18|(63&c)<<12|(63&s)<<6|63&l)<65536||1114111<f?i+="�":(i+=r(55296+((f-=65536)>>10),56320+(1023&f)),a+=3):i+=r(u)}return i}function rt(t,e){for(var n=L(t,e.limit),r=t.bytes,o=e.bytes,i=0,a=e.limit;i<a;i++)r[i+n]=o[i]}function C(t){return t.bytes[nt(t,1)]}function w(t,e){var n=L(t,1);t.bytes[n]=e}function P(t){for(var e,n=0,r=0;e=C(t),n<32&&(r|=(127&e)<<n),n+=7,128&e;);return r}function U(t,e){for(e>>>=0;128<=e;)w(t,127&e|128),e>>>=7;w(t,e)}function m(t,a,u,c){return new(u=u||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((c=c.apply(t,a||[])).next())})}function Y(r,o){var i,a,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},s={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=s&&e[s=0]?0:c;)try{if(i=1,a&&(u=2&e[0]?a.return:e[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,e[1])).done)return u;switch(a=0,(e=u?[2&e[0],u.value]:e)[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!((u=0<(u=c.trys).length&&u[u.length-1])||6!==e[0]&&2!==e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3]))c.label=e[1];else if(6===e[0]&&c.label<u[1])c.label=u[1],u=e;else{if(!(u&&c.label<u[2])){u[2]&&c.ops.pop(),c.trys.pop();continue}c.label=u[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],a=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}W=function(t,e){return(W=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};var B,W,E=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},h,ot=(h=globalThis.SymBfw).localizer,it=h.logger,h,at=(h=h.utils).safeFetch,ut=h.createNewGuid,ct=h.isEmptyObject;function H(){return null!==B&&B.apply(this,arguments)||this}E(H,B=l),H.prototype.getRatingForURL=function(n){return m(this,void 0,void 0,function(){var e;return Y(this,function(t){switch(t.label){case 0:return[4,this.getRatingsForURLs([n])];case 1:return[2,(e=t.sent())?e[0]:null]}})})},H.prototype.getRatingsForURLs=function(r){return m(this,void 0,void 0,function(){var e,n=this;return Y(this,function(t){switch(t.label){case 0:return[4,this._getRatings(r)];case 1:return!(e=t.sent())||ct(e)?[2,null]:[2,e.answers.map(function(t,e){return n._getSafeWebRatingObject(r[e],t)})]}})})},H.prototype._getSafeWebRatingObject=function(t,e){return{siteRating:this._getSafewebRatingType(e),fullURL:t,normalizedURL:N.getNormalizedUrl(t),id:ut(),showFullReport:!1}},H.prototype._getSafewebRatingType=function(t){return this._isMalware(t)?S.URLITE.URLITE_RATINGS_TO_SW_RATINGS_MAP[S.URLITE.RATINGS.MALWARE]:this._isRegionalBlock(t)?S.URLITE.URLITE_RATINGS_TO_SW_RATINGS_MAP[S.URLITE.RATINGS.REGIONAL_BLOCK]:this._isPhishing(t)?S.URLITE.URLITE_RATINGS_TO_SW_RATINGS_MAP[S.URLITE.RATINGS.PHISHING]:S.URLITE.URLITE_RATINGS_TO_SW_RATINGS_MAP[S.URLITE.RATINGS.CLEAN]},H.prototype._getRatings=function(n){return m(this,void 0,void 0,function(){var e;return Y(this,function(t){switch(t.label){case 0:return e=this._getBody(n),[4,this._fetchRatings(e)];case 1:return[2,t.sent()]}})})},H.prototype._getBody=function(t){var e,n,r,o,t={save_url_feed:!1,queries:t.map(function(t){return{key:t=N.safeURL(t),key_type:"URL",include_domain_info:!1,do_not_track:!1}})},i=(ot.getNavigatorLanguage().split("-")[0]===S.JAPAN_LOCALE&&(t.include_geo_blocklists=["JP"]),t=t,e=G(),t),a=e,t=i.queries;if(void 0!==t)try{for(var u=z(t),c=u.next();!c.done;c=u.next()){var s=c.value,l=(U(a,10),G()),f=(_=f=void 0,s),_=l,R=((O=b=y=T=A=h=E=p=R=void 0)!==(R=f.do_not_track)&&(U(_,32),w(_,R?1:0)),f.key);if(void 0!==R){U(_,10);for(var p=_,E=R,h=E.length,A=0,T=0;T<h;T++)A+=(O=55296<=(O=E.charCodeAt(T))&&O<=56319&&T+1<h?(O<<10)+E.charCodeAt(++T)-56613888:O)<128?1:O<2048?2:O<65536?3:4;U(p,A);for(var O,y=L(p,A),b=p.bytes,T=0;T<h;T++)(O=55296<=(O=E.charCodeAt(T))&&O<=56319&&T+1<h?(O<<10)+E.charCodeAt(++T)-56613888:O)<128?b[y++]=O:(O<2048?b[y++]=O>>6&31|192:(O<65536?b[y++]=O>>12&15|224:(b[y++]=O>>18&7|240,b[y++]=O>>12&63|128),b[y++]=O>>6&63|128),b[y++]=63&O|128)}void 0!==(R=f.key_type)&&(U(_,16),U(_,J[R])),void 0!==(p=f.include_domain_info)&&(U(_,40),w(_,p?1:0)),U(a,l.limit),rt(a,l),et(l)}}catch(i){n={error:i}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(n)throw n.error}}void 0!==(t=i.save_url_feed)&&(U(a,16),w(a,t?1:0));var d=i.include_geo_blocklists;if(void 0!==d){var g=G();try{for(var I=z(d),v=I.next();!v.done;v=I.next())s=v.value,U(g,Q[s])}catch(i){r={error:i}}finally{try{v&&!v.done&&(o=I.return)&&o.call(I)}finally{if(r)throw r.error}}U(a,26),U(a,g.offset),rt(a,g),et(g)}return n=e.bytes,t=e.limit,n.length===t?n:n.subarray(0,t)},H.prototype._fetchRatings=function(o){return m(this,void 0,void 0,function(){var n,r;return Y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,at(S.URLITE.URL,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:o})];case 1:return[4,t.sent().arrayBuffer()];case 2:return n=t.sent(),[3,4];case 3:return r=t.sent(),it.error(r),[2,null];case 4:return[2,(t=>{var e={};t:for(;!I(t);){var n=P(t);switch(n>>>3){case 0:break t;case 1:var r=b(t);(e.answers||(e.answers=[])).push($(t)),t.limit=r;break;default:d(t,7&n)}}return e})({bytes:e=new Uint8Array(n),offset:0,limit:e.length})]}var e})})},H.prototype._isPhishing=function(t){return this._hasFinding(t,"PHISHING")},H.prototype._isMalware=function(t){return this._hasFinding(t,"MALWARE","BOTNET_ZOMBIE","BOTNET_CNC")},H.prototype._isRegionalBlock=function(t){return this._hasFinding(t,"GOVERNMENTAL_BLOCK")},H.prototype._hasFinding=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return null==(t=t.findings)?void 0:t.some(function(e){return n.some(function(t){return t===e})})};let n=H,r=(Object.defineProperty(st,"APP_CONFIG",{get:function(){return{APP_TYPE_KEY:"appType",APP_TYPES:{SECURE_BROWSER:"secureBrowser",URLITE:"urlite"}}},enumerable:!1,configurable:!0}),st);function st(){}function lt(t,a,u,c){return new(u=u||Promise)(function(n,e){function r(t){try{i(c.next(t))}catch(t){e(t)}}function o(t){try{i(c.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((c=c.apply(t,a||[])).next())})}function ft(r,o){var i,a,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},s={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function t(n){return function(t){var e=[n,t];if(i)throw new TypeError("Generator is already executing.");for(;c=s&&e[s=0]?0:c;)try{if(i=1,a&&(u=2&e[0]?a.return:e[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,e[1])).done)return u;switch(a=0,(e=u?[2&e[0],u.value]:e)[0]){case 0:case 1:u=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,a=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!((u=0<(u=c.trys).length&&u[u.length-1])||6!==e[0]&&2!==e[0])){c=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3]))c.label=e[1];else if(6===e[0]&&c.label<u[1])c.label=u[1],u=e;else{if(!(u&&c.label<u[2])){u[2]&&c.ops.pop(),c.trys.pop();continue}c.label=u[2],c.ops.push(e)}}e=o.call(r,c)}catch(t){e=[6,t],a=0}finally{i=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}var _t=globalThis.SymBfw.utils.isArray;function k(){}k.prototype.init=function(t){switch(t.appType){case r.APP_CONFIG.APP_TYPES.SECURE_BROWSER:this._reputationEngineObject=new e;break;case r.APP_CONFIG.APP_TYPES.URLITE:this._reputationEngineObject=new n}},k.prototype.getSafeWebRating=function(n,r){return lt(this,void 0,void 0,function(){var e;return ft(this,function(t){switch(t.label){case 0:return[4,this._reputationEngineObject.getRatingForURL(n)];case 1:return e=t.sent(),r(e),[2]}})})},k.prototype.getSafeWebRatings=function(r,o,i){return lt(this,void 0,void 0,function(){var n,e;return ft(this,function(t){switch(t.label){case 0:return 0===o.length?(i([]),[2]):[4,this._reputationEngineObject.getRatingsForURLs(o)];case 1:return n=t.sent(),_t(n)?(e=r.map(function(e){var t=o.findIndex(function(t){return t===e});return-1===t?null:n[t]}),i(e)):i([]),[2]}})})};let t=k;var Rt=globalThis.SymBfw.logger;let o={manager:(F.prototype.getRatingForURL=function(t,e){this._validateURL(t)?this._reputationEngineController.getSafeWebRating(t,e):e(null)},F.prototype.getRatingsForURLs=function(t,e,n){var r=this,o=t.filter(function(t){return!0===r._validateURL(t)});this._reputationEngineController.getSafeWebRatings(t,o,e)},F.prototype._validateURL=function(t){var e;try{e=new URL(t)}catch(t){return Rt.debug("Invalid url ".concat(t)),!1}return e.protocol===S.HTTP_PROTOCOL||e.protocol===S.HTTPS_PROTOCOL},F.prototype.init=function(t){this._reputationEngineController.init(t)},new F),Rating:(Object.defineProperty(pt,"SITE_RATING",{get:function(){return{RATING_UNKNOWN:0,RATING_SAFE:1,RATING_PHISHING:2,RATING_MALWARE:3,RATING_REGIONAL_BLOCK:4,RATING_FORMJACK_STATE:5}},enumerable:!1,configurable:!0}),pt),Config:r,constants:S};function pt(){}function F(){this._reputationEngineController=new t}return c.default}});
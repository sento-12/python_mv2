(()=>{var e=new class{get quickLinksData(){return{amazon:{name:"amazon",toolTipName:"Amazon",associateUrl:"https://nortontiles.ampxdirect.com?partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=74301&source=als_tiles",domain:"amazon",regionsON:["en-US"],impressionUrl:"https://imp.mt48.net/static?v=2&partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=74301&adv-id=74301"},"amazon-intl":{name:"amazon-intl",toolTipName:"Amazon",associateUrl:"https://nortontiles.ampxdirect.com?partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=74357&source=als_tiles",domain:"amazon",regionsOFF:["en-US"],impressionUrl:"https://imp.mt48.net/static?v=2&partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=74357&adv-id=74357"},walmart:{name:"walmart",toolTipName:"Walmart",associateUrl:"https://redirect.viglink.com?key=e39418fea5d725c6aa9070835ec4997b&u=https%3A%2F%2Fwalmart.com",domain:"walmart"},tripadvisor:{name:"tripadvisor",toolTipName:"Tripadvisor",associateUrl:"https://redirect.viglink.com?key=e39418fea5d725c6aa9070835ec4997b&u=https%3A%2F%2Ftripadvisor.com",domain:"tripadvisor"},nordstrom:{name:"nordstrom",toolTipName:"Nordstrom",associateUrl:"https://redirect.viglink.com/?key=e39418fea5d725c6aa9070835ec4997b&u=https%3A%2F%2Fshop.nordstrom.com%2F%0D%0A",domain:"nordstrom",regionsOFF:["en-US"]},booking:{name:"booking",toolTipName:"Booking.com",associateUrl:"https://www.awin1.com/awclick.php?mid=6776&id=1146969",domain:"booking"},turbotax:{name:"turbotax",toolTipName:"TurboTax",associateUrl:"https://nortontiles.ampxdirect.com?partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=73780&source=als_tiles",domain:"turbotax",regionsON:["en-US"],impressionUrl:"https://imp.mt48.net/static?v=2&partner=nortontiles&sub1=10142&sub2=searchsafe&sub3=73780&adv-id=73780"}}}get quickLinksReq(){return[{name:"amazon",dynamic:!1},{name:"amazon-intl"},{name:"walmart"},{name:"tripadvisor"},{name:"nordstrom"},{name:"booking"},{name:"turbotax"}]}};NSSS.quickLinksConfig=e})(),(()=>{var e=new class{constructor(){this.abTestImpls={}}registerABTestImpl(e,t){this.abTestImpls[e]=t}};NSSS.abTestingAppsRepo=e})(),NSSS.GoogleAppsConfig=class{static get config(){return[{name:"Account",spriteImagePosition:"0 -1585px",url:"https://myaccount.google.com/"},{name:"Maps",spriteImagePosition:"0 -483px",url:"https://maps.google.com"},{name:"Play",spriteImagePosition:"0 -207px",url:"https://play.google.com/"},{name:"Drive",spriteImagePosition:"0 -2967px",url:"https://drive.google.com/"},{name:"Calendar",spriteImagePosition:"0 -2553px",url:"https://calendar.google.com/"},{name:"News",spriteImagePosition:"0 -1311px",url:"https://news.google.com/"},{name:"Translate",spriteImagePosition:"0 -1932px",url:"https://translate.google.com/"},{name:"Photos",spriteImagePosition:"0 -2829px",url:"https://photos.google.com/"},{name:"Chat",spriteImagePosition:"0 -1656px",url:"https://chat.google.com/"},{name:"Duo",spriteImagePosition:"0 -2484px",url:"https://duo.google.com/"},{name:"Meet",spriteImagePosition:"0 -690px",url:"https://meet.google.com"},{name:"Docs",spriteImagePosition:"0 -1242px",url:"https://docs.google.com/document/"},{name:"Contacts",spriteImagePosition:"0 -2898px",url:"https://contacts.google.com/"},{name:"Classroom",spriteImagePosition:"0 -966px",url:"https://classroom.google.com/"}]}static get GOOGLE_APPS_TOUR_DATA(){return{APPS_TEST_2022_1_TEST_TRACK:{key:"google_apps",positionCSS:" tooltip-position-google-apps ",titleText:"Link to your apps",descriptionText:"Access your apps quickly and easily from your Norton Home Page.",toolTipCss:"tour-tooltip-container-google-apps",tourOrderIndex:5},APPS_TEST_2022_1_CONTROL_TRACK:{}}}static get TEST_ID(){return"APPS_TEST_2022_1"}},(()=>{let{uiConstants:{MESSAGES:s},globalSettings:a,GoogleAppsConfig:i,telemetryWrapper:n,telemetryTrackerClient:o,trackerLogger:r,uiConstants:l}=NSSS,{utils:{isNil:c,isntNil:g},logger:S,localizer:t,telemetryConstants:e}=SymBfw,d=SymBfw.extensionAdapter;NSSS.googleAppsManager=new class{constructor(){this.messageListener=this.messageListener.bind(this)}_getAppsDataBasedOnVariant(e){return{APPS_TEST_2022_1_TEST_TRACK:{data:{configs:i.config,strings:NSSS.uiConstants.HOMEPAGE.googleApps.strings}},APPS_TEST_2022_1_CONTROL_TRACK:{data:{}}}[e]}getDefaultAppsData(){var e=NSSS.uiConstants.HOMEPAGE.googleApps.strings,e=(e.moreAppsText=t.getLocalizedString(e.moreAppsText),i.config),e=(e.forEach(e=>{e.name=t.getLocalizedString(e.name)}),{configs:e,strings:NSSS.uiConstants.HOMEPAGE.googleApps.strings});return e}getAppsData(e){var t=this._getAppsDataBasedOnVariant(e);return g(t)&&0!==Object.keys(t.data).length&&(t.key=l.HomepageTourSteps.GOOGLE_APPS,t.variantId=e,t.testId=i.TEST_ID),t}getTourData(e){return i.GOOGLE_APPS_TOUR_DATA[e]}_handleGoogleAppClicked(e,t){d.createTab(t),n.sendGoogleAppsClickEvent(e),o.sendGoogleAppsClickEvent(e),a.setGoogleAppsClickedValue(!0)}_handleGoogleAppsPopupShown(){n.sendGoogleAppsPopupShownEvent(),o.sendGoogleAppsPopupShownEvent()}_handleMoreGoogleAppsIconClicked(){d.createTab("https://about.google/products/?tab=rh#all-products"),n.sendMoreGoogleAppsClickEvent(),o.sendMoreGoogleAppsClickEvent()}messageListener(e){if(c(e))S.error("Request cannot be null"),r.logEvent(r.LOG_TYPE.ERROR,"Request cannot be null");else{var t=e.name,a=e.message;switch(t){case s.GOOGLE_APP_CLICKED:c(a)||c(a.appName)||c(a.url)||this._handleGoogleAppClicked(a.appName,a.url);break;case s.MORE_GOOGLE_APPS_CLICKED:this._handleMoreGoogleAppsIconClicked();break;case s.GOOGLE_APPS_POPUP_SHOWN:this._handleGoogleAppsPopupShown()}}}getAppliedVariant(){var e=i.TEST_ID;return NSSS.abTestingDataProvider.getApplicableVariantForTestId(e)}_getGoogleAppVariantCustomDimesion(){if(!c(this.getAppliedVariant()))return{[e.parameters.CUSTOM_DIMENSION21]:()=>this.getAppliedVariant()}}_getGoogleAppsUsageCustomDimesion(){return{[e.parameters.CUSTOM_DIMENSION20]:()=>this.getAndResetGoogleAppsClickedValue()}}getHeartBeatPingCustomDimesions(){return{...this._getGoogleAppVariantCustomDimesion(),...this._getGoogleAppsUsageCustomDimesion()}}getTelemetryDataForHeartBeat(){return{...this._getGoogleAppsUsageCustomDimesion()}}getInstallPingCustomDimensions(){return this._getGoogleAppVariantCustomDimesion()}getAndResetGoogleAppsClickedValue(){let e=a.getGoogleAppsClickedValue();return c(e)&&(e=!1),a.setGoogleAppsClickedValue(!1),e}},NSSS.abTestingAppsRepo.registerABTestImpl(i.TEST_ID,NSSS.googleAppsManager),NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.googleAppsManager),d.addMessageListener(NSSS.googleAppsManager.messageListener)})(),(()=>{let{constants:a,NSSSHelper:s,globalSettings:t,uiConstants:{MESSAGES:i},telemetryWrapper:n,telemetryTrackerClient:o}=NSSS,{utils:{isNil:r,isObject:l},telemetryConstants:e}=SymBfw;NSSS.timeWidgetManager=new class{constructor(){this.handleMessage=this.handleMessage.bind(this)}async _handleTimeWidgetSettingsToggled({showTimeWidget:e},t=!1){await s.sendMessageToHomePageTabs({name:i.TIME_WIDGET_SETTINGS_TOGGLED,message:{showTimeWidget:e}}),t||(n.sendSettingsToggleTelemetry(a.TIME_WIDGET,e),o.sendSettingsToggleTelemetry(a.TIME_WIDGET,e))}handleMessage(e,t,a){l(a)&&(a.id,r(e)||e.name===i.TIME_WIDGET_SETTINGS_TOGGLED&&this._handleTimeWidgetSettingsToggled(e.message))}_isTimeWidgetEnabled(){var e=t.getTimerWidgetEnabled();return!!r(e)||e}getTelemetryDataForHeartBeat(){return{[e.parameters.CUSTOM_DIMENSION32]:()=>this._isTimeWidgetEnabled()}}handleRestoreToDefault(){this._handleTimeWidgetSettingsToggled({showTimeWidget:!0},!0)}},NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.timeWidgetManager)})(),SymBfw.extensionAdapter.addMessageListener(NSSS.timeWidgetManager.handleMessage),(()=>{let s=NSSS.trackerLogger,{logger:i,utils:{isString:e,isObject:n}}=SymBfw;NSSS.weatherServiceUtils=new class{isValidData(e){return!(!n(e)||e.expiryTime<=Date.now())}async fetchDataFromService(t){if(e(t)){let e=null;try{e=await SymBfw.utils.safeFetch(t)}catch(e){return i.error("Failed to fetch data from portal with error "+e),void s.logEvent(s.LOG_TYPE.ERROR,"Failed to fetch data from portal with error "+s.errorToString(e))}if(200!==e.status)i.error("Error response code from Safe Search Portal"),s.logEvent(s.LOG_TYPE.ERROR,"Error response code from Safe Search Portal "+e.status);else try{var a=await e.json();if(n(a))return a;i.error("Empty response from Safe Search Portal"),s.logEvent(s.LOG_TYPE.ERROR,"Empty response from Safe Search Portal")}catch(e){i.error("Failed to parse response "+e),s.logEvent(s.LOG_TYPE.ERROR,"Failed to parse response "+s.errorToString(e))}}}getDate(){return new Date}}})(),NSSS.geoLocationServiceConstants=class{static get GEO_LOCATION_API(){return"https://geolocation.norton.com/api/v2/GeoLocation"}static get GEO_ATTRIBUTES(){return{GEO:"geo",LATITUDE:"latitude",LONGITUDE:"longitude",CITY:"city",COUNTRY:"country",COUNTRY_CODE:"countryCode",REGION_CODE:"regionCode"}}},(()=>{let{geoLocationServiceConstants:i,weatherServiceUtils:n}=NSSS,o=i.GEO_ATTRIBUTES;NSSS.geoLocationServiceManager=new class{constructor(){this.fetchGeoLocationDataAndSetCountryCode=this.fetchGeoLocationDataAndSetCountryCode.bind(this)}async fetchGeoLocationAttributes(e){if(!Array.isArray(e))throw new Error("The parameter must be an array");var t=i.GEO_LOCATION_API;let a=await n.fetchDataFromService(t);if(!a)return null;let s=new Map;return e.forEach(e=>{switch(e){case o.GEO:a.additionalAttributes&&a.additionalAttributes.Location?s.set(o.GEO,a.additionalAttributes.Location):s.set(o.GEO,null);break;case o.LATITUDE:a.additionalAttributes&&a.additionalAttributes.Location&&a.additionalAttributes.Location.latitude?s.set(o.LATITUDE,a.additionalAttributes.Location.latitude):s.set(o.LATITUDE,null);break;case o.LONGITUDE:a.additionalAttributes&&a.additionalAttributes.Location&&a.additionalAttributes.Location.longitude?s.set(o.LONGITUDE,a.additionalAttributes.Location.longitude):s.set(o.LONGITUDE,null);break;case o.CITY:a.additionalAttributes&&a.additionalAttributes.City?s.set(o.CITY,a.additionalAttributes.City):s.set(o.CITY,null);break;case o.COUNTRY:a.additionalAttributes&&a.additionalAttributes.Country?s.set(o.COUNTRY,a.additionalAttributes.Country):s.set(o.COUNTRY,null);break;case o.COUNTRY_CODE:a.countryCode?s.set(o.COUNTRY_CODE,a.countryCode):s.set(o.COUNTRY_CODE,null);break;case o.REGION_CODE:a.regionCode?s.set(o.REGION_CODE,a.regionCode):s.set(o.REGION_CODE,null)}}),s}_setCountryCodeAndInitiateQuickLinksProcess(e){NSSS.globalSettings.getCountryCode()!==e&&NSSS.adRulesEngine.onLocationChange(),NSSS.globalSettings.setCountryCode(e)}async fetchGeoLocationDataAndSetCountryCode(){var e=await this.fetchGeoLocationAttributes([o.GEO,o.COUNTRY_CODE]);if(e)return this._setCountryCodeAndInitiateQuickLinksProcess(e.get(o.COUNTRY_CODE)),e.get(o.GEO)}getCountryCode(){return NSSS.globalSettings.getCountryCode()}}})(),NSSS.locationServiceConstants=class{static get LOCATION_CACHE_TIME_IN_MILLISECONDS(){return 864e5}static get SAFESEARCH_SERVICE_LOCATION_API(){return NSSS.constants.PORTAL_URL+"/services/v1/location?latitude=##LATITUDE##&longitude=##LONGITUDE##"}static get GEO_LOCATION_API(){return"https://geolocation.norton.com/api/v2/GeoLocation"}static get LOCATION_FETCH_ALARM(){return"location_homepage_alarm"}static get LOCATION_FETCH_ALARM_RETRY(){return"location_homepage_alarm_retry"}static get RETRY_INTERVAL_IN_MINUTES(){return 10}static get LOCATION_SERVICE_FETCH_INTERVAL_IN_MILLI_SECS(){return 8647e4}},NSSS.weatherServiceConstants=class{static get DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS(){return 36e5}static get SAFESEARCH_SERVICE_WEATHER_API(){return NSSS.constants.PORTAL_URL+"/services/v1/weather"}static get WEATHER_FETCH_ALARM(){return"weather_homepage_alarm"}static get WEATHER_FETCH_ALARM_RETRY(){return"weather_homepage_alarm_retry"}static get PARTNER_CODE(){return"web_norton_adc"}static get DAY_MAP(){return{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"}}static get MONTH_MAP(){return{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}}},(()=>{let{globalSettings:n,weatherServiceUtils:o,locationServiceConstants:s,geoLocationServiceManager:a}=NSSS,{alarmHelper:i,utils:{isObject:r,isNil:l,isFunction:t,isArray:c,isString:g},extensionAdapter:S}=SymBfw;NSSS.locationServiceManager=new class{constructor(){this.handleAlarm=this.handleAlarm.bind(this),this.fetchAndSetLocationDataInit=this.fetchAndSetLocationDataInit.bind(this),this._fetchAndSetLocationDataFromService=this._fetchAndSetLocationDataFromService.bind(this),this._fetchAndSetLocationDataFromServiceInit=this._fetchAndSetLocationDataFromServiceInit.bind(this),this.fetchAndSetLocationData=this.fetchAndSetLocationData.bind(this),this._onLocationChangeCallbacks=[],this._doesLocationAlarmExist=this._doesLocationAlarmExist.bind(this),this._getLocationDataForLocaleFromStorage=this._getLocationDataForLocaleFromStorage.bind(this),this.getCurrentLocationKey=this.getCurrentLocationKey.bind(this),this._isLocationKeyAvailable=this._isLocationKeyAvailable.bind(this),this.getLocationData=this.getLocationData.bind(this),this._setGeoInformation=this._setGeoInformation.bind(this)}_getBrowserLocale(){return SymBfw.localizer.getLocale().replace("_","-")}async _doesLocationAlarmExist(){var e=await S.getAlarm(s.LOCATION_FETCH_ALARM),t=await S.getAlarm(s.LOCATION_FETCH_ALARM_RETRY);return!(!e&&!t)}async fetchAndSetLocationDataInit(){await this._doesLocationAlarmExist()||await this.fetchAndSetLocationData()}async fetchAndSetLocationData(){await NSSS.init.ready();var e=this._getBrowserLocale(),t=this._getLocationDataForLocaleFromStorage(e);o.isValidData(t)?this._onLocationChange(t.Key):this._fetchAndSetLocationDataFromService(e)}_onLocationChange(t){g(t)&&c(this._onLocationChangeCallbacks)&&0!==this._onLocationChangeCallbacks.length&&this._onLocationChangeCallbacks.forEach(e=>{e(t)})}async _fetchAndSetLocationDataFromServiceInit(){this._fetchAndSetLocationDataFromService(this._getBrowserLocale(),!0)}async _fetchAndSetLocationDataFromService(e=this._getBrowserLocale(),t=!1){if(!t&&await this._doesLocationAlarmExist())return;t=await a.fetchGeoLocationDataAndSetCountryCode();this._isLocationKeyAvailable(t)||(e=await this._fetchLocationData(e,t),r(e)?(e.expiryTime=Date.now()+s.LOCATION_SERVICE_FETCH_INTERVAL_IN_MILLI_SECS,this._setGeoInformation(e),this._onLocationChange(e.Key),this.createAlarm(s.LOCATION_CACHE_TIME_IN_MILLISECONDS,s.LOCATION_FETCH_ALARM)):this._createLocationFetchRetryAlarm())}async _createLocationFetchRetryAlarm(){await i.setAlarm(s.LOCATION_FETCH_ALARM_RETRY,{delayInMinutes:s.RETRY_INTERVAL_IN_MINUTES})}async createAlarm(e,t){e/=NSSS.constants.MS_TO_MIN_CONVERSION_VALUE;await i.setAlarm(t,{periodInMinutes:e})}_getLocationDataForLocaleFromStorage(e){if(g(e)){var t=this._getLocationDataFromStorage();if(r(t))return t[e]}}_isLocationKeyAvailable(e){var t=n.getLocationData();if(r(t)){var a=this._getBrowserLocale();if(o.isValidData(t[a])){var s=Object.keys(t[a]);if(c(s)&&0!==s.length)for(var i of s)if(t[a][i].latitude===e.latitude&&t[a][i].longitude===e.longitude)return n.setCurrentLocationKey(i),!0}}return!1}async _fetchLocationData(e,t){if(!r(t))return null;let a=s.SAFESEARCH_SERVICE_LOCATION_API+"&language="+e;a=(a=a.replace("##LATITUDE##",t.latitude)).replace("##LONGITUDE##",t.longitude);e=await o.fetchDataFromService(a);return e?{...e.location,latitude:t.latitude,longitude:t.longitude}:null}_setGeoInformation(t){if(r(t)){let e=n.getLocationData();(e=l(e)?{}:e)[this._getBrowserLocale()]={...e[this._getBrowserLocale()],[t.Key]:t},n.setLocationData(e),n.setCurrentLocationKey(t.Key)}}handleAlarm(e){switch(e.name){case s.LOCATION_FETCH_ALARM:case s.LOCATION_FETCH_ALARM_RETRY:this._fetchAndSetLocationDataFromService(this._getBrowserLocale(),!0)}}addLocationChangeCallback(e){t(e)&&this._onLocationChangeCallbacks.push(e)}_getLocationDataFromStorage(){return n.getLocationData()}getCurrentLocationKey(){var e=this._getBrowserLocale();if(g(e)){var t=this._getLocationDataFromStorage();if(r(t)){if(t[e])return Object.values(t)[0].Key;this._fetchAndSetLocationDataFromService(e)}}}_getIntermediateData(e){if(r(e))return e=Object.values(e)[0],Object.values(e)[0]}getLocationData(){var e=this._getBrowserLocale();if(!l(e)){var t=this._getLocationDataFromStorage();if(r(t)){var a=n.getCurrentLocationKey();if(!l(a))return t[e]&&o.isValidData(t[e][a])?t[e][a]:(this._fetchAndSetLocationDataFromService(e),this._getIntermediateData(t))}}}},SymBfw.alarmHelper.registerAlarmListener(NSSS.locationServiceManager.handleAlarm),SymBfw.extensionAdapter.addStartupListener(NSSS.locationServiceManager._fetchAndSetLocationDataFromServiceInit)})(),(()=>{let{globalSettings:s,weatherServiceConstants:i,weatherServiceUtils:a,locationServiceManager:n,trackerLogger:o}=NSSS,{alarmHelper:t,logger:r,utils:{isObject:l,isNil:c,isString:g,isFunction:S},extensionAdapter:e}=SymBfw;NSSS.weatherServiceManager=new class{constructor(){this._weatherDataChangeListeners=[],this.handleAlarm=this.handleAlarm.bind(this),this._getWeatherData=this._getWeatherData.bind(this),this.fetchAndSetWeatherData=this.fetchAndSetWeatherData.bind(this),this._fetchAndSetWeatherDataFromService=this._fetchAndSetWeatherDataFromService.bind(this),this._doesWeatherAlarmExist=this._doesWeatherAlarmExist.bind(this),this._formatWeatherData=this._formatWeatherData.bind(this),this.getWeatherData=this.getWeatherData.bind(this),this._getLocationKeyAndFetchDataFromService=this._getLocationKeyAndFetchDataFromService.bind(this),this._fetchWeatherData=this._fetchWeatherData.bind(this),this.registerOnWeatherDataReceivedCallback=this.registerOnWeatherDataReceivedCallback.bind(this),this.registerOnLocationChangeCallback=this.registerOnLocationChangeCallback.bind(this),this._isLocationChanged=this._isLocationChanged.bind(this),this._isFetchInProgress=!1}async _doesWeatherAlarmExist(){return!!await e.getAlarm(i.WEATHER_FETCH_ALARM)}async fetchAndSetWeatherData(e){var t;await NSSS.init.ready(),g(e)?(t=this._getWeatherData(e),a.isValidData(t)||this._fetchAndSetWeatherDataFromService(e)):n.fetchAndSetLocationData()}async _fetchAndSetWeatherDataFromService(e,t=!1){if(g(e)){var a;if(!t)if(await this._doesWeatherAlarmExist()&&!this._isLocationChanged(e))return;this._isFetchInProgress||(this._isFetchInProgress=!0,t=await this._fetchWeatherData(e),l(t)?(a=this._getExpiryTimeInMilliSeconds(t.expires),e={[e]:t=this._formatWeatherData(t,a)},s.setWeatherData(e),this._weatherDataChangeListeners.length&&this._weatherDataChangeListeners.forEach(e=>{e()}),t=a<i.DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS?i.DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS:a,await this.createWeatherFetchAlarm(t)):await this.createWeatherFetchAlarm(i.DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS/10),this._isFetchInProgress=!1)}else r.error("Location key is invalid"),o.logEvent(o.LOG_TYPE.ERROR,"Location key is invalid")}_isLocationChanged(e){var t=NSSS.globalSettings.getWeatherData();return!!l(t)&&Object.keys(t)[0]!==e}_formatWeatherData(e,t){if(l(e))return e.expiryTime=t<i.DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS?Date.now()+i.DEFAULT_WEATHER_CACHE_TIME_IN_MILLI_SECS:Date.now()+t,e.temperature=this._formatTemperature(e.Temperature),e.Link=e.Link+"&partner="+i.PARTNER_CODE,e}_getExpiryTimeInMilliSeconds(e){return new Date(e)-new Date}_formatTemperature(e){var t;if(l(e))return{Metric:e,Imperial:t}=e,{celsius:e.Value,farenheit:t.Value}}async createWeatherFetchAlarm(e){e/=NSSS.constants.MS_TO_MIN_CONVERSION_VALUE;await t.setAlarm(i.WEATHER_FETCH_ALARM,{delayInMinutes:e})}_getWeatherData(e){if(g(e)){var t=NSSS.globalSettings.getWeatherData();if(l(t))return t[e]}}getWeatherData(){var e=NSSS.globalSettings.getWeatherData();if(l(e))return e=Object.values(e)[0],a.isValidData(e)||this._getLocationKeyAndFetchDataFromService(),e;this._getLocationKeyAndFetchDataFromService()}_getLocationKeyAndFetchDataFromService(){var e=n.getCurrentLocationKey();c(e)||this._fetchAndSetWeatherDataFromService(e)}async _fetchWeatherData(e){if(g(e))return e=i.SAFESEARCH_SERVICE_WEATHER_API+"?locationKey="+e,(e=await a.fetchDataFromService(e))?e.weather:null}handleAlarm(e){e.name===i.WEATHER_FETCH_ALARM&&(e=n.getCurrentLocationKey(),this._fetchAndSetWeatherDataFromService(e,!0))}registerOnWeatherDataReceivedCallback(e){if(!S(e))throw Error("callback is not a valid function");this._weatherDataChangeListeners.push(e)}registerOnLocationChangeCallback(){NSSS.locationServiceManager.addLocationChangeCallback(this.fetchAndSetWeatherData)}},SymBfw.alarmHelper.registerAlarmListener(NSSS.weatherServiceManager.handleAlarm),NSSS.weatherServiceManager.registerOnLocationChangeCallback()})(),(()=>{let{constants:o,weatherServiceConstants:n,locationServiceManager:r,weatherServiceManager:l,weatherServiceUtils:c,globalSettings:g,uiConstants:{MESSAGES:S},telemetryWrapper:d,telemetryTrackerClient:m,trackerLogger:h}=NSSS,{extensionAdapter:t,localizer:u,logger:_,utils:{isObject:T,isString:a,isNil:s},telemetryConstants:e}=SymBfw;NSSS.weatherWidgetDataManager=new class{constructor(){this.getWidgetData=this.getWidgetData.bind(this),this.handleMessage=this.handleMessage.bind(this),this._handleWeatherWidgetClick=this._handleWeatherWidgetClick.bind(this),this._sendWeatherDataToHomePageTabs=this._sendWeatherDataToHomePageTabs.bind(this),this._handleWeatherWidgetUnitChanged=this._handleWeatherWidgetUnitChanged.bind(this),this._getWeatherUnitBasedOnCountry=this._getWeatherUnitBasedOnCountry.bind(this)}getWidgetData(){var e=r.getLocationData();if(T(e)){var t,a,s,i=l.getWeatherData();if(T(i))return t=c.getDate(),t={day:u.getLocalizedString(n.DAY_MAP[t.getDay()]),month:u.getLocalizedString(n.MONTH_MAP[t.getMonth()]),date:t.getDate()},a=g.getWeatherUnit(),s=this._getWeatherUnitBasedOnCountry(i),{locationData:e,weatherData:i,dateInformation:t,weatherUnit:a||s}}}_getWeatherUnitBasedOnCountry(e){let t=o.CELSIUS;try{var a=e.Link,s=new URL(a).pathname,i=s?s.split("/"):[],n=2<i.length?i[2]:"";o.WEATHER_FARENHEIT_COUNTRY_CODES.includes(n.toUpperCase())&&(t=o.FARENHEIT)}catch(e){_.error(e),h.logEvent(h.LOG_TYPE.ERROR,""+h.errorToString(e))}return t}async _sendWeatherDataToHomePageTabs(e=!1,t=!1){let a=null;var s=NSSS.globalSettings.getWeatherWidgetEnabled(),i=(s&&(a=this.getWidgetData(),t)&&(i=this._getWeatherUnitBasedOnCountry(a.weatherData),a.weatherUnit=i),{name:S.UPDATE_WEATHER_WIDGET,message:{accuWeatherData:a,showWeatherWidget:s}});await NSSS.NSSSHelper.sendMessageToHomePageTabs(i),e&&!t&&(d.sendSettingsToggleTelemetry(o.WEATHER_WIDGET,s),m.sendSettingsToggleTelemetry(o.WEATHER_WIDGET,s))}_handleWeatherWidgetClick(e){a(e)&&(t.createTab(e),d.sendWeatherWidgetClickEvent(),m.sendWeatherWidgetClickEvent())}async _handleWeatherWidgetUnitChanged(e){await NSSS.init.ready(),g.setWeatherUnit(e),this._sendWeatherDataToHomePageTabs(!1)}handleMessage(e,t,a){if(T(a)){a.id;if(!s(e))switch(e.id){case S.WEATHER_WIDGET_CLICK:this._handleWeatherWidgetClick(e.url);break;case S.WEATHER_SETTINGS_TOGGLED:this._sendWeatherDataToHomePageTabs(!0);break;case S.WEATHER_WIDGET_UNIT_CHANGED:this._handleWeatherWidgetUnitChanged(e.weatherUnit)}}}_getWeatherWidgetEnabled(){var e=g.getWeatherWidgetEnabled();return!!s(e)||e}getTelemetryDataForHeartBeat(){return{[e.parameters.CUSTOM_DIMENSION31]:()=>this._getWeatherWidgetEnabled()}}handleRestoreToDefault(){this._sendWeatherDataToHomePageTabs(!0,!0)}},NSSS.weatherServiceManager.registerOnWeatherDataReceivedCallback(NSSS.weatherWidgetDataManager._sendWeatherDataToHomePageTabs),NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.weatherWidgetDataManager)})(),SymBfw.extensionAdapter.addMessageListener(NSSS.weatherWidgetDataManager.handleMessage),(()=>{let n=NSSS.abTestingAppsRepo,{isNil:o,isntNil:r}=SymBfw.utils;var e=new class{_getApplicableAppsAndTourData(){let i={appsData:{},tourData:[]};var e=Object.keys(n.abTestImpls);return o(e)||0===Object.keys(e).length||e.forEach(e=>{var t,a,s=this.getApplicableVariantForTestId(e);o(s)||(t=(e=n.abTestImpls[e]).getAppsData(s),r(t)&&0!==Object.keys(t.data).length&&(a=t.key,i.appsData={...i.appsData,[a]:t}),a=e.getTourData(s),r(a)&&0!==Object.keys(a).length&&i.tourData.push(a))}),i}async getApplicableVariantForTestId(e){var e=(await multiVariateTestingSDK.multiVariateTestManager.getVariantForTestIds([e])).tests;return!o(e)&&0!==e.length&&(e=e[0].variant,r(e))?e.variantId:null}getApplicableAppsData(){var e=this._getApplicableAppsAndTourData().appsData;return e}getApplicableTourData(){var e=this._getApplicableAppsAndTourData().tourData;return e}getCustomDimensionsData(){var e=Object.keys(n.abTestImpls);if(!o(e)&&0!==Object.keys(e).length){let t={},a={};return e.forEach(e=>{e=n.abTestImpls[e];t=e.getHeartBeatPingCustomDimesions(),a=e.getInstallPingCustomDimensions()}),{hbPingCustomDimesions:t,installPingCustomDimesions:a}}}getHeartBeatPingCustomDimesions(){var e=this.getCustomDimensionsData().hbPingCustomDimesions;return e}getInstallPingCustomDimesions(){var e=this.getCustomDimensionsData().installPingCustomDimesions;return e}};NSSS.abTestingDataProvider=e})(),(()=>{let{constants:s,globalSettings:t,uiConstants:{MESSAGES:i,BOOKMARK_MANAGER_URL:a},telemetryWrapper:n,telemetryTrackerClient:o}=NSSS,{utils:{isNil:r,isObject:l,isString:c},extensionAdapter:g,telemetryConstants:e}=SymBfw;NSSS.bookmarksManager=new class{constructor(){this._handleBookmarksToggle=this._handleBookmarksToggle.bind(this),this.handleMessage=this.handleMessage.bind(this),this._handleBookmarkManagerClick=this._handleBookmarkManagerClick.bind(this)}async _handleBookmarksToggle({shouldShowBookmarks:e},t=!1){let a={name:i.BOOKMARKS_SETTINGS_TOGGLED,message:{shouldShowBookmarks:e}};(await NSSS.helperUtils.getAllHomePageTabs()).forEach(e=>{g.sendMessageToTab(e,a)}),t||(n.sendSettingsToggleTelemetry(s.BOOKMARK_SETTING,e),o.sendSettingsToggleTelemetry(s.BOOKMARK_SETTING,e))}_handleBookmarkManagerClick(){var e=a[SymBfw.globals.BROWSER];g.createTab(e)}_launchUrlFromBookmarks(e){c(e)&&g.createTab(e)}handleMessage(e,t,a){if(l(a)){a.id;if(!r(e))switch(e.id){case i.BOOKMARKS_TOGGLE:this._handleBookmarksToggle(e.message);break;case i.BOOKMARK_MANAGER_CLICKED:this._handleBookmarkManagerClick();break;case i.BOOKMARKS_URL_CLICKED:this._launchUrlFromBookmarks(e.message.url)}}}_getBookMarksToolbarEnabled(){var e=t.getBookmarksToolbarEnabled();return!r(e)&&e}getTelemetryDataForHeartBeat(){return{[e.parameters.CUSTOM_DIMENSION29]:()=>this._getBookMarksToolbarEnabled()}}handleRestoreToDefault(){this._handleBookmarksToggle({shouldShowBookmarks:!1},!0)}},NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.bookmarksManager)})(),SymBfw.extensionAdapter.addMessageListener(NSSS.bookmarksManager.handleMessage),(()=>{let{constants:s,uiConstants:{MESSAGES:i},NSSSHelper:n,telemetryWrapper:o,telemetryTrackerClient:r,globalSettings:a}=NSSS,{utils:{isNil:l,isObject:c},telemetryConstants:e}=SymBfw;NSSS.mostVisitedSitesManager=new class{constructor(){this._handleMostVisitedSitesToggle=this._handleMostVisitedSitesToggle.bind(this),this.handleMessage=this.handleMessage.bind(this)}async _handleMostVisitedSitesToggle({shouldShowMostVisitedSites:e},t=!1){var a={name:i.MOST_VISITED_SITES_SETTINGS_CHANGE,message:{shouldShowMostVisitedSites:e}};await n.sendMessageToHomePageTabs(a),t||(o.sendSettingsToggleTelemetry(s.MOST_VISITED_SITES,e),r.sendSettingsToggleTelemetry(s.MOST_VISITED_SITES,e))}handleMessage(e,t,a){c(a)&&(a.id,l(e)||e.id===i.MOST_VISITED_SITES_TOGGLE&&this._handleMostVisitedSitesToggle(e.message))}_getChickletType(){let e=s.TOP_SITES;var t=a.getMostVisitedSitesEnabled();return e=!l(t)&&t?e:s.CUSTOM_QUICK_LINKS}getTelemetryDataForHeartBeat(){return{[e.parameters.CUSTOM_DIMENSION33]:()=>this._getChickletType()}}handleRestoreToDefault(){this._handleMostVisitedSitesToggle({shouldShowMostVisitedSites:!1},!0)}},NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.mostVisitedSitesManager)})(),SymBfw.extensionAdapter.addMessageListener(NSSS.mostVisitedSitesManager.handleMessage),(()=>{let e=NSSS.uiConstants;NSSS.HomePageTourConfig=class{static get TOUR_COMPONENTS_EN_US(){return[e.HomepageTourSteps.SEARCH_BOX,e.HomepageTourSteps.STATIC_CHICKLETS,e.HomepageTourSteps.CUSTOM_CHICKLETS,e.HomepageTourSteps.TWITTER_FEEDS,e.HomepageTourSteps.SECURITY_CENTER_FEEDS]}static get TOUR_COMPONENTS_ROW(){return[e.HomepageTourSteps.SEARCH_BOX,e.HomepageTourSteps.STATIC_CHICKLETS,e.HomepageTourSteps.CUSTOM_CHICKLETS]}static get INITIAL_TOUR_DATA(){return{start:NSSS.uiConstants.HomepageTourSteps.WELCOME_DIALOG,[NSSS.uiConstants.HomepageTourSteps.WELCOME_DIALOG]:{nextStep:NSSS.uiConstants.HomepageTourSteps.SEARCH_BOX},[NSSS.uiConstants.HomepageTourSteps.SETTINGS_ICON]:{descriptionText:"A tour of Norton Safe Search is available in Settings.",autoHideTooltip:!0,positionCSS:" tooltip-position-settings-icon ",cssClassName:" tour-tooltip-for-settings-icon ",iconPath:"content/images/settings-icon-for-tour-tooltip.svg",nextStep:null}}}static get COMPONENTS_TOUR_DATA(){return{[e.HomepageTourSteps.SEARCH_BOX]:{key:"search_box",positionCSS:" tooltip-position-searchbox ",titleText:"Peace of mind with every search",descriptionText:"Norton Safe Search shows site safety ratings in your search results."},[e.HomepageTourSteps.STATIC_CHICKLETS]:{key:"static_chicklets",positionCSS:" tooltip-position-static-chicklets ",descriptionText:"Quick links to access popular sites with ease"},[e.HomepageTourSteps.CUSTOM_CHICKLETS]:{key:"custom_chicklets",positionCSS:" tooltip-position-custom-chicklets ",titleText:"Editable quick links",descriptionText:"Add your favorite sites to the new Quick Links bar."},[e.HomepageTourSteps.TWITTER_FEEDS]:{key:"twitter_feeds",positionCSS:" tooltip-position-tweets-list ",descriptionText:"Get security updates and tips from Norton"},[e.HomepageTourSteps.SECURITY_CENTER_FEEDS]:{key:"security_center_feeds",positionCSS:" tooltip-position-security-center ",descriptionText:"Explore the latest security and privacy blogs from NortonLifeLock and learn more about digital safety."}}}}})(),(()=>{let{abTestingDataProvider:s,HomePageTourConfig:l,uiConstants:c}=NSSS,{localizer:i,utils:{isntNil:n}}=SymBfw;var e=new class{_positionABTestComponent(t,e){return e.forEach(e=>{t.splice(e.tourOrderIndex,0,e.key)}),t}_processTourData(s,i,n){let o=s.length,r=l.INITIAL_TOUR_DATA;return r.id=i,s.forEach((t,e)=>{var a=l.COMPONENTS_TOUR_DATA[t]||n.find(e=>e.key===t);a.pageNumberText=e+1+"/"+o,a.nextStep=e===o-1?c.HomepageTourSteps.SETTINGS_ICON:s[e+1],a.buttonText=e===o-1&&"tourForUS"===i?"Done":"Next",r[t]=a}),r}_prepareTourData(){let e=null,t=null;t="en-US"===i.getNavigatorLanguage()?(e=l.TOUR_COMPONENTS_EN_US,"tourForUS"):(e=l.TOUR_COMPONENTS_ROW,"tourForRestOfTheWorld");var a=s.getApplicableTourData();return n(a)&&0!==a.length&&(e=this._positionABTestComponent(e,a)),this._processTourData(e,t,a)}getTourData(){return this._prepareTourData()}};NSSS.homePageTourManager=e})();class HomePageConstants{get QUICK_LINKS(){return{[NSSS.constants.IAC]:{version:0,quicklinksData:NSSS.quickLinksConfig.quickLinksData},[NSSS.constants.YAHOO]:{version:0,quicklinksData:NSSS.quickLinksConfig.quickLinksData}}}get DEFAULT_CUSTOM_CHICKLETS(){return{customQuicklinksData:[{name:"Gmail",associateUrl:"https://www.gmail.com"},{name:"Facebook",associateUrl:"https://www.facebook.com"},{name:"Youtube",associateUrl:"https://www.youtube.com"}]}}get TWEETS(){return{data:[{time:"Oct 29, 2020",text:"76% of Americans believe they’ve encountered disinformation firsthand. Read more: https://t.co/5yth1vtHqi #disinformation #fakenews #elections https://t.co/oBgFkDdJhe",username:"NortonLifeLock",id_str:"1321530740736167939",userIconUrl:"https://pbs.twimg.com/profile_images/1191468124387676160/qqryvupD_normal.png",handle:"NortonLifelock"},{time:"Oct 28, 2020",text:"Don’t miss our #NCSAM webinar today where NortonLifeLock experts will share #CyberSafety tips to help protect you from online threats and identity theft. https://t.co/AFquzrBGVR #BeCyberSmart #IdentityTheft https://t.co/Flp3v3diBW",username:"NortonLifeLock",id_str:"1321459203664470018",userIconUrl:"https://pbs.twimg.com/profile_images/1191468124387676160/qqryvupD_normal.png",handle:"NortonLifelock"},{time:"Oct 27, 2020",text:"As part of National Cybersecurity Awareness Month, experts from NortonLifeLock will share Cyber Safety tips to help secure your connected life. Don’t miss our webinar tomorrow, Oct 28. https://t.co/8wWhMl47V4 #BeCyberSmart #NCSAM #IdentityTheft https://t.co/3TEu9Jpx6c",username:"NortonLifeLock",id_str:"1321126933950795780",userIconUrl:"https://pbs.twimg.com/profile_images/1191468124387676160/qqryvupD_normal.png",handle:"NortonLifelock"}]}}get SECURITY_CENTER_NEWS_FEEDS(){return{data:[{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/twitter-hack_190x190.jpg",text:"High-profile people and companies among Twitter accounts hacked in Bitcoin scam: Here’s what to watch out for",category:"Emerging Threats",url:"https://us.norton.com/internetsecurity-emerging-threats-twitter-hack.html"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/twitch_extensions_190x190.png",text:"50-plus Twitch extensions every video gamer should know",category:"Kids' Safety ",url:"https://us.norton.com/internetsecurity-kids-safety-twitch-extensions.html",focus:"top"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/grey-world-of-key-selling_190x190.jpg",text:"The grey world of key selling: Grey market sites come with many risks",category:"Kids' Safety ",url:"https://us.norton.com/internetsecurity-kids-safety-grey-world-of-key-selling.html"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/video-game-ratings-190x190.png",text:"2020 video game ratings in review, and what they mean to gamers",category:"Kids' Safety ",url:"https://us.norton.com/internetsecurity-kids-safety-video-game-ratings.html",focus:"top"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/docusign-phishing_190x190.jpg",text:"DocuSign phishing emails: 4 signs of an attack, and how to protect yourself",category:"Online Scams",url:"https://us.norton.com/internetsecurity-online-scams-docusign-phishing-scams.html"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/email_hacked_190x190.png",text:"4 things to do if your email account is hacked",category:"Malware",url:"https://us.norton.com/internetsecurity-malware-what-to-do-if-your-email-is-hacked.html"},{image:"http://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/general/img_icon_woman-phone-cafe-outside2_190x190.jpg",text:"The risks of public Wi-Fi",category:"Privacy",url:"https://us.norton.com/internetsecurity-privacy-risks-of-public-wi-fi.html"},{image:"https://now.symassets.com/content/dam/norton/global/images/non-product/misc/tlc/general/img_icon_id-theft-red-flags.jpg",text:"9 warning signs of identity theft and what to look for",category:"ID Theft",url:"https://us.norton.com/internetsecurity-id-theft-5-red-flags-of-identity-theft.html",focus:"top"}]}}get DYNAMIC_TILES_API_PARTNER(){return"nortontiles"}get DYNAMIC_TILES_API_SUB1(){return"10142"}get DYNAMIC_TILES_API_SUB2(){return{[NSSS.constants.IAC]:"searchnorton",[NSSS.constants.YAHOO]:"searchsafe"}}get DYNAMIC_TILES_API_VERSION(){return"1.3"}get DYNAMIC_TILES_API_RESULTS(){return"6"}get DYNAMIC_TILES_API_RSP_FORMAT(){return"json"}get DYNAMIC_TILES_API(){return"https://nortontiles.tiles.ampfeed.com/tiles"}get QUICK_LINKS_REQ(){return{[NSSS.constants.IAC]:{quickLinksRequest:NSSS.quickLinksConfig.quickLinksReq},[NSSS.constants.YAHOO]:{quickLinksRequest:NSSS.quickLinksConfig.quickLinksReq}}}get QUICK_LINKS_IMG_PATH(){return"https://static.nortoncdn.com/nortonsafesearch/quickLinks/"}get TILES_DATA_ELEMENT(){return"tiles"}get ADM_FETCH_INTERVAL(){return 9e5}get ADM_FETCH_INTERVAL_IN_MINUTES(){return this.ADM_FETCH_INTERVAL/6e4}get EMPTY_RESPONSE_TILES_API(){return"empty_response_from_tiles_api"}get APP_NAME(){return"quick_links"}get QUICK_LINKS_CDN_URL(){return"https://static.nortoncdn.com/nortonextensionhomepage/##file-name##.json"}get REPLACE_STRING(){return"##file-name##"}get ENV_BASED_JSON_FILE(){return{INT:"AdRules-stage",INT2:"AdRules-stage",PROD:"AdRules"}}get BROWSERS(){return"browsers"}get VALUE(){return"value"}get SCHEDULER_INTERVAL_IN_MINS(){return 1440}get RETRY_INTERVAL_IN_MINUTES(){return 30}get QUICK_LINKS_TILE_COUNT(){return 5}get DEFAULT_QUICK_LINKS(){return[{name:"ebay",toolTipName:"Ebay",associateUrl:"https://ebay.us/P5TMVh",domain:"ebay",imageUrl:"https://static.nortoncdn.com/nortonsafesearch/quickLinks/ebay_favicon.svg",type:"static"},{name:"AliExpress",toolTipName:"AliExpress",associateUrl:"https://ww55.affinity.net/sssdomweb?enk=b85d7e4e02b15a334a9b5c7ff9532757ea23e90f2b474d88c27bb95ba7e6b3f8919e674a8f6c928a946dc2e01ec9a0b1b27e03eb470e3a92bf756fa99318da4b9ccd295597509459",domain:"aliExpress",imageUrl:"https://static.nortoncdn.com/nortonsafesearch/quickLinks/AliExpress_favicon.svg",type:"affinity"},{name:"Fiverr",toolTipName:"Fiverr",associateUrl:"https://ww55.affinity.net/sssdomweb?enk=b85d7e4e02b15a334a9b5c7ff9532757ea23e90f2b474d88cd4a19f75075c816c5fff023724527282607848240fe19d919ab4a07a125566e059ffb046ea460ca624088d3c99c3f60",domain:"fiverr",imageUrl:"https://static.nortoncdn.com/nortonsafesearch/quickLinks/Fiverr_favicon.svg",type:"affinity"},{name:"Tripadvisor",toolTipName:"Tripadvisor",associateUrl:"https://ww55.affinity.net/sssdomweb?enk=b85d7e4e02b15a334a9b5c7ff9532757ea23e90f2b474d88c7c1459ea808c01d7c20567570c10fbaedcb505a8c1c74343acec33b49c3549d297065f2975465e8f2c8d29d83cedfdb",domain:"Tripadvisor",imageUrl:"https://static.nortoncdn.com/nortonsafesearch/quickLinks/Tripadvisor_favicon.svg",type:"affinity"},{name:"Booking",toolTipName:"Booking.com",associateUrl:"https://ww55.affinity.net/sssdomweb?enk=b85d7e4e02b15a334a9b5c7ff9532757ea23e90f2b474d889a19c5304b62595780db7bf4d586f008ba3e8d447e3c59463acec33b49c3549d297065f2975465e8f2c8d29d83cedfdb",domain:"booking",imageUrl:"https://static.nortoncdn.com/nortonsafesearch/quickLinks/Booking_favicon.svg",type:"affinity"}]}get IMAGE_FORMAT(){return{affinity:"svg",static:"svg",default:"svg"}}get DEFAULT_IMAGE_FORMAT(){return"ico"}get ADM_DATA_EXPIRY_INTERVAL(){return 18e5}get QUICKLINKS_DATA_FOR_TELEMETRY(){return{static:"eb",affinity:"a",adLinks:"ad",default:"d"}}}(NSSS=NSSS||{}).homePageConstants=new HomePageConstants,(()=>{let{jsonDownloader:t,utils:{isArray:n,isNil:i}}=SymBfw,{constants:o,globalSettings:r,uiConstants:{MESSAGES:l},telemetryWrapper:s,telemetryTrackerClient:c}=NSSS;NSSS.adRulesEngine=new class{constructor(){this.handleAlarm=this.handleAlarm.bind(this),this._onRulesJsonDownloadedCallback=this._onRulesJsonDownloadedCallback.bind(this),this.onLocationChange=this.onLocationChange.bind(this)}async _fetchADMLinks(e){try{var t,a=await SymBfw.utils.safeFetch(e);return 200!==a.status?(s.sendQuickLinkApiFetchFailureEvent(a.status),c.sendQuickLinkApiFailureEvent(error.message),this.checkAndResetAdmDataInStorage(),null):(t=await a.json(),NSSS.globalSettings.setAdmFetchTimestamp(Date.now()),t)}catch(e){return s.sendQuickLinkApiFetchFailureEvent(e.message),c.sendQuickLinkApiFailureEvent(e.message),this.checkAndResetAdmDataInStorage(),null}}_formatAdmData(e){return e.tiles.map(e=>({...e,toolTipName:e.name,associateUrl:e.click_url,domain:e.name,imageUrl:e.image_url,type:"adLinks"}))}_prepareQuickLinksFirstRowData(e,t,a,s){var i=new NSSS.admProcessor(new NSSS.staticLinksProcessor(new NSSS.affinityLinksProcessor)),t={rule:e,admLinksData:t,affinityLinksData:s,staticLinksData:a,additionalList:e.affinityLinks,countryCode:NSSS.globalSettings.getCountryCode()},s=i.getQuickLinksData(t,[]);n(s)&&(r.setFirstRowQuickLinks(s),s=NSSS.quickLinksHelper.getImageUrl(s),a={name:l.UPDATE_QUICK_LINKS,message:{firstRowLinks:s}},NSSS.NSSSHelper.sendMessageToHomePageTabs(a))}getFirstRowQuickLinks(){return r.getFirstRowQuickLinks()}_isValidAdmData(e){return!i(e)&&!!e.tiles&&!!n(e.tiles)&&0!==e.tiles.length}async fetchAndStoreADMLinks(e){var e=await this._fetchADMLinks(e);if(this._createAdmFetchAlarm(),this._isValidAdmData(e))return e=this._formatAdmData(e),r.setAdmLinksData(e),e}async _createAdmFetchAlarm(){SymBfw.alarmHelper.setAlarm(o.ALARM_NAMES.ADM_FETCH_ALARM,{periodInMinutes:NSSS.homePageConstants.ADM_FETCH_INTERVAL_IN_MINUTES})}_isAdmSupported(e){return!(!e.admLinksCount||0===e.admLinksCount)}isRulesJsonValid(e){return!!e.admUrl&&!!(e.staticAdLinks&&e.admFallbackLinks&&e.affinityAdLinks&&e.adRules)}_isTimeElapsedForAdmFetch(){var e=NSSS.globalSettings.getAdmFetchTimestamp();return!!i(e)||e+NSSS.homePageConstants.ADM_FETCH_INTERVAL<Math.floor((new Date).getTime())}async _onRulesJsonDownloadedCallback(e){e&&(await NSSS.init.ready(),this.isRulesJsonValid(e))&&(NSSS.globalSettings.setQuickLinksRulesJson(e),this._initiateFirstRowDataPreparation(e))}onLocationChange(){this._getJsonAndInitiateProcess()}async _getJsonAndInitiateProcess(){await NSSS.init.ready();var e=NSSS.globalSettings.getQuickLinksRulesJson();i(e)||this._initiateFirstRowDataPreparation(e)}checkAndResetAdmDataInStorage(){var e=NSSS.globalSettings.getAdmFetchTimestamp();i(e)||e+NSSS.homePageConstants.ADM_DATA_EXPIRY_INTERVAL>Math.floor((new Date).getTime())||NSSS.globalSettings.setAdmLinksData([])}async _initiateFirstRowDataPreparation(e){let t=null;var a=NSSS.geoLocationServiceManager.getCountryCode(),s=NSSS.quickLinksHelper.getRuleForCountry(a,e);this._isAdmSupported(s)&&(a?this._isTimeElapsedForAdmFetch()&&(t=await this.fetchAndStoreADMLinks(e[o.ADM_URL]),!i(t))||(t=NSSS.globalSettings.getAdmLinksData()):t=e.admFallbackLinks),this._prepareQuickLinksFirstRowData(s,t,e.staticAdLinks,e.affinityAdLinks)}handleAlarm(e){e.name===o.ALARM_NAMES.ADM_FETCH_ALARM&&this._getJsonAndInitiateProcess()}initializeDownloadConfigs(){var e=NSSS.homePageConstants.QUICK_LINKS_CDN_URL.replace(NSSS.homePageConstants.REPLACE_STRING,NSSS.homePageConstants.ENV_BASED_JSON_FILE[NSSS.constants.ENVS]),e={appName:NSSS.homePageConstants.APP_NAME,cdnUrl:e,schedulerIntervalInMins:NSSS.homePageConstants.SCHEDULER_INTERVAL_IN_MINS,retryIntervalInMins:NSSS.homePageConstants.RETRY_INTERVAL_IN_MINUTES,onDownloadedCallback:this._onRulesJsonDownloadedCallback};t.init(e)}},NSSS.adRulesEngine.initializeDownloadConfigs(),SymBfw.alarmHelper.registerAlarmListener(NSSS.adRulesEngine.handleAlarm)})(),(()=>{let{isArray:e}=SymBfw.utils,a=NSSS.constants;NSSS.quickLinksHelper=new class{_getBrowserSpecificRule(e){return e.find(e=>e.browsers.includes(SymBfw.globals.BROWSER))}_getRuleWithoutCountryCode(e){return e.find(e=>e["no-country-code"])["no-country-code"]}getRuleForCountry(t,a){t=t&&t.toUpperCase();a=a.adRules;if(a){a=a.regionSpecificRules;if(a){a=a[t]||a.ROW;if(e(a.admLinks)){let e;if(e=t?this._getBrowserSpecificRule(a.admLinks):this._getRuleWithoutCountryCode(a.admLinks))return a.admLinksCount=e.count,a}}}}getImageUrl(e){return e.forEach(e=>{var t;e[a.IMAGE_URL]||(t=NSSS.homePageConstants.IMAGE_FORMAT[e.type]||NSSS.homePageConstants.DEFAULT_IMAGE_FORMAT,e[a.IMAGE_URL]=NSSS.homePageConstants.QUICK_LINKS_IMG_PATH+e.name+"_favicon."+t)}),e}}})(),(()=>{var{}=SymBfw.utils,{}=NSSS;NSSS.quickLinksProcessor=class{constructor(e){this.nextProcessor=e}getQuickLinksData(e,t){return this.nextProcessor?this.nextProcessor.getQuickLinksData(e,t):[]}}})(),(()=>{class e extends NSSS.quickLinksProcessor{removeDuplicates(e,t){let a=t.map(e=>e.toLowerCase());return e.filter(e=>!a.includes(e.toLowerCase()))}getQuickLinksData(e,t){var{rule:e,affinityLinksData:a}=e,s=t.map(e=>e.name),e=this.removeDuplicates(e.affinityLinks,s),s=Object.keys(t).length;let i=e.splice(0,NSSS.homePageConstants.QUICK_LINKS_TILE_COUNT-s);e=a.allRegions.filter(e=>i.includes(e.name));return t.push(...e),t}}NSSS.affinityLinksProcessor=e})();let{isArray}=SymBfw.utils,constants=NSSS.constants;(()=>{class e extends NSSS.quickLinksProcessor{getQuickLinksData(e,a){let{rule:t,staticLinksData:s,countryCode:i}=e;var n=s.data.filter(e=>t.staticAdLinks.includes(e.name));return n.forEach(t=>{t.associateUrl=(s.urls[i]||s.urls.ROW)[t.name];var e=a.findIndex(e=>e.name.toLowerCase()===t.name.toLowerCase());-1!==e&&a.splice(e,1)}),a.push(...n),super.getQuickLinksData(e,a)}}NSSS.staticLinksProcessor=e})(),(()=>{let{isArray:n}=SymBfw.utils;var{}=NSSS;class e extends NSSS.quickLinksProcessor{_getItemsByCategory(e,t){let a=t.map(e=>e.toLowerCase());return{uniqueList:e.filter(e=>!a.includes(e.name.toLowerCase())),dulpicateList:e.filter(e=>a.includes(e.name.toLowerCase()))}}getQuickLinksData(e,t){var{admLinksData:a,additionalList:s,rule:i}=e;return!a||n(a)&&0===a.length||({uniqueList:a,dulpicateList:s}=this._getItemsByCategory(a,s),a.length<i.admLinksCount?(t.push(...a),t.push(...s.splice(0,i.admLinksCount-a.length))):t.push(...a.splice(0,i.admLinksCount))),super.getQuickLinksData(e,t)}}NSSS.admProcessor=e})(),(e=>{let{extensionAdapter:s,jsonDownloader:t,utils:{isNil:a,isntNil:i,isObject:n,isArray:o}}=SymBfw,{globalSettings:r,constants:l}=NSSS;(e.NSSS=e.NSSS||{}).quickLinksProvider=new class{_sleep(t){return new Promise(e=>setTimeout(e,t))}async _createDynamicQuickLinksAlarm(){SymBfw.alarmHelper.setAlarm(l.ALARM_NAMES.QUICK_LINKS,{periodInMinutes:NSSS.homePageConstants.DYNAMIC_QL_FETCH_INTERVAL_IN_MINUTES})}async fetchDynamicQuickLinks(){try{await NSSS.helperUtils.isVendorInitialized();var e=await this._fetchData(NSSS.homePageConstants.DYNAMIC_TILES_API,NSSS.homePageConstants.DYNAMIC_TILES_API_PARTNER,NSSS.homePageConstants.DYNAMIC_TILES_API_SUB1,NSSS.homePageConstants.DYNAMIC_TILES_API_SUB2[l.VENDOR]);r.setDynamicQuickLinksData(e)}catch(e){r.setDynamicQuickLinksData({}),SymBfw.logger.debug(e),NSSS.trackerLogger.logger.debug(""+NSSS.trackerLogger.errorToString(e))}}async initializeDynamicQuickLinksData(){var e=await SymBfw.extensionAdapter.getAlarm(l.ALARM_NAMES.QUICK_LINKS);i(e)||(await this.fetchDynamicQuickLinks(),await this._createDynamicQuickLinksAlarm())}_capitalizeFirstLetter(e){return e[0].toUpperCase()+e.slice(1)}getQuickLinks(){let e=NSSS.adRulesEngine.getFirstRowQuickLinks();return{quicklinksData:e=o(e)?e:NSSS.homePageConstants.DEFAULT_QUICK_LINKS}}_isDynamicQuickLinksApplicable(e){var t;return!!e.dynamic&&!(!e.dynamic[NSSS.homePageConstants.VALUE]||e.dynamic[NSSS.homePageConstants.BROWSERS]&&(t=SymBfw.globals.BROWSER,!e.dynamic[NSSS.homePageConstants.BROWSERS].includes(t)))}getQuickLinksDataForTelemetry(){var e=this.getQuickLinks().quicklinksData,e=e.map(e=>e.type);let t="";return e.forEach(e=>{t+=NSSS.homePageConstants.QUICKLINKS_DATA_FOR_TELEMETRY[e]+"_"}),t.slice(0,-1)}_formatApiResponse(e){if(a(e)||a(e[NSSS.homePageConstants.TILES_DATA_ELEMENT]))return null;e=e[NSSS.homePageConstants.TILES_DATA_ELEMENT];let t={};return e.forEach(e=>{t[e.name.toLowerCase()]={name:e.name.toLowerCase(),associateUrl:e.click_url,imageUrl:e.image_url,impressionUrl:e.impression_url,toolTipName:this._capitalizeFirstLetter(e.name)}}),t}async _fetchJsonFromFallbackPath(){var e=s.getExtensionURL(`json/${NSSS.homePageConstants.ENV_BASED_JSON_FILE[NSSS.constants.ENVS]}.json`);try{var t,a=await SymBfw.utils.fetch(e);if(200===a.status)return t=(await a.json()).payload,t}catch(e){return null}}async _onDownloadedCallback(e){var t,e=e.payload;await NSSS.init.ready(),n(e)&&o(e.quickLinksRequest)&&n(e.quickLinksData)?({quickLinksRequest:e,quickLinksData:t}=e,r.setQuickLinksRequest(e),r.setQuickLinksData(t)):(SymBfw.logger.error("Invalid quickLinks json payload"),NSSS.trackerLogger.logEvent(NSSS.trackerLogger.LOG_TYPE.ERROR,"Invalid quickLinks json payload"))}initializeDownloadConfigs(){var e=NSSS.homePageConstants.QUICK_LINKS_CDN_URL.replace(NSSS.homePageConstants.REPLACE_STRING,NSSS.homePageConstants.ENV_BASED_JSON_FILE[NSSS.constants.ENVS]),e={appName:NSSS.homePageConstants.APP_NAME,cdnUrl:e,schedulerIntervalInMins:NSSS.homePageConstants.SCHEDULER_INTERVAL_IN_MINS,retryIntervalInMins:NSSS.homePageConstants.RETRY_INTERVAL_IN_MINS,onDownloadedCallback:this._onDownloadedCallback};t.init(e)}}})(executionContext);class BackgroundImageConstants{get IMAGE_TYPE(){return{EXTN_IMAGE:"EXTN_IMAGE",CUSTOM_IMAGE:"CUSTOM_IMAGE",DEFAULT_IMAGE:"DEFAULT_IMAGE"}}get EXTN_BACKGROUND_IMAGES(){return[{imageId:"IMAGE_1",fileName:"bg_image_1.png"},{imageId:"IMAGE_2",fileName:"bg_image_2.png"},{imageId:"IMAGE_3",fileName:"bg_image_3.png"},{imageId:"IMAGE_4",fileName:"bg_image_4.png"}]}get BACKGROUND_IMAGES_CDN_PATH(){return"https://static.nortoncdn.com/nortonsafesearch/backgroundImages/"}}(NSSS=NSSS||{}).backgroundImageConstants=new BackgroundImageConstants,(()=>{let{NSSSHelper:t,constants:s,globalSettings:i,backgroundImageConstants:n,uiConstants:{MESSAGES:o},telemetryWrapper:r,telemetryTrackerClient:l,trackerLogger:c}=NSSS,{utils:{isNil:g,isObject:a,isString:S},logger:d,extensionAdapter:e,telemetryConstants:m}=SymBfw;NSSS.backgroundImageManager=new class{constructor(){this.handleMessage=this.handleMessage.bind(this),this.getBackgroundImageData=this.getBackgroundImageData.bind(this),this.setBackgroundImageData=this.setBackgroundImageData.bind(this),this.sendBackgroundImageDataToTabs=this.sendBackgroundImageDataToTabs.bind(this)}async sendBackgroundImageDataToTabs(e){e={name:o.BACKGROUND_IMAGE_UPDATE,message:{backgroundImageData:e}};await t.sendMessageToHomePageTabs(e)}getBackgroundImageData(){var e,t=i.getBackgroundImageSetting();return t?t.isEnabled?t.imageType===n.IMAGE_TYPE.CUSTOM_IMAGE?(e=i.getCustomBackgroundImage(),{...t,image:e}):t:{isEnabled:!1}:null}setBackgroundImageData(e,t=!1){if(!e)return d.error("Invalid param: imageData"),c.logEvent(c.LOG_TYPE.ERROR,"Invalid param: imageData"),null;var a;if(!e.isEnabled)return i.setBackgroundImageSetting(e),t||(t=e.customImageClose?s.BACKGROUND_IMAGE_SETTING.toLowerCase()+"_"+n.IMAGE_TYPE.CUSTOM_IMAGE.toLowerCase():s.BACKGROUND_IMAGE_SETTING.toLowerCase()+"_"+n.IMAGE_TYPE.DEFAULT_IMAGE.toLowerCase(),a=!e.customImageClose,r.sendSettingsToggleTelemetry(t,a),l.sendSettingsToggleTelemetry(t,a)),this.sendBackgroundImageDataToTabs(e),{isEnabled:!1};if(!e.imageType)return d.error("imageType missing in imageData"),c.logEvent(c.LOG_TYPE.ERROR,"imageType missing in imageData"),null;t=Object.assign({},e);if(t.imageType===n.IMAGE_TYPE.CUSTOM_IMAGE){if(!t.image)return d.error("Invalid param: imageData.image for custom image"),c.logEvent(c.LOG_TYPE.ERROR,"Invalid param: imageData.image for custom image"),null;i.setCustomBackgroundImage(t.image),this.sendBackgroundImageDataToTabs(e),delete t.image}else if(!t.imageId)return d.error("Invalid param: imageData.imageId for extension image"),c.logEvent(c.LOG_TYPE.ERROR,"Invalid param: imageData.imageId for extension image"),null;return i.setBackgroundImageSetting(t),r.sendSettingsToggleTelemetry(s.BACKGROUND_IMAGE_SETTING.toLowerCase()+"_"+e.imageType.toLowerCase(),e.isEnabled),l.sendSettingsToggleTelemetry(s.BACKGROUND_IMAGE_SETTING.toLowerCase()+"_"+e.imageType.toLowerCase(),e.isEnabled),this.sendBackgroundImageDataToTabs(e),e}async _setBackgroundImage(e,t,a){await NSSS.init.ready(),t({name:a,payload:this.setBackgroundImageData(e)})}handleMessage(e,t,a){if(!g(e)&&!g(e.name))switch(e.name){case o.GET_BACKGROUND_IMAGE_DATA:s=this.getBackgroundImageData(),t({name:e.name,payload:s});break;case o.SET_BACKGROUND_IMAGE_DATA:var s=e.payload;return g(s)?void 0:(s=s.imageData,this._setBackgroundImage(s,t,e.name),!0)}}_getBackgroundImageDataType(){var e=this.getBackgroundImageData();if(!a(e))return s.NOT_SET;let t=e.imageType;return S(t)?t=t===s.EXTN_IMAGE?t+"_"+e.imageId:t:s.NOT_SET}getTelemetryDataForHeartBeat(){return{[m.parameters.CUSTOM_DIMENSION30]:()=>this._getBackgroundImageDataType()}}handleRestoreToDefault(){this.setBackgroundImageData({isEnabled:!1},!0)}},NSSS.homePageFeaturesManager.registerHomePageFeature(NSSS.backgroundImageManager),e.addMessageListener(NSSS.backgroundImageManager.handleMessage)})(),(e=>{(e.NSSS=e.NSSS||{}).homePage=((s,m)=>{let h={},{telemetryWrapper:u,telemetryTrackerClient:i,trackerLogger:n,constants:_,globalSettings:T,uiConstants:{MESSAGES:o,ChickletsTourStepsData:a,HOMEPAGE_EXTENSION:E,MEDIA_DOT_NET_EXTENSION:t},abTestingDataProvider:p,homePageTourManager:r,googleAppsManager:C,nsssDarkModeHandlerBG:A,telemetryTrackerConstants:{TELEMETRY_CATEGORY:{EXT_HOME_PAGE:{QUICK_LINK_CHICKLET_TYPE:l}}}}=m,{logger:c,extensionAdapter:g,localizer:L,utils:{isNil:S,isntNil:I,isBoolean:d,isNumber:N,baseURL:k,createNewGuid:D}}=s;return h.keepAssistPopupShown=!1,h.didUserTriggerHomePageTour=!1,h._shouldShowKeepAssistUI=async function(e){var t;"Firefox"!==s.globals.BROWSER&&!h.keepAssistPopupShown&&m.uiConstants.EXTENSION_TYPE!==E&&(await m.init.ready(),t=T.getValue(_.IS_HP_FIRST_LAUNCH),S(t)||t)?(h.keepAssistPopupShown=!0,T.setValue(_.IS_HP_FIRST_LAUNCH,!1),e({showKeepAssistUI:!0})):e({showKeepAssistUI:!1})},h._shouldShowHomePageTour=()=>{if(!m.homePage.didUserTriggerHomePageTour){if(m.uiConstants.EXTENSION_TYPE!==E&&m.uiConstants.EXTENSION_TYPE!==t){var e=h._shouldShowHomePageOldTour();if(!e)return e;T.setHomepageTourLastShownTimestamp(Date.now()),u.sendTourTriggeredAutomaticallyEvent(),i.sendTourTriggeredAutomaticallyEvent()}if(I(T.getNewHpTourLastShownTimestamp()))return!1;u.sendTourTriggeredAutomaticallyEvent(),i.sendTourTriggeredAutomaticallyEvent()}return!0},h._shouldShowHomePageOldTour=()=>!I(T.getHomepageTourLastShownTimestamp()),h._shouldShowTourForCustomChickletsOnExtensionUpdate=()=>!I(T.getChickletTourLastShownTimestamp())&&(T.setChickletTourLastShownTimestamp(Date.now()),!0),h._getCustomChicklets=()=>{let e=T.getCustomChicklets();return S(e)&&((e=[...m.homePageConstants.DEFAULT_CUSTOM_CHICKLETS.customQuicklinksData]).forEach(e=>{e.id=D()}),T.setCustomChicklets(e)),e.map(e=>(e.imageUrl=m.homePageConstants.QUICK_LINKS_IMG_PATH+k(e.associateUrl.toLowerCase())+"_favicon.ico",e))},h._addEditCustomQuickLinks=t=>{var e=T.getCustomChicklets();if("edit"===t.mode){var a=e.findIndex(e=>e.id===t.chickletID);if(-1===a)return;e[a].name=t.chickletName,e[a].associateUrl=encodeURI(t.url)}else e.push({name:t.chickletName,associateUrl:encodeURI(t.url),id:s.utils.createNewGuid()});u.sendCustomChickletEventCompletion(t.mode,k(t.url.toLowerCase())),i.sendCustomChickletEventCompletion(t.mode,k(t.url.toLowerCase())),T.setCustomChicklets(e)},h._getTourStepsData=(e,t)=>t?a:e?r.getTourData():null,h._sendHomePageMetadata=async function(e){await m.init.ready();var t=L.getNavigatorLanguage(),a=m.quickLinksProvider.getQuickLinks(),s=m.homePageConstants.SECURITY_CENTER_NEWS_FEEDS,i=(s.showSecurityCenterSection=T.getShowSecurityCenterSectionValue(),{tweets:T.getTwitterFeedsData(),showTwitterSection:T.getShowTwitterSectionValue()}),n=h._shouldShowHomePageTour(),o=this._shouldShowTourForCustomChickletsOnExtensionUpdate()&&!n,r=(o&&u.sendChickletTourShownTelemetry(),this._getTourStepsData(n,o)),l=m.weatherWidgetDataManager&&m.weatherWidgetDataManager.getWidgetData(),c=m.backgroundImageManager&&m.backgroundImageManager.getBackgroundImageData(),g=A&&await A.isDarkModeSet(),S=m.settingsManager.getHomePageSettings&&await m.settingsManager.getHomePageSettings(),d={[_.AM_TIME_UNIT]:L.getLocalizedString(_.AM_TIME_UNIT),[_.PM_TIME_UNIT]:L.getLocalizedString(_.PM_TIME_UNIT)},t={direction:L.getCurrentLanguageDirection(),strings:L.getLocalizedStrings(m.uiConstants.HOMEPAGE.strings),navigatorLanguage:t,geoLocation:T.getGeoLocation(),chickeletsDataJson:I(a)?a:[],customChicklets:h._getCustomChicklets(),twitterFeeds:i,securityCenterNewsFeeds:s,shouldShowTour:m.uiConstants.EXTENSION_TYPE===E?n:n||o,tourData:r,abTestingData:p.getApplicableAppsData(),googleAppsData:C.getDefaultAppsData&&C.getDefaultAppsData(),accuWeatherData:l,settings:S,backgroundImageData:c,isDarkModeSet:g,localizedTimeUnit:d};m.homePage.didUserTriggerHomePageTour=!1,e(t)},h.sendBGLoadedMessageToTabs=function(){g.getAllTabs(e=>{e.map(e=>{g.sendMessageToTab(e,{name:o.BACKGROUND_SCRIPT_LOADED})})})},h._handleTelemetry=async function(e){switch(await m.init.ready(),e.id){case o.HOME_PAGE_TOUR_FINISHED:u.sendTourFinishedEvent(),i.sendTourFinishedEvent();break;case o.CUSTOM_QUICK_LINK_TOUR_FINISHED:u.sendChickletTourFinishedTelemetry();break;case o.HOME_PAGE_TOUR_KEY_PRESSED_FOR_CANCEL:u.sendTourKeyPressCancelEvent(),i.sendTourKeyPressCancelEvent();break;case o.HOME_PAGE_TOUR_KEY_PRESSED_FOR_NEXT:u.sendTourKeyPressNextEvent(),i.sendTourKeyPressNextEvent();break;case o.CUSTOM_QUICK_LINK_TRIGGER_EVENT:I(e.mode)&&(u.sendCustomQuickLinkTriggeredEvent(e.mode),i.sendCustomQuickLinkTriggeredEvent(e.mode));break;case o.CUSTOM_QUICK_LINK_FAILURE:I(e.failureReason)&&I(e.domain)?(u.sendCustomQuickLinkFailureEvent(e.failureReason,e.domain),i.sendCustomQuickLinkFailureEvent(e.failureReason,e.domain)):I(e.failureReason)&&(u.sendCustomQuickLinkFailureEvent(e.failureReason),i.sendCustomQuickLinkFailureEvent(e.failureReason));break;case o.EXTN_HOME_PAGE_SEARCH_SUGGESTION_CLICKED_TELEMETRY:u.sendHomePageSearchSuggestionClickedEvent(),i.sendHomePageSearchSuggestionClickedEvent();break;case o.EXTN_HOME_PAGE_SEARCH_BUTTON_CLICKED_TELEMETRY:u.sendHomePageSearchButtonClickedEvent(),i.sendHomePageSearchButtonClickedEvent();break;case o.EXTN_HOME_PAGE_LOADED_TELEMETRY:var t;I(e.width)&&I(e.height)&&(t=m.quickLinksProvider.getQuickLinksDataForTelemetry(),u.sendHomePageLoadEvent(e.width,e.height),i.sendHomePageLoadEvent(e.width,e.height,t));break;case o.EXTN_HOME_PAGE_ENGLISH_ONLY_HP_SHOWN_TELEMETRY:N(e.timeElapsed)&&N(e.searchCount)&&(u.sendEnglishOnlyHomePageShownEvent(Math.round(e.timeElapsed/1e3).toString(),e.searchCount.toString()),i.sendEnglishOnlyHomePageShownEvent(Math.round(e.timeElapsed/1e3).toString(),e.searchCount.toString()));break;case o.EXTN_HOME_PAGE_TWEET_ITEM_CLICKED:I(e.url)&&I(e.position)&&u.sendTwitterFeedClickEvent(e.url,e.position);break;case o.EXTN_HOME_PAGE_SECURITY_CENTER_NEWS_ITEM_CLICKED:I(e.url)&&I(e.position)&&u.sendSecurityCenterNewsFeedClickEvent(e.url,e.position);break;case o.TOUR_GOT_IT_CLICKED:u.sendHomePageTourGotItClick(),i.sendHomePageTourGotItClick(),h._handleTourClose();break;case o.TOUR_CLOSE_ICON_CLICKED:u.sendHomePageTourCloseClick(),i.sendHomePageTourCloseClick(),h._handleTourClose()}},h._handleSearch=async(e,t)=>{await m.init.ready(),m.searchQuery.launchTabwithSearchQuery(e,t)},h._handleQuickLinksClicked=async e=>{await m.init.ready(),g.createTab(e.url),e.chickletType===l.AD_LINKS?(u.sendHomePageChickletClickedEvent(e.chickletType,k(e.url.toLowerCase()),e.category),i.sendHomePageChickletClickedEvent(e.chickletType,e.chickletName,e.category)):e.chickletType?(u.sendHomePageChickletClickedEvent(e.chickletType,k(e.url.toLowerCase())),i.sendHomePageChickletClickedEvent(e.chickletType,e.chickletName)):(u.sendHomePageChickletClickedEvent(e.chickletName,null),i.sendHomePageChickletClickedEvent(e.chickletName,null))},h._handleCustomChickletAddEdit=async e=>{await m.init.ready(),h._addEditCustomQuickLinks(e);e={name:o.EXTN_HOME_PAGE_UPDATE_CUSTOM_CHICKLETS_LINKS,message:{customChicklets:h._getCustomChicklets()}};h._sendMessageToAllHomePageTabs(e)},h._handleCustomChickletRemove=async t=>{await m.init.ready();let e=T.getCustomChicklets();e=e.filter(e=>e.id!=t.chickletID),T.setCustomChicklets(e);var a={name:o.EXTN_HOME_PAGE_UPDATE_CUSTOM_CHICKLETS_LINKS,message:{customChicklets:h._getCustomChicklets()}};h._sendMessageToAllHomePageTabs(a),u.sendCustomChickletEventCompletion("remove",k(t.url.toLowerCase())),i.sendCustomChickletEventCompletion("remove",k(t.url.toLowerCase()))},h._setShowSecuritySectionValue=async({showSecurityCenterSection:e})=>{await m.init.ready(),T.setShowSecurityCenterSectionValue(e),u.sendSecurityCenterSectionToggleEvent(e)},h._setShowTwitterSection=async({showTwitterSection:e})=>{await m.init.ready(),T.setShowTwitterSectionValue(e),u.sendTwitterSectionToggleEvent(e)},h._openLegalPage=async()=>{await m.init.ready(),g.createTab(_.GEN_LEGAL_URL)},h._sendMessageToAllHomePageTabs=async t=>{(await m.helperUtils.getAllHomePageTabs()).forEach(e=>{g.sendMessageToTab(e,t)})},h._handleTourClose=async()=>{await m.init.ready(),T.setNewHpTourLastShownTimestamp(Date.now()),await m.NSSSHelper.sendMessageToHomePageTabs({name:o.UPDATE_HP_TOUR})},h._messageListener=function(e,t,a){var s=g.getTabID(a);if(S(e))c.error("Request cannot be null"),n.logEvent(n.LOG_TYPE.ERROR,"Request cannot be null");else{var a=e.name,i=e.message;switch(a){case o.GET_HOME_PAGE_METADATA:return h._sendHomePageMetadata(t),!0;case o.EXTN_HOME_PAGE_CHICKLET_CLICKED:S(i)||S(i.chickletName)||S(i.url)||h._handleQuickLinksClicked(i);break;case o.EXTN_HOME_PAGE_CHICKLET_SAVE_CLICKED:S(i)||h._handleCustomChickletAddEdit(i);break;case o.EXTN_HOME_PAGE_CHICKLET_TO_REMOVE:S(i)||h._handleCustomChickletRemove(i);break;case o.LAUNCH_SEARCH_TAB_WITH_URL:S(e.query)||h._handleSearch(e.query,e.isDarkModeSet);break;case o.LAUNCH_SETTINGS_PAGE:m.helperUtils.openSettingsPage();break;case o.SHOULD_SHOW_HP_KEEP_ASSIST_POPUP:return h._shouldShowKeepAssistUI(t),!0;case o.OPEN_LEGAL_PAGE:h._openLegalPage();break;case o.SET_SHOW_SECURITY_CENTER_SECTION_VALUE:d(e.showSecurityCenterSection)&&h._setShowSecuritySectionValue(e);break;case o.SET_SHOW_TWITTER_SECTION_VALUE:d(e.showTwitterSection)&&h._setShowTwitterSection(e);break;case o.HP_NEW_TOUR_CLOSED:h._handleTourClose();break;case o.CLOSE_HP_TAB:g.closeTab(s);break;case o.SEND_TELEMETRY_HOMEPAGE:S(i)||h._handleTelemetry(i)}}},g.addMessageListener(h._messageListener),h})(e.SymBfw,e.NSSS),NSSS.homePage.sendBGLoadedMessageToTabs()})(executionContext);
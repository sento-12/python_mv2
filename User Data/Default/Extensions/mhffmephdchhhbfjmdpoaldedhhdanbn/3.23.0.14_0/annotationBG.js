!function(s,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.annotationSDK=i():s.annotationSDK=i()}(this,(()=>(()=>{"use strict";var s={d:(i,t)=>{for(var a in t)s.o(t,a)&&!s.o(i,a)&&Object.defineProperty(i,a,{enumerable:!0,get:t[a]})},o:(s,i)=>Object.prototype.hasOwnProperty.call(s,i)},i={};s.d(i,{default:()=>D});const t={FETCH_WRS_RATING:"975843B2-13E8-4947-80C6-97AB31E6F696",IS_ANNOTATION_SUPPORTED_FOR_THIS_PAGE:"33E7E2A5-6FED-4BD6-8722-C92CBEFFAED2",OPEN_FULLREPORT:"0705FC0E-9629-4D48-AC2D-B00AE608EF29",FETCH_ANNOTATION_RULES:"224bd6b4-8a58-4385-b59b-00820d3014f9",ANNOTATION_POPUP_INIT:"5d4c828c-9e03-4f1c-9203-b4c7b8bd9577",DISPLAY_POPUP_MAIN_WINDOW:"04D11A9A-C255-40FF-ABB4-1B157E30D7B8",DISPLAY_POPUP_MAIN_WINDOW_CS:"30AB7916-2441-4AAB-BF89-FD5E7EA5826F"},a=["Threats","This site has not been tested yet","SAFE","SECURE","CAUTION","UNTESTED","UNSAFE","Full Report"],n={el:!0,en:!0,pt_br:!0,it:!0,ar:!0,cs:!0,es:!0,ru:!0,nl:!0,pt:!0,no:!0,nb:!0,tr:!0,ro:!0,pl:!0,fr:!0,zh_tw:!0,de:!0,hu:!0,fi:!0,da:!0,ja:!0,he:!0,zh_cn:!0,ko:!0,sv:!0},e="https://static.nortoncdn.com/nortonextensionhomepage/URLParsingRules.json",o="\n    -----BEGIN CERTIFICATE-----\n    MIIEvjCCA6agAwIBAgIQBtjZBNVYQ0b2ii+nVCJ+xDANBgkqhkiG9w0BAQsFADBh\n    MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\n    d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD\n    QTAeFw0yMTA0MTQwMDAwMDBaFw0zMTA0MTMyMzU5NTlaME8xCzAJBgNVBAYTAlVT\n    MRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxKTAnBgNVBAMTIERpZ2lDZXJ0IFRMUyBS\n    U0EgU0hBMjU2IDIwMjAgQ0ExMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC\n    AQEAwUuzZUdwvN1PWNvsnO3DZuUfMRNUrUpmRh8sCuxkB+Uu3Ny5CiDt3+PE0J6a\n    qXodgojlEVbbHp9YwlHnLDQNLtKS4VbL8Xlfs7uHyiUDe5pSQWYQYE9XE0nw6Ddn\n    g9/n00tnTCJRpt8OmRDtV1F0JuJ9x8piLhMbfyOIJVNvwTRYAIuE//i+p1hJInuW\n    raKImxW8oHzf6VGo1bDtN+I2tIJLYrVJmuzHZ9bjPvXj1hJeRPG/cUJ9WIQDgLGB\n    Afr5yjK7tI4nhyfFK3TUqNaX3sNk+crOU6JWvHgXjkkDKa77SU+kFbnO8lwZV21r\n    eacroicgE7XQPUDTITAHk+qZ9QIDAQABo4IBgjCCAX4wEgYDVR0TAQH/BAgwBgEB\n    /wIBADAdBgNVHQ4EFgQUt2ui6qiqhIx56rTaD5iyxZV2ufQwHwYDVR0jBBgwFoAU\n    A95QNVbRTLtm8KPiGxvDl7I90VUwDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG\n    CCsGAQUFBwMBBggrBgEFBQcDAjB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUHMAGG\n    GGh0dHA6Ly9vY3NwLmRpZ2ljZXJ0LmNvbTBABggrBgEFBQcwAoY0aHR0cDovL2Nh\n    Y2VydHMuZGlnaWNlcnQuY29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNydDBCBgNV\n    HR8EOzA5MDegNaAzhjFodHRwOi8vY3JsMy5kaWdpY2VydC5jb20vRGlnaUNlcnRH\n    bG9iYWxSb290Q0EuY3JsMD0GA1UdIAQ2MDQwCwYJYIZIAYb9bAIBMAcGBWeBDAEB\n    MAgGBmeBDAECATAIBgZngQwBAgIwCAYGZ4EMAQIDMA0GCSqGSIb3DQEBCwUAA4IB\n    AQCAMs5eC91uWg0Kr+HWhMvAjvqFcO3aXbMM9yt1QP6FCvrzMXi3cEsaiVi6gL3z\n    ax3pfs8LulicWdSQ0/1s/dCYbbdxglvPbQtaCdB73sRD2Cqk3p5BJl+7j5nL3a7h\n    qG+fh/50tx8bIKuxT8b1Z11dmzzp/2n3YWzW2fP9NsarA4h20ksudYbj/NhVfSbC\n    EXffPgK2fPOre3qGNm+499iTcc+G33Mw+nur7SpZyEKEOxEXGlLzyQ4UfaJbcme6\n    ce1XR2bFuAJKZTRei9AqPCCcUZlM51Ke92sRKw2Sfh3oius2FkOH6ipjv3U/697E\n    A7sKPPcw7+uvTPyLNhBzPvOk\n    -----END CERTIFICATE-----\n    ",c={CERT_ISSUER_NAME:"DigiCert TLS RSA SHA256 2020 CA1",CERT_ISSUED:"static.nortoncdn.com"},l="ANNOTATION_STORAGE_CONTAINER",d="ANNOTATION_RULES",r=1440,u=30,v="RETRY_ANNOTATION_RULES_DOWNLOAD",h="ANNOTATION_RULES_DOWNLOAD";var A,p,m;!function(s){s.middleLeft="middleLeft",s.topLeft="topLeft",s.bottomLeft="bottomLeft",s.topRight="topRight",s.bottomRight="bottomRight",s.middleRight="middleRight",s.bottomMiddle="bottomMiddle",s.topMiddle="topMiddle"}(A||(A={})),function(s){s.left="left",s.top="top",s.right="right",s.bottom="bottom"}(p||(p={})),function(s){s.SAFE="Safe",s.CAUTION="Caution",s.WARNING="Warning",s.SUSPICIOUS="Suspicious",s.UNTESTED="Untested",s.MONITORING="Monitoring",s.UNSAFE_TO_SHOP="Unsafe to Shop",s.SAFEWEB_IS_OFF="Safe Web is off",s.PAGE_NOT_ANALYZED="Page not analyzed"}(m||(m={}));const _=JSON.parse('{"yahoo":{"organic":[{"url":"//div[contains(@class,\'algo-sr\')]//div//h3//a[contains(@class,\'ac-algo\')]","description":"Common for all the Search Results"},{"url":"//div[contains(@class,\'algo-sr\')]//ul[contains(@class,\'compArticleList\')]//li[contains(@class,\'ov-a\')]//h4/a","description":"Comp Article list is the result occured when we search a keyword like bestbuyapplestore etc"},{"url":"//li[contains(@class,\'first\')]//ul/li//div[2]/p[contains(@class, \'title\')]/a","description":"Top section for specific keywords like online URL parser"},{"url":"//div[@class=\'sw-CardBase\']//div[@class=\'sw-Card__title\']/a","description":"Rule for search.yahoo.co.jp"},{"url":"//div[contains(@class,\'algo-sr\')]//div[contains(@class,\'compTitle\')]/h3//a","description":"Rule for de.search.yahoo.com"},{"url":"//div[contains(@class,\'algo-sr\')]/div[contains(@class,\'compList\')]/ul/li/a[contains(@class,\'tc\')]","description":"Rule for organic sub results"}],"advt":[{"root":"//div[contains(@class,\'AdTop\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class, \'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in top section"},{"root":"//div[contains(@class,\'AdTop\') or contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class, \'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutBottom\') or contains(@class, \'layoutCenter\')]//ul[contains(@class, \'ov-a\')]/li/a","description":"Advt Sub Results in top section for hk.yahoo"},{"root":"//div[contains(@class,\'AdTop\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in top section sg.search.yahoo"},{"root":"//div[contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]/div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in bottom section"},{"root":"//div[contains(@class,\'AdBttm\')]","parentText":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","parentUrl":".//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readParentUrlAsTextElement":true,"childItems":".//div[contains(@class,\'layoutCenter\')]//div[contains(@class,\'compList\')]/ul/li/a","description":"Advt Sub Results in bottom section sg.search.yahoo"},{"text":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","url":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in top section but below sub advt results"},{"text":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","url":"//div[contains(@class,\'AdTop\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in top section but below sub advt results"},{"text":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/h3/a","url":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in bottom section but below sub advt results"},{"text":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/h3[contains(@class,\'title\')]/span[1]","url":"//div[contains(@class,\'AdBttm\')]//div[contains(@class,\'layoutMiddle\')]//div[contains(@class,\'compTitle\')]/a/div/span[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Advt Results in bottom section but below sub advt results"},{"text":"//div[contains(@id, \'right\')]//div[contains(@class,\'layoutMiddle\')]/div[contains(@class,\'compTitle\')]/h3[contains(@class, \'title\')]/a","url":"//div[contains(@id, \'right\')]//div[contains(@class,\'layoutMiddle\')]/div[contains(@class,\'compTitle\')]/div/a[contains(@class,\'ad-domain\')]","readUrlAsTextElement":true,"description":"Right side ad results"}]},"ask":{"organic":[{"url":"//div[contains(@class,\'result\')]/div[contains(@class,\'result-title\')]/a[contains(@class, \'result-title-link\')]","description":"Common for all the Search Results - new"},{"url":"//div[contains(@class,\'search-results\')]/div[contains(@class,\'results\')]//div[contains(@class,\'result\')]/div[contains(@class,\'result-title\')]/a[1]","description":"Common for all new Search Results"},{"url":"//div[contains(@class,\'PartialSearchResults\')]//div[contains(@class,\'PartialSearchResults-item\')]/div[contains(@class,\'PartialSearchResults-block-right\')]/div[contains(@class, \'PartialSearchResults-item-title\')]//a[1]","description":"Common for all the Search Results"},{"description":"New ASK SERP page - Common for all the Search Results","readUrlAsTextElement":true,"url":"//div[contains(@class,\'search-results\')]//div[contains(@class,\'results\')]/div[contains(@class,\'result\')]/div[contains(@class, \'result-url-section\')]//a//span[contains(@class,\'result-url\')]","text":"//div[contains(@class,\'search-results\')]//div[contains(@class,\'results\')]/div[contains(@class,\'result\')]/div[contains(@class, \'result-title\')]//a"}],"advt":[{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]//div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]//div[contains(@class,\'si33\')]//a[contains(@class,\'si44\')]","readUrlAsTextElement":true,"description":"new advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si33\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section for mac"},{"text":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"top side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"Bottom side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si39\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si41\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si43\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si42\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si49\')]/a","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si43\')]/a","readUrlAsTextElement":true,"description":"top side advt section"},{"description":"New ASK SERP page - advt section","readUrlAsTextElement":true,"url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'clicktrackedAd_js\')]//div[contains(@class,\'si43\')]/a","text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'clicktrackedAd_js\')]//div[contains(@class,\'si49\')]/a"}]},"avira":{"organic":[{"url":"//div[contains(@class,\'result\')]/div[contains(@class,\'result-title\')]/a[contains(@class, \'result-title-link\')]","description":"Common for all the Search Results - new"},{"url":"//div[contains(@class,\'search-results\')]/div[contains(@class,\'results\')]//div[contains(@class,\'result\')]/div[contains(@class,\'result-title\')]/a[1]","description":"Common for all new Search Results"},{"url":"//div[contains(@class,\'PartialSearchResults\')]//div[contains(@class,\'PartialSearchResults-item\')]/div[contains(@class,\'PartialSearchResults-block-right\')]/div[contains(@class, \'PartialSearchResults-item-title\')]//a[1]","description":"Common for all the Search Results"},{"description":"New ASK SERP page - Common for all the Search Results","readUrlAsTextElement":true,"url":"//div[contains(@class,\'search-results\')]//div[contains(@class,\'results\')]/div[contains(@class,\'result\')]/div[contains(@class, \'result-url-section\')]//a//span[contains(@class,\'result-url\')]","text":"//div[contains(@class,\'search-results\')]//div[contains(@class,\'results\')]/div[contains(@class,\'result\')]/div[contains(@class, \'result-title\')]//a"}],"advt":[{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]//div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]//div[contains(@class,\'si33\')]//a[contains(@class,\'si44\')]","readUrlAsTextElement":true,"description":"new advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si32\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si101\')]/div[contains(@class,\'si33\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section for mac"},{"text":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div[contains(@id,\'ssrad-master\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"top side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[2]/a","url":"//div[contains(@id,\'adBlock\')]/div/div[contains(@class, \'clicktrackedAd_js\')]/div[1]/a","readUrlAsTextElement":true,"description":"Bottom side advt section for windows"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si39\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si41\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si43\')]//a[contains(@class,\'si27\')]","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si42\')]//a[contains(@class,\'si28\')]","readUrlAsTextElement":true,"description":"top side advt section"},{"text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si49\')]/a","url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'si43\')]/a","readUrlAsTextElement":true,"description":"top side advt section"},{"description":"New ASK SERP page - advt section","readUrlAsTextElement":true,"url":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'clicktrackedAd_js\')]//div[contains(@class,\'si43\')]/a","text":"//div[contains(@id,\'adBlock\')]//div[contains(@class,\'clicktrackedAd_js\')]//div[contains(@class,\'si49\')]/a"}]},"google":{"organic":[{"url":"//div[@id=\'main\']//div[@id=\'res\']//div[@class=\'yuRUbf\']//a","description":"Common search results"},{"url":"//g-section-with-header//div[contains(@class,\'EPLo7b\')]//div[contains(@class,\'HCUNre\')]/a","text":"//g-section-with-header//div[contains(@class,\'EPLo7b\')]//div[contains(@class,\'HCUNre\')]/a//div[contains(@role,\'heading\')]","description":"Top Stories section"},{"root":"//div[contains(@id,\'search\')]//div[contains(@class,\'hlcw0c\')]/div[contains(@class,\'g\')]","parentUrl":".//div[contains(@class,\'yuRUbf\')]/a","childItems":".//div[contains(@class,\'usJj9c\')]/h3/a","description":"Sub Results"},{"url":"//div[@id=\'botstuff\']//div[@class=\'yuRUbf\']//a","description":"Search results - on scroll"}],"advt":[{"url":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a","text":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a/div[contains(@class,\'MUxGbd\')]","description":"Top advt section without sub results"},{"url":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a","text":"//div[contains(@class,\'uEierd\')]//div[contains(@class,\'v5yQqb\')]/a/div[contains(@class,\'EE3Upf\')]","description":"Top advt section without sub results"},{"root":"//div[contains(@class,\'uEierd\')]","parentUrl":".//div[contains(@class,\'v5yQqb\')]/a/div[2]/span[2]","parentText":".//div[contains(@class,\'v5yQqb\')]/a/div[contains(@class,\'MUxGbd\')]","childItems":".//div[contains(@class,\'fCBnFe\')]/h3/div[contains(@role,\'listitem\')]/a","readParentUrlAsTextElement":true,"description":"Sub Results"}]},"bing":{"organic":[{"url":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]//h2/a","description":"Common for all the Search Results"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":"./h2/a","childItems":".//ul[contains(@class,\'b_vList\')]//div[contains(@class,\'b_listnav_item\')]/div[contains(@class,\'b_single_title\')]/a","description":"Sub Results in single colum"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":".//div[contains(@class, \'b_title\')]/h2/a","childItems":".//div[contains(@class,\'dlCollapsedCnt\')]/div[contains(@class,\'b_deep\')]//h3/a","description":"Organic sub results in bing japan url"},{"root":"//ol[contains(@id,\'b_results\')]//li[contains(@class,\'b_algo\')]","parentUrl":"./h2/a","childItems":".//div[contains(@class,\'dlCollapsedCnt\')]/div[contains(@class,\'b_deep\')]//h3/a","description":"Sub Results which occurs under the search results e.g norton"},{"url":"//ol[contains(@id,\'b_results\')]//div[contains(@class,\'b_algo\')]/h2/a","description":"Top and Bottom Bleed results when searching oops polymorphism etc"},{"url":"//ol[contains(@id,\'b_results\')]//div[contains(@class,\'b_rs\')]//ul[contains(@class,\'b_vList\')]/li/a","description":"Results of related searches which is displayed on the footer"}],"advt":[{"text":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]/h2/a[last()]","url":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]//div[contains(@class,\'b_adurl\')]/cite","description":"top and bottom advt section"},{"root":"//li[contains(@class,\'b_ad\')]//div[contains(@class,\'sb_adTA\')]","parentUrl":".//div[contains(@class,\'b_caption\')]//div[contains(@class,\'b_adurl\')]/cite","parentText":".//h2//a[contains(@h,\'Ads\')]","childItems":".//div[contains(@class,\'b_vlist2col\')]//h3[contains(@class,\'ad\')]/a | .//div[contains(@class,\'b_vlist2col\')]//span[contains(@class,\'ad\')]/a","readParentUrlAsTextElement":true,"description":"Sub Results advt section"}]}}'),T=globalThis.SymBfw,g=globalThis.SafeWeb,{settings:R}=T,b=new class{constructor(){this._container=null}_checkInitialized(){if(!this._container)throw new Error("Storage accessed before initialization")}initialize(){return new Promise(((s,i)=>{R.loadSettingsContainer(l,!0,((t,a,n)=>{!1!==t&&a?(this._container=a,s(!0)):i(n)}))}))}getValue(s){return this._checkInitialized(),this._container.getObject(s)}setValue(s,i){this._checkInitialized(),this._container.setObject(s,i)}};var E=function(s,i,t,a){return new(t||(t=Promise))((function(n,e){function o(s){try{l(a.next(s))}catch(s){e(s)}}function c(s){try{l(a.throw(s))}catch(s){e(s)}}function l(s){var i;s.done?n(s.value):(i=s.value,i instanceof t?i:new t((function(s){s(i)}))).then(o,c)}l((a=a.apply(s,i||[])).next())}))};const{cdnFileDownloader:f,logger:S,alarmHelper:B}=T;class I{static _retryFetchRules(){return E(this,void 0,void 0,(function*(){B.setAlarm(v,{delayInMinutes:u})}))}static _fetchRules(){return E(this,void 0,void 0,(function*(){try{const s=yield f.getPayloadFromCdnFile(e,o,c);b.setValue(d,s)}catch(s){S.error("Fetching rules from CDN failed.",s),I._retryFetchRules()}}))}static initializeRules(){return E(this,void 0,void 0,(function*(){yield b.initialize(),b.getValue(d)||(yield I._fetchRules()),I.createRulesDownloadAlarm()}))}static _handleAnnotationRulesAlarm(){return E(this,void 0,void 0,(function*(){yield b.initialize(),yield I._fetchRules()}))}static createRulesDownloadAlarm(){return E(this,void 0,void 0,(function*(){yield B.setAlarm(h,{periodInMinutes:r})}))}static handleAlarm(s){s&&s.name&&(s.name!==h&&s.name!==v||I._handleAnnotationRulesAlarm())}}T.alarmHelper.registerAlarmListener(I.handleAlarm);var U=function(s,i,t,a){return new(t||(t=Promise))((function(n,e){function o(s){try{l(a.next(s))}catch(s){e(s)}}function c(s){try{l(a.throw(s))}catch(s){e(s)}}function l(s){var i;s.done?n(s.value):(i=s.value,i instanceof t?i:new t((function(s){s(i)}))).then(o,c)}l((a=a.apply(s,i||[])).next())}))};const N=t,{cdnFileDownloader:y,extensionAdapter:w,localizer:P,logger:C,utils:{isntNil:x}}=T,k=g.Rating,D={AnnotationBG:class{constructor(){this._enableFlag=!0,this._domains=null,this._uiConfig=null,this._safeWebInitPromise=void 0,this._supportedDomains=null,this._initReadyPromise=null,this.initializeLocalizer=function(){const s=w.getExtensionURL("/content/i18n/annotationsdk");return new Promise(((i,t)=>{P.initialize(n,(function(s,i){!0===s&&C.debug("localizer initialize success")}),s),P.loadDictionary("annotation_strings",((s,a)=>{!0===s?(C.debug("Loading annotation Strings status - "+s),i("localizer is ready")):t("localizer loadDictionary failed: "+a)}))}))}}_getSiteStatus(s){let i=m.PAGE_NOT_ANALYZED;switch(s){case k.SITE_RATING.RATING_PHISHING:case k.SITE_RATING.RATING_MALWARE:i=m.WARNING;break;case k.SITE_RATING.RATING_REGIONAL_BLOCK:i=m.SUSPICIOUS;break;case k.SITE_RATING.RATING_SAFE:i=m.SAFE;break;case k.SITE_RATING.SW_DISABLED_STATE:i=m.SAFEWEB_IS_OFF;break;default:i=m.PAGE_NOT_ANALYZED}return i}_fetchRatingsFromSafewebSDK(s,i,t){return U(this,void 0,void 0,(function*(){let a,n;const e={senderURL:t},o={senderURL:t,bAdvtFlag:!0};return this._safeWebInitPromise&&(yield this._safeWebInitPromise),a=0===s.length?[]:this._getRatingsFromSafeweb(s,e),n=0===i.length?[]:this._getRatingsFromSafeweb(i,o),(yield Promise.all([a,n])).flat()}))}_getRatingsFromSafeweb(s,i){const t=g.manager,a=this;return new Promise((n=>{t.getRatingsForURLs(s,(s=>{n(s.map((s=>{var i,t;s.siteStatus=a._getSiteStatus(s.siteRating);const n=null===(t=null===(i=this._uiConfig)||void 0===i?void 0:i.popupUIConfig)||void 0===t?void 0:t.isShowFullReport;return x(n)?s.showFullReport=n:s.showFullReport=s.siteRating!==k.SITE_RATING.RATING_REGIONAL_BLOCK,s})))}),i)}))}_checkAnnotationSupportedForThisPage(s,i){return U(this,void 0,void 0,(function*(){yield this.ready(),i(this._isSearchDomainSupported(s))}))}_fetchAnnotationRules(s,i){return U(this,void 0,void 0,(function*(){yield this.ready();const t=new URL(s),a=b.getValue(d)||_,n=Object.keys(a).find((s=>t.hostname.includes(`.${s}.`)));setTimeout((()=>{i(a[n])}),1e3)}))}_fetchWrsRating(s,i,t,a){return U(this,void 0,void 0,(function*(){this.isAnnotationEnabled()&&this._isSearchDomainSupported(s)?(yield this.ready(),this._fetchRatingsFromSafewebSDK(i,t,s).then(a)):a(null)}))}_initAnnotationPopup(s){return U(this,void 0,void 0,(function*(){yield this.ready();const i={strings:{},uiConfig:this._uiConfig};i.strings=P.getLocalizedStringsFromDictionary(a,"annotation_strings"),s(i)}))}_handleMessage(s,i,t){const a=s.payload;switch(s.id){case N.OPEN_FULLREPORT:a.fullReportURL&&w.createTab(a.fullReportURL);break;case N.IS_ANNOTATION_SUPPORTED_FOR_THIS_PAGE:return this._checkAnnotationSupportedForThisPage(t.url,i),!0;case N.FETCH_ANNOTATION_RULES:return this._fetchAnnotationRules(t.url,i),!0;case N.FETCH_WRS_RATING:return this._fetchWrsRating(t.url,a.urls,a.AdvtURLs,i),!0;case N.ANNOTATION_POPUP_INIT:return this._initAnnotationPopup(i),!0;case N.DISPLAY_POPUP_MAIN_WINDOW:a.uiConfig=this._uiConfig;const s={id:N.DISPLAY_POPUP_MAIN_WINDOW_CS,payload:a};w.sendMessageToTab(t,s)}}_isSearchDomainSupported(s){const i=new URL(s);return this._domains.supportedDomains.filter((s=>i.hostname.match(s.domain))).some((s=>{const t=s.params;if(!t)return!0;const a=i.searchParams;return Object.entries(t).every((([s,i])=>!!a.has(s)&&(i.includes("*")||i.includes(a.get(s)))))}))}isAnnotationEnabled(){return this._enableFlag}enableAnnotation(s){this._enableFlag=s}ready(){return U(this,void 0,void 0,(function*(){yield this._initReadyPromise}))}_initializeListeners(s,i){try{this._handleMessage=this._handleMessage.bind(this),w.addMessageListener(this._handleMessage),Promise.all([this.initializeLocalizer(),I.initializeRules()]).then((i=>{s("Initialized Annotation SDK")})).catch((s=>{i("Annotaion BG listeners initialization error: "+s)}))}catch(s){i("Annotaion BG listeners initialize failed: "+s)}}init(s){return U(this,void 0,void 0,(function*(){return this._domains=s.domains,this._safeWebInitPromise=s.safeWebInitPromise,this._uiConfig=s.uiConfig,x(this._initReadyPromise)||(this._initReadyPromise=new Promise(((s,i)=>{this._initializeListeners(s,i)}))),this._initReadyPromise}))}}};return i.default})()));
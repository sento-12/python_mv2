/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2024 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="FOCUS_OR_CREATE_TAB",t="SHOW_SIDEBAR_MAIN",o="PING_CONTENT_SITE_LISTENER",s=0,n=23,r=24,i=0;const c=0,a="PRINT_IN_BACKGROUND",d={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4,ALL_IN_BACKGROUND:99},l=1,h=2,u=3,g=4,m={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},p={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};const f=new class{constructor(){this.storageChecked=!1,this.logLevel=null,this.queue=[];const e="MCLOGLEVEL";chrome?.storage?.local.get([e]).then((t=>{const o=Object.values(d).includes(t[e]);this.logLevel=o?t[e]:c,this.logLevel!==d.NONE&&this.queue.forEach((({callback:e,message:t,processType:o})=>{e(t,o)})),this.queue=[],this.storageChecked=!0}))}log(e,t=null){this.storageChecked?this.processLog(e,l,t,this.logLevel):this.queue.push({callback:this.log.bind(this),message:e,processType:t})}error(e,t=null){this.storageChecked?this.processLog(e,h,t,this.logLevel):this.queue.push({callback:this.error.bind(this),message:e,processType:t})}warn(e,t=null){this.storageChecked?this.processLog(e,u,t,this.logLevel):this.queue.push({callback:this.warn.bind(this),message:e,processType:t})}debug(e,t=null){this.storageChecked?this.processLog(e,g,t,this.logLevel):this.queue.push({callback:this.debug.bind(this),message:e,processType:t})}processLog(e,t,o,s){if(s===d.NONE)return;let n="chrome-extension:"===location.protocol?m.BACKGROUND:m.CONTENT;o&&m[o]&&(n=o);const r=new Date,i=t===h?e:`%c[${n} ${r.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}]: %c${e}`;n===m.CONTENT&&this.logLevel===d.ALL_IN_BACKGROUND&&chrome.runtime.sendMessage({command:a,logMessage:i,processType:n,logType:t,logLevel:s}),this.printLog(i,n,t,s)}printLog(e,t,o,s){const n=p.DEFAULT,r=p[t]||n;if(s>=d.ERROR&&o===h&&console.error(e),s>=d.INFO&&o===l&&console.log(e,r,n),s>=d.WARN&&o===u){const t="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${e}`,t,r,n)}if(s>=d.DEBUG&&o===g){const t="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${e}`,t,r,n)}}};class E{constructor(e){this.pingCommand=e,this.basePingListener(),this.addIdentifier()}basePingListener(e=null){((e,t=null,o)=>{"function"==typeof o?chrome.runtime.onMessage.addListener(((s,n,r)=>{if(n.id===chrome.runtime.id&&"object"==typeof s&&!Array.isArray(s)&&s?.ipcId===e)return o({promises:t,request:s,sender:n,sendResponse:r})})):f.error("Provided with invalid callback function")})("WA",null,(({request:t,sendResponse:o})=>{const{command:s}=t;if(s===this.pingCommand)return f.debug(`File Injection [pinged]: Received ${s} command`),o({content:!0}),"function"==typeof e&&e(),!0}))}addIdentifier(){var e;e=()=>{const e=document.createElement("span");e.id=this.pingCommand,e.style.cssText="display:none",document.body.appendChild(e)},"undefined"!=typeof document&&null!==document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e))}}const b=async(e,t,o,s)=>{try{chrome.tabs.sendMessage(s,{ipcId:e,command:t,...o},{},(()=>{chrome.runtime.lastError}))}catch(e){f.warn(`[broadcast] Unexpected error when calling command: "${t}", err: ${e.message}`)}},L=(e,t,o,s,n=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');const r={};return"number"==typeof n&&(r.frameId=n),chrome.tabs.sendMessage(s,{ipcId:e,command:t,...o},r)},N=(e,t={},o)=>(async(e,t,o={},s={})=>{try{if(s?.tabId){const{tabId:n,frameId:r}=s;return await L(e,t,o,n,r)}if(s?.broadcast){const n=await chrome.tabs.query({}),{broadcastIgnoreId:r=[]}=s;return n.filter((({id:e})=>!r.includes(e))).forEach((({id:s})=>{b(e,t,o,s)})),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...o})}catch(e){return f.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,o);(new class extends E{constructor(){super(o)}main(){window.addEventListener("message",(o=>{if(!o)return;const{data:c}=o;if(!c)return;const{request_type:a,payload:d}=c;if(void 0!==a&&void 0!==d){if(a!==s||d.done||window.postMessage({request_type:i,payload:{done:!0}},o.origin),a===n){const t=chrome.runtime.getURL("html/settings.html");N(e,{url:t})}a===r&&N(t)}}),!1)}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_site_listener.js.map
/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2024 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="SESSION_STORE",t="GET_BK_GLOBALS",a="PING_CONTENT_APS_OBSERVER",s={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},n=(Object.values(s).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:o,...i}=s,r="SET",l="GET",c={name:"BLOCK_PAGE_WHITELIST",type:"array"},u={name:"POPUP_STATS",type:"object"},d={name:"RAT_DETECTION_WHITELIST",type:"array"},m={name:"LAST_ANTITRACKER_SCAN_RESULT",type:"object"},g={name:"ANTITRACKER_UPSELL_TASK",type:"object"},h={name:"FINGER_PRINT",type:"number"},p={name:"FIRST_PARTY",type:"number"},b={name:"THIRD_PARTY",type:"number"},f={name:"TRACKER_DOMAIN_LIST",type:"array"},y={name:"ANTITRACKER_WHITELIST",type:"array"},w={name:"TYPOSQUATTING_WHITELIST",type:"array"},v={name:"CACHE_TAB_DATA",type:"object"},k={name:"APS_EMAIL_LINKS",type:"array"},x=chrome,E={GREEN:0,YELLOW:1,RED:2,GREY:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"GREY"!==e&&(yield this[e])}},S=1,_=2,T=3,A=0,O=1,N=3,I=2,R="1.0.0.36",D=-1,L=0,C=1,j=2,U=3,P=70,z=31,q=16,B=1,F=x.runtime.getURL(""),H={fingerPrintDomains:h.name,firstParty:p.name,thirdPartyTrackers:b.name};const W=0,G="PRINT_IN_BACKGROUND",$={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4,ALL_IN_BACKGROUND:99},M=1,K=2,V=3,Y=4,X={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},J={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};const Q=new class{constructor(){this.storageChecked=!1,this.logLevel=null,this.queue=[];const e="MCLOGLEVEL";chrome?.storage?.local.get([e]).then((t=>{const a=Object.values($).includes(t[e]);this.logLevel=a?t[e]:W,this.logLevel!==$.NONE&&this.queue.forEach((({callback:e,message:t,processType:a})=>{e(t,a)})),this.queue=[],this.storageChecked=!0}))}log(e,t=null){this.storageChecked?this.processLog(e,M,t,this.logLevel):this.queue.push({callback:this.log.bind(this),message:e,processType:t})}error(e,t=null){this.storageChecked?this.processLog(e,K,t,this.logLevel):this.queue.push({callback:this.error.bind(this),message:e,processType:t})}warn(e,t=null){this.storageChecked?this.processLog(e,V,t,this.logLevel):this.queue.push({callback:this.warn.bind(this),message:e,processType:t})}debug(e,t=null){this.storageChecked?this.processLog(e,Y,t,this.logLevel):this.queue.push({callback:this.debug.bind(this),message:e,processType:t})}processLog(e,t,a,s){if(s===$.NONE)return;let n="chrome-extension:"===location.protocol?X.BACKGROUND:X.CONTENT;a&&X[a]&&(n=a);const o=new Date,i=t===K?e:`%c[${n} ${o.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}]: %c${e}`;n===X.CONTENT&&this.logLevel===$.ALL_IN_BACKGROUND&&chrome.runtime.sendMessage({command:G,logMessage:i,processType:n,logType:t,logLevel:s}),this.printLog(i,n,t,s)}printLog(e,t,a,s){const n=J.DEFAULT,o=J[t]||n;if(s>=$.ERROR&&a===K&&console.error(e),s>=$.INFO&&a===M&&console.log(e,o,n),s>=$.WARN&&a===V){const t="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${e}`,t,o,n)}if(s>=$.DEBUG&&a===Y){const t="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${e}`,t,o,n)}}};class Z{constructor(e){this.pingCommand=e,this.basePingListener(),this.addIdentifier()}basePingListener(e=null){((e,t=null,a)=>{"function"==typeof a?chrome.runtime.onMessage.addListener(((s,n,o)=>{if(n.id===chrome.runtime.id&&"object"==typeof s&&!Array.isArray(s)&&s?.ipcId===e)return a({promises:t,request:s,sender:n,sendResponse:o})})):Q.error("Provided with invalid callback function")})("WA",null,(({request:t,sendResponse:a})=>{const{command:s}=t;if(s===this.pingCommand)return Q.debug(`File Injection [pinged]: Received ${s} command`),a({content:!0}),"function"==typeof e&&e(),!0}))}addIdentifier(){var e;e=()=>{const e=document.createElement("span");e.id=this.pingCommand,e.style.cssText="display:none",document.body.appendChild(e)},"undefined"!=typeof document&&null!==document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e))}}class ee{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:a}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},s={};return s[T]=a,s[S]=t,s[_]=e,s[I]}}const{SYSTEM:te,USER:ae}={SYSTEM:0,USER:1},se=ee.getBrowserSuffix(),ne={DEV_MODE:{scope:te,name:"dev_mode",value:!1},AFF_ID:{scope:te,name:"*Affid",value:0},BINARY_VERSION:{scope:te,name:"version",value:null},EXTENSION_VERSION_CH:{scope:te,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:te,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:te,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:te,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:te,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:te,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:ae,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${se}`,value:""},SECURE_SEARCH_REGEXES:{scope:ae,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:ee.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:te,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:ae,name:`*SSDateStampShowedToast${se}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:te,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:ae,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:ae,name:`*SSToastChoice${se}`,value:!1},SS_DEF:{scope:te,name:`*SS_DEF${se}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:te,name:`*AnnotationsChoiceExplicit${se}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:ae,name:`*CurrentSAOInExtension${se}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:ae,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:ae,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:te,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:te,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:te,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:te,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:te,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:te,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:te,name:"CryptojackingDisabled",value:!0},SMA_USER_TOGGLE:{scope:te,name:`sma_user_toggle${se}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:te,name:`sma_annotation_options${se}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:te,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:te,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:te,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:te,name:"*CounterDownloadsBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:ae,name:"*WhiteList",value:""},TS_WHITELIST:{scope:ae,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:te,name:"CSPIdValue",value:"__not_available__"},MTI_CLIENT_ID:{scope:te,name:"gti_client_id",value:""},JWT_TOKEN_ENABLED:{scope:te,name:"jwt_token_enabled",value:!1},UNINSTALL_SURVEY_ENABLED:{scope:te,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:te,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:te,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:te,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:te,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:te,name:"aps_toggle_setting",value:!0},ALT_TRIGGER:{scope:te,name:"alt_triggers_cohort",value:0},ANNOTATION_JOURNEY_COHORT:{scope:te,name:`annotation_journey_cohort${se}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:ae,name:`aj_toast${se}`,value:null},DAILY_GREEN_URLS_TO_COLLECT:{scope:te,name:"daily_green_urls_to_collect",value:0},FEATURE_COLLECTION_ENABLED:{scope:te,name:"feature_collection_enabled",value:!1},DAILY_GREEN_URLS_RESET_RATE:{scope:te,name:"daily_green_urls_reset_rate",value:0},HERON_REPORT_ENABLED:{scope:te,name:"heron_report_enabled",value:!1},SAMPLING_RATE_BLOCK_DEFAULT:{scope:te,name:"sampling_rate_block_default",value:100},SAMPLING_RATE_USER_FEEDBACK:{scope:te,name:"sampling_rate_user_feedback",value:1},WA_EXTN_UUID:{scope:ae,name:`wa_extn_uuid${se}`,value:"",writeOnly:!0},MOCKINGBIRD_ENABLED:{scope:te,name:"mockingbird_enabled",value:!0},TYPOSQUAT_ENABLED:{scope:te,name:"typosquat_enabled",value:!0},DFD_FEEDBACK_ENABLED:{scope:te,name:"dfd_feedback_enabled",value:!1}};class oe{static getResetValues(){return{blockedIframes:[],tabDomainTrusted:!1,mockingbird:{},mbVideoId:null}}static getDefaultValues(){return oe.getResetValues()}reset(e){const t=ve.localStore.get(v.name,{}),a=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;ve.htiReportHandler.checkBacklog(e,t[e],a),this.update(e,oe.getResetValues())}get(e){return ve.localStore.get(v.name,{})[e]||oe.getDefaultValues()}set(e,t){const a=ve.localStore.get(v.name,{});a[e]=t,ve.localStore.set(v.name,a)}delete(e){const t=ve.localStore.get(v.name,{}),a=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;ve.htiReportHandler.checkBacklog(e,t[e],a),delete t[e],ve.localStore.set(v.name,t)}update(e,t){const a=this.get(e);this.set(e,{...a,...t})}setTabBlockPageData(e,t,a=!0){const s={...this.get(e),blockPageData:t};this.set(e,s),a&&!t.url.includes("chrome://extensions/")&&ve.htiReportHandler.addReportToBacklog(e,s)}addBlockedFrame(e,t){const a=this.get(e);a.blockedIframes.push(t),this.update(e,a),ve.htiReportHandler.addIFrameReportToBacklog(e,a)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){const t=this.get(e);t.blockedIframes=[],this.update(e,t)}}const ie="ph",re="www.siteadvisor.com/",le="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",ce="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",ue="https://sadownload.mcafee.com/products/SA/Win/extensions/sailor/condition.json",de="https://sadownload.mcafee.com/products/SA/Win/extensions/antitracker/all_trackers.json",me="https://threat.api.mcafee.com/",ge="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/condition.json",he=new Set(["www.mcafee.com"]),pe="PAGES_SCANNED",be="PAGES_BLOCKED",fe="DOWNLOADS_SCANNED",ye="DOWNLOADS_BLOCKED";class we{static init(){const e=this.read(),{PAGES_SCANNED:t,PAGES_BLOCKED:a,DOWNLOADS_SCANNED:s,DOWNLOADS_BLOCKED:n}=ve.nativeSettings,o={pagesScanned:t.value||e.pagesScanned,pagesBlocked:a.value||e.pagesBlocked,downloadsScanned:s.value||e.downloadsScanned,downloadsBlocked:n.value||e.downloadsBlocked};ve.localStore.set(u.name,o)}static add(e){const t=this.read();switch(e){case pe:t.pagesScanned++;break;case be:t.pagesBlocked++;break;case fe:t.downloadsScanned++;break;case ye:t.downloadsBlocked++;break;default:return}ve.localStore.set(u.name,t)}static read(){const e={pagesScanned:0,pagesBlocked:0,downloadsScanned:0,downloadsBlocked:0},t=ve.localStore.get(u.name);return t&&Object.assign(e,t),e}}const ve={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:I,sessionStore:null,localStore:null,idb:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new oe,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:le,tldParser:null,urlParser:null,trustedDomains:he,nativeSettings:ne,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],preconditions:null,platform:class{static debounce(e,t,a){let s;return(...n)=>{const o=a&&!s;clearTimeout(s),s=setTimeout((()=>{s=null,a||e(...n)}),t),o&&e(...n)}}static isBrowserEN(){return x.i18n.getUILanguage().toLowerCase().startsWith("en")}static isChromeBrowser(){const e=navigator.userAgent.toLowerCase();return!(!e.includes("chrome")||!1==!!chrome)&&(!e.includes("opr")&&!e.includes("edg"))}static isWindowsOS(){const{platform:e}=navigator;return e&&-1!==e.search("Win")}static getPlatform(){const{platform:e}=navigator;let t=A;return-1!==e.search("Mac")?t=O:-1!==e.search("iPhone")&&(t=N),t}}.getPlatform(),wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:ce,engineCheckInterval:864e5,ENGINES_VERSION:R,AUTO_PLAY_NOTIFICATION_ENABLED:!1,DLS_POPUP_FOR_WA_NATIVE_ENABLED:!1,WA_EXTN_CONDITION_URL:ge,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,typosquattingHandler:null,URL_DOWNLOAD_MAX_CACHE:100,URL_DOWNLOAD_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["buy/payselect/handlers","buy/addressselect/handlers"]}},email:{"mail.google.com/mail":{selector:"table[role=presentation] > tr div[data-message-id] a"},"outlook.live.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=complementary][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,wpsRequestedSettings:new Set(["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"]),permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com"],mtiRequestor:null,htiServer:me,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6",sailer:null,sailorConditionUrl:ue,allTrackerUrl:de,antitrackData:new class{init(){ve.wssMessageDispatcher?.nativeDispatcher?.getATUpsellFlag((e=>{e?.antitrack_upsell_config?.enabled&&ve.scheduleManager.setEnabled(g.name,!0)}))}isActive(){return!ve.isAntitrackerExtInstalled}isWhiteListed(e,t){return ve.localStore.get(y.name,["mcafee.com"]).some((t=>e.includes(t)))||t.includes("fi")}addCountTo(e,t=1){const a=ve.localStore.get(e,0);ve.localStore.set(e,a+t)}getAndResetCount(e){const t=ve.localStore.get(e,0);return ve.localStore.set(e,0),t}addLatestDomain(e,t){try{this.addCountTo(t);const a=new Date,s=`${a.getFullYear()}${a.getMonth()}${a.getDate()}`,n=new URL(e).hostname.replace("www.",""),o=this.getDomainList();o.dataDate!==s&&(o.dataDate=s,o.domainHistoryMap={}),o.lastVisited=n,o.domainHistoryMap=o.domainHistoryMap||{},(o.domainHistoryMap[n]||Object.keys(o.domainHistoryMap).length<50)&&(o.domainHistoryMap[n]=(o.domainHistoryMap[n]||0)+1),ve.localStore.set(f.name,o)}catch(e){Q.log(`[AntitrackerData] Error adding last domain: ${e.message||e}`)}}getDomainList(){const e=ve.localStore.get(f.name,{});return JSON.parse(JSON.stringify(e))}updateWPS(e){try{e=e?JSON.parse(e):{};const{pagesBlocked:t=0,pagesScanned:a=0}=we.read();let s=0;Object.values(H).forEach((t=>{const a=t.toLowerCase(),n=(e[a]||0)+this.getAndResetCount(t);e[a]=n,s+=n})),e.total_trackers=s,e.blocked_pages=t,e.scanned_pages=a,e.last_visited="",e.domain_history="",0===e.total_trackers&&0===e.blocked_pages&&0===e.scanned_pages&&""===e.last_visited&&""===e.domain_history||!this.isSameAsLastScan(e)&&ve.wssMessageDispatcher&&(ve.wssMessageDispatcher.nativeDispatcher.updateAntitrackerToWPS(e),ve.localStore.set(m.name,e))}catch(e){Q.log(`[AntitrackerData] Error sending AT updates to WPS: ${e.message}`)}}getDomainHistory(e={}){let t="";const a=Object.keys(e);if(0===a.length)return t;a.sort(((t,a)=>e[a]-e[t]));for(let s=0;s<a.length&&s<5&&a[s];s++){const n=a[s];t+=`${n},${e[n]},`}return t.slice(0,-1)}isSameAsLastScan(e){const t=ve.localStore.get(m.name,{}),a=Object.keys(e);if(a.length!==Object.keys(t).length)return!1;for(const s of a)if(e[s]!==t[s])return!1;return!0}},isAntitrackerExtInstalled:!1,sendDataToWpsFlag:!1,analyticsContentVersion:"1.0.1",htiReportHandler:null,mockingBirdHandler:null},ke=(c.name,w.name,c.name,d.name,"ADD"),xe="REMOVE",Ee={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class Se{static getResString(e,t){Ee.ANNOTATION.resourceRequestor.getResStr(e,(a=>{a?t(a):Ee.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class _e{static async toHTICategoriesString(e,t=!1){const a=e=>new Promise((t=>{Se.getResString(e,(e=>t(e)))})),s=async(e,t)=>{const s={},n=await a(`category_id_${e}_name`);if(s.name=n,t){const t=await a(`category_id_${e}_description`);s.description=t}return s},n=[];for(const a of e)n.push(s(a,t));return await Promise.all(n)}static browserTypeToString(e=!1){let t="";switch(I){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;case 4:t="SF";break;default:t="UN"}return e?t.toLowerCase():t}static toAnnotationImageClass(e){let t="";switch(_e.toColor(e)){case L:t="green";break;case j:t="red";break;case C:t="yellow";break;case U:t="grey"}return t}static isPhishingURI(e){return e&&e.includes(ie)}static toBlockState(e){const t=_e.toColor(e);return t===C&&_e.isPhishingURI(e.category)?E.PHISHING:isNaN(t)?E.GREY:t}static toColor(e){let t=D;return e&&void 0!==e.trust?(t=e.trust>=P?L:e.trust>=z?U:e.trust>=q?C:e.trust>=B?j:D,t):t}static toSiteReportUrl(e){return`${x.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){return e.startsWith(F)}static isAnyExtensionUrl(e){return e.startsWith(`${F.split("://")[0]}://`)}static isSafeUrl(e){return _e.isSiteAdvisorUrl(e)||_e.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${re}`)||e.startsWith(`https://${re}`)}static isPropertRedirectUrl(e){return _e.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e=""){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static async blockRequest(e,t,a){const s=await x.declarativeNetRequest.getDynamicRules();0===s.filter((e=>e.condition.urlFilter===t)).length&&_e.addDynamicRule(e,t,a,s.length+1,0)}static async addDynamicRule(e,t,a,s,n){if(n>=10)Q.error(`Unable to add dynamic rule for tabId:${e}, on url: ${t}. message: ${a}`);else try{await x.declarativeNetRequest.updateDynamicRules({addRules:[{id:s,condition:{urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]}),Q.log(`${a} ${t} ${e}`)}catch(o){_e.addDynamicRule(e,t,a,s+1,n+1)}}static async updateExcludedTabInSession(e,t){try{const a=999999,s=(await x.declarativeNetRequest.getSessionRules()).find((e=>e.id===a));let n=s?.condition?.tabIds||[],o=!1;const i=n.indexOf(e);t===ke&&-1===i?(n.push(e),o=!0):t===xe&&-1!==i&&(n=n.filter((t=>t!==e)),o=!0),o&&x.declarativeNetRequest.updateSessionRules({removeRuleIds:[a],addRules:[{id:a,condition:{tabIds:n},action:{type:"allow"}}]})}catch(e){Q.error(e.message)}}static updateHTIGlobalsAfterNativeConnection(){const e=ve.nativeSettings.MTI_CLIENT_ID.value,t=ve.nativeSettings.CSP_ID_SETTING.value,a=ve.nativeSettings.JWT_TOKEN_ENABLED.value;""!==e&&ve.mtiRequestor.setGlobals({clientIdGuid:e}),"__not_available__"!==t&&ve.mtiRequestor.setGlobals({cspid:t}),"boolean"==typeof a&&ve.mtiRequestor.setGlobals({jwtEnabled:a})}static newGuid(){const e=new Uint8Array(24);let t=Date.now().toString()+Math.random().toString().substring(2);for(let a=0;a<24;++a)t+=e[a].toString();let a="{";for(let e=0;e<36;++e)if(8===e||13===e||18===e||23===e)a+="-";else{a+=t[Math.floor(Math.random()*t.length)]}return a+="}",a}}const Te={aaa:"aaa",aarp:"aarp",abarth:"abarth",abb:"abb",abbott:"abbott",abbvie:"abbvie",abc:"abc",able:"able",abogado:"abogado",abudhabi:"abudhabi",ac:"ac",academy:"academy",accenture:"accenture",accountant:"accountant",accountants:"accountants",aco:"aco",active:"active",actor:"actor",ad:"ad",adac:"adac",ads:"ads",adult:"adult",ae:"ae",aeg:"aeg",aero:"aero",aetna:"aetna",af:"af",afamilycompany:"afamilycompany",afl:"afl",africa:"africa",ag:"ag",agakhan:"agakhan",agency:"agency",ai:"ai",aig:"aig",aigo:"aigo",airbus:"airbus",airforce:"airforce",airtel:"airtel",akdn:"akdn",al:"al",alfaromeo:"alfaromeo",alibaba:"alibaba",alipay:"alipay",allfinanz:"allfinanz",allstate:"allstate",ally:"ally",alsace:"alsace",alstom:"alstom",am:"am",americanexpress:"americanexpress",americanfamily:"americanfamily",amex:"amex",amfam:"amfam",amica:"amica",amsterdam:"amsterdam",analytics:"analytics",android:"android",anquan:"anquan",anz:"anz",ao:"ao",aol:"aol",apartments:"apartments",app:"app",apple:"apple",aq:"aq",aquarelle:"aquarelle",ar:"ar",arab:"arab",aramco:"aramco",archi:"archi",army:"army",arpa:"arpa",art:"art",arte:"arte",as:"as",asda:"asda",asia:"asia",associates:"associates",at:"at",athleta:"athleta",attorney:"attorney",au:"au",auction:"auction",audi:"audi",audible:"audible",audio:"audio",auspost:"auspost",author:"author",auto:"auto",autos:"autos",avianca:"avianca",aw:"aw",aws:"aws",ax:"ax",axa:"axa",az:"az",azure:"azure",ba:"ba",baby:"baby",baidu:"baidu",banamex:"banamex",bananarepublic:"bananarepublic",band:"band",bank:"bank",bar:"bar",barcelona:"barcelona",barclaycard:"barclaycard",barclays:"barclays",barefoot:"barefoot",bargains:"bargains",baseball:"baseball",basketball:"basketball",bauhaus:"bauhaus",bayern:"bayern",bb:"bb",bbc:"bbc",bbt:"bbt",bbva:"bbva",bcg:"bcg",bcn:"bcn",bd:"bd",be:"be",beats:"beats",beauty:"beauty",beer:"beer",bentley:"bentley",berlin:"berlin",best:"best",bestbuy:"bestbuy",bet:"bet",bf:"bf",bg:"bg",bh:"bh",bharti:"bharti",bi:"bi",bible:"bible",bid:"bid",bike:"bike",bing:"bing",bingo:"bingo",bio:"bio",biz:"biz",bj:"bj",black:"black",blackfriday:"blackfriday",blanco:"blanco",blockbuster:"blockbuster",blog:"blog",bloomberg:"bloomberg",blue:"blue",bm:"bm",bms:"bms",bmw:"bmw",bn:"bn",bnl:"bnl",bnpparibas:"bnpparibas",bo:"bo",boats:"boats",boehringer:"boehringer",bofa:"bofa",bom:"bom",bond:"bond",boo:"boo",book:"book",booking:"booking",bosch:"bosch",bostik:"bostik",boston:"boston",bot:"bot",boutique:"boutique",box:"box",br:"br",bradesco:"bradesco",bridgestone:"bridgestone",broadway:"broadway",broker:"broker",brother:"brother",brussels:"brussels",bs:"bs",bt:"bt",budapest:"budapest",bugatti:"bugatti",build:"build",builders:"builders",business:"business",buy:"buy",buzz:"buzz",bv:"bv",bw:"bw",by:"by",bz:"bz",bzh:"bzh",ca:"ca",cab:"cab",cafe:"cafe",cal:"cal",call:"call",calvinklein:"calvinklein",cam:"cam",camera:"camera",camp:"camp",cancerresearch:"cancerresearch",canon:"canon",capetown:"capetown",capital:"capital",capitalone:"capitalone",car:"car",caravan:"caravan",cards:"cards",care:"care",career:"career",careers:"careers",cars:"cars",cartier:"cartier",casa:"casa",case:"case",caseih:"caseih",cash:"cash",casino:"casino",cat:"cat",catering:"catering",catholic:"catholic",cba:"cba",cbn:"cbn",cbre:"cbre",cbs:"cbs",cc:"cc",cd:"cd",ceb:"ceb",center:"center",ceo:"ceo",cern:"cern",cf:"cf",cfa:"cfa",cfd:"cfd",cg:"cg",ch:"ch",chanel:"chanel",channel:"channel",chase:"chase",chat:"chat",cheap:"cheap",chintai:"chintai",christmas:"christmas",chrome:"chrome",chrysler:"chrysler",church:"church",ci:"ci",cipriani:"cipriani",circle:"circle",cisco:"cisco",citadel:"citadel",citi:"citi",citic:"citic",city:"city",cityeats:"cityeats",ck:"ck",cl:"cl",claims:"claims",cleaning:"cleaning",click:"click",clinic:"clinic",clinique:"clinique",clothing:"clothing",cloud:"cloud",club:"club",clubmed:"clubmed",cm:"cm",cn:"cn",co:"co",coach:"coach",codes:"codes",coffee:"coffee",college:"college",cologne:"cologne",com:"com",comcast:"comcast",commbank:"commbank",community:"community",company:"company",compare:"compare",computer:"computer",comsec:"comsec",condos:"condos",construction:"construction",consulting:"consulting",contact:"contact",contractors:"contractors",cooking:"cooking",cookingchannel:"cookingchannel",cool:"cool",coop:"coop",corsica:"corsica",country:"country",coupon:"coupon",coupons:"coupons",courses:"courses",cr:"cr",credit:"credit",creditcard:"creditcard",creditunion:"creditunion",cricket:"cricket",crown:"crown",crs:"crs",cruise:"cruise",cruises:"cruises",csc:"csc",cu:"cu",cuisinella:"cuisinella",cv:"cv",cw:"cw",cx:"cx",cy:"cy",cymru:"cymru",cyou:"cyou",cz:"cz",dabur:"dabur",dad:"dad",dance:"dance",data:"data",date:"date",dating:"dating",datsun:"datsun",day:"day",dclk:"dclk",dds:"dds",de:"de",deal:"deal",dealer:"dealer",deals:"deals",degree:"degree",delivery:"delivery",dell:"dell",deloitte:"deloitte",delta:"delta",democrat:"democrat",dental:"dental",dentist:"dentist",desi:"desi",design:"design",dev:"dev",dhl:"dhl",diamonds:"diamonds",diet:"diet",digital:"digital",direct:"direct",directory:"directory",discount:"discount",discover:"discover",dish:"dish",diy:"diy",dj:"dj",dk:"dk",dm:"dm",dnp:"dnp",do:"do",docs:"docs",doctor:"doctor",dodge:"dodge",dog:"dog",doha:"doha",domains:"domains",dot:"dot",download:"download",drive:"drive",dtv:"dtv",dubai:"dubai",duck:"duck",dunlop:"dunlop",duns:"duns",dupont:"dupont",durban:"durban",dvag:"dvag",dvr:"dvr",dz:"dz",earth:"earth",eat:"eat",ec:"ec",eco:"eco",edeka:"edeka",edu:"edu",education:"education",ee:"ee",eg:"eg",email:"email",emerck:"emerck",energy:"energy",engineer:"engineer",engineering:"engineering",enterprises:"enterprises",epost:"epost",epson:"epson",equipment:"equipment",er:"er",ericsson:"ericsson",erni:"erni",es:"es",esq:"esq",estate:"estate",esurance:"esurance",et:"et",etisalat:"etisalat",eu:"eu",eurovision:"eurovision",eus:"eus",events:"events",everbank:"everbank",exchange:"exchange",expert:"expert",exposed:"exposed",express:"express",extraspace:"extraspace",fage:"fage",fail:"fail",fairwinds:"fairwinds",faith:"faith",family:"family",fan:"fan",fans:"fans",farm:"farm",farmers:"farmers",fashion:"fashion",fast:"fast",fedex:"fedex",feedback:"feedback",ferrari:"ferrari",ferrero:"ferrero",fi:"fi",fiat:"fiat",fidelity:"fidelity",fido:"fido",film:"film",final:"final",finance:"finance",financial:"financial",fire:"fire",firestone:"firestone",firmdale:"firmdale",fish:"fish",fishing:"fishing",fit:"fit",fitness:"fitness",fj:"fj",fk:"fk",flickr:"flickr",flights:"flights",flir:"flir",florist:"florist",flowers:"flowers",fly:"fly",fm:"fm",fo:"fo",foo:"foo",food:"food",foodnetwork:"foodnetwork",football:"football",ford:"ford",forex:"forex",forsale:"forsale",forum:"forum",foundation:"foundation",fox:"fox",fr:"fr",free:"free",fresenius:"fresenius",frl:"frl",frogans:"frogans",frontdoor:"frontdoor",frontier:"frontier",ftr:"ftr",fujitsu:"fujitsu",fujixerox:"fujixerox",fun:"fun",fund:"fund",furniture:"furniture",futbol:"futbol",fyi:"fyi",ga:"ga",gal:"gal",gallery:"gallery",gallo:"gallo",gallup:"gallup",game:"game",games:"games",gap:"gap",garden:"garden",gb:"gb",gbiz:"gbiz",gd:"gd",gdn:"gdn",ge:"ge",gea:"gea",gent:"gent",genting:"genting",george:"george",gf:"gf",gg:"gg",ggee:"ggee",gh:"gh",gi:"gi",gift:"gift",gifts:"gifts",gives:"gives",giving:"giving",gl:"gl",glade:"glade",glass:"glass",gle:"gle",global:"global",globo:"globo",gm:"gm",gmail:"gmail",gmbh:"gmbh",gmo:"gmo",gmx:"gmx",gn:"gn",godaddy:"godaddy",gold:"gold",goldpoint:"goldpoint",golf:"golf",goo:"goo",goodhands:"goodhands",goodyear:"goodyear",goog:"goog",google:"google",gop:"gop",got:"got",gov:"gov",gp:"gp",gq:"gq",gr:"gr",grainger:"grainger",graphics:"graphics",gratis:"gratis",green:"green",gripe:"gripe",grocery:"grocery",group:"group",gs:"gs",gt:"gt",gu:"gu",guardian:"guardian",gucci:"gucci",guge:"guge",guide:"guide",guitars:"guitars",guru:"guru",gw:"gw",gy:"gy",hair:"hair",hamburg:"hamburg",hangout:"hangout",haus:"haus",hbo:"hbo",hdfc:"hdfc",hdfcbank:"hdfcbank",health:"health",healthcare:"healthcare",help:"help",helsinki:"helsinki",here:"here",hermes:"hermes",hgtv:"hgtv",hiphop:"hiphop",hisamitsu:"hisamitsu",hitachi:"hitachi",hiv:"hiv",hk:"hk",hkt:"hkt",hm:"hm",hn:"hn",hockey:"hockey",holdings:"holdings",holiday:"holiday",homedepot:"homedepot",homegoods:"homegoods",homes:"homes",homesense:"homesense",honda:"honda",honeywell:"honeywell",horse:"horse",hospital:"hospital",host:"host",hosting:"hosting",hot:"hot",hoteles:"hoteles",hotels:"hotels",hotmail:"hotmail",house:"house",how:"how",hr:"hr",hsbc:"hsbc",ht:"ht",hu:"hu",hughes:"hughes",hyatt:"hyatt",hyundai:"hyundai",ibm:"ibm",icbc:"icbc",ice:"ice",icu:"icu",id:"id",ie:"ie",ieee:"ieee",ifm:"ifm",ikano:"ikano",il:"il",im:"im",imamat:"imamat",imdb:"imdb",immo:"immo",immobilien:"immobilien",in:"in",industries:"industries",infiniti:"infiniti",info:"info",ing:"ing",ink:"ink",institute:"institute",insurance:"insurance",insure:"insure",int:"int",intel:"intel",international:"international",intuit:"intuit",investments:"investments",io:"io",ipiranga:"ipiranga",iq:"iq",ir:"ir",irish:"irish",is:"is",iselect:"iselect",ismaili:"ismaili",ist:"ist",istanbul:"istanbul",it:"it",itau:"itau",itv:"itv",iveco:"iveco",iwc:"iwc",jaguar:"jaguar",java:"java",jcb:"jcb",jcp:"jcp",je:"je",jeep:"jeep",jetzt:"jetzt",jewelry:"jewelry",jio:"jio",jlc:"jlc",jll:"jll",jm:"jm",jmp:"jmp",jnj:"jnj",jo:"jo",jobs:"jobs",joburg:"joburg",jot:"jot",joy:"joy",jp:"jp",jpmorgan:"jpmorgan",jprs:"jprs",juegos:"juegos",juniper:"juniper",kaufen:"kaufen",kddi:"kddi",ke:"ke",kerryhotels:"kerryhotels",kerrylogistics:"kerrylogistics",kerryproperties:"kerryproperties",kfh:"kfh",kg:"kg",kh:"kh",ki:"ki",kia:"kia",kim:"kim",kinder:"kinder",kindle:"kindle",kitchen:"kitchen",kiwi:"kiwi",km:"km",kn:"kn",koeln:"koeln",komatsu:"komatsu",kosher:"kosher",kp:"kp",kpmg:"kpmg",kpn:"kpn",kr:"kr",krd:"krd",kred:"kred",kuokgroup:"kuokgroup",kw:"kw",ky:"ky",kyoto:"kyoto",kz:"kz",la:"la",lacaixa:"lacaixa",ladbrokes:"ladbrokes",lamborghini:"lamborghini",lamer:"lamer",lancaster:"lancaster",lancia:"lancia",lancome:"lancome",land:"land",landrover:"landrover",lanxess:"lanxess",lasalle:"lasalle",lat:"lat",latino:"latino",latrobe:"latrobe",law:"law",lawyer:"lawyer",lb:"lb",lc:"lc",lds:"lds",lease:"lease",leclerc:"leclerc",lefrak:"lefrak",legal:"legal",lego:"lego",lexus:"lexus",lgbt:"lgbt",li:"li",liaison:"liaison",lidl:"lidl",life:"life",lifeinsurance:"lifeinsurance",lifestyle:"lifestyle",lighting:"lighting",like:"like",lilly:"lilly",limited:"limited",limo:"limo",lincoln:"lincoln",linde:"linde",link:"link",lipsy:"lipsy",live:"live",living:"living",lixil:"lixil",lk:"lk",llc:"llc",loan:"loan",loans:"loans",locker:"locker",locus:"locus",loft:"loft",lol:"lol",london:"london",lotte:"lotte",lotto:"lotto",love:"love",lpl:"lpl",lplfinancial:"lplfinancial",lr:"lr",ls:"ls",lt:"lt",ltd:"ltd",ltda:"ltda",lu:"lu",lundbeck:"lundbeck",lupin:"lupin",luxe:"luxe",luxury:"luxury",lv:"lv",ly:"ly",ma:"ma",macys:"macys",madrid:"madrid",maif:"maif",maison:"maison",makeup:"makeup",man:"man",management:"management",mango:"mango",map:"map",market:"market",marketing:"marketing",markets:"markets",marriott:"marriott",marshalls:"marshalls",maserati:"maserati",mattel:"mattel",mba:"mba",mc:"mc",mckinsey:"mckinsey",md:"md",me:"me",med:"med",media:"media",meet:"meet",melbourne:"melbourne",meme:"meme",memorial:"memorial",men:"men",menu:"menu",meo:"meo",merckmsd:"merckmsd",metlife:"metlife",mg:"mg",mh:"mh",miami:"miami",microsoft:"microsoft",mil:"mil",mini:"mini",mint:"mint",mit:"mit",mitsubishi:"mitsubishi",mk:"mk",ml:"ml",mlb:"mlb",mls:"mls",mm:"mm",mma:"mma",mn:"mn",mo:"mo",mobi:"mobi",mobile:"mobile",mobily:"mobily",moda:"moda",moe:"moe",moi:"moi",mom:"mom",monash:"monash",money:"money",monster:"monster",mopar:"mopar",mormon:"mormon",mortgage:"mortgage",moscow:"moscow",moto:"moto",motorcycles:"motorcycles",mov:"mov",movie:"movie",movistar:"movistar",mp:"mp",mq:"mq",mr:"mr",ms:"ms",msd:"msd",mt:"mt",mtn:"mtn",mtr:"mtr",mu:"mu",museum:"museum",mutual:"mutual",mv:"mv",mw:"mw",mx:"mx",my:"my",mz:"mz",na:"na",nab:"nab",nadex:"nadex",nagoya:"nagoya",name:"name",nationwide:"nationwide",natura:"natura",navy:"navy",nba:"nba",nc:"nc",ne:"ne",nec:"nec",net:"net",netbank:"netbank",netflix:"netflix",network:"network",neustar:"neustar",new:"new",newholland:"newholland",news:"news",next:"next",nextdirect:"nextdirect",nexus:"nexus",nf:"nf",nfl:"nfl",ng:"ng",ngo:"ngo",nhk:"nhk",ni:"ni",nico:"nico",nike:"nike",nikon:"nikon",ninja:"ninja",nissan:"nissan",nissay:"nissay",nl:"nl",no:"no",nokia:"nokia",northwesternmutual:"northwesternmutual",norton:"norton",now:"now",nowruz:"nowruz",nowtv:"nowtv",np:"np",nr:"nr",nra:"nra",nrw:"nrw",ntt:"ntt",nu:"nu",nyc:"nyc",nz:"nz",obi:"obi",observer:"observer",off:"off",office:"office",okinawa:"okinawa",olayan:"olayan",olayangroup:"olayangroup",oldnavy:"oldnavy",ollo:"ollo",om:"om",omega:"omega",one:"one",ong:"ong",onl:"onl",online:"online",onyourside:"onyourside",ooo:"ooo",open:"open",oracle:"oracle",orange:"orange",org:"org",organic:"organic",origins:"origins",osaka:"osaka",otsuka:"otsuka",ott:"ott",ovh:"ovh",pa:"pa",page:"page",panasonic:"panasonic",panerai:"panerai",paris:"paris",pars:"pars",partners:"partners",parts:"parts",party:"party",passagens:"passagens",pay:"pay",pccw:"pccw",pe:"pe",pet:"pet",pf:"pf",pfizer:"pfizer",pg:"pg",ph:"ph",pharmacy:"pharmacy",phd:"phd",philips:"philips",phone:"phone",photo:"photo",photography:"photography",photos:"photos",physio:"physio",piaget:"piaget",pics:"pics",pictet:"pictet",pictures:"pictures",pid:"pid",pin:"pin",ping:"ping",pink:"pink",pioneer:"pioneer",pizza:"pizza",pk:"pk",pl:"pl",place:"place",play:"play",playstation:"playstation",plumbing:"plumbing",plus:"plus",pm:"pm",pn:"pn",pnc:"pnc",pohl:"pohl",poker:"poker",politie:"politie",porn:"porn",post:"post",pr:"pr",pramerica:"pramerica",praxi:"praxi",press:"press",prime:"prime",pro:"pro",prod:"prod",productions:"productions",prof:"prof",progressive:"progressive",promo:"promo",properties:"properties",property:"property",protection:"protection",pru:"pru",prudential:"prudential",ps:"ps",pt:"pt",pub:"pub",pw:"pw",pwc:"pwc",py:"py",qa:"qa",qpon:"qpon",quebec:"quebec",quest:"quest",qvc:"qvc",racing:"racing",radio:"radio",raid:"raid",re:"re",read:"read",realestate:"realestate",realtor:"realtor",realty:"realty",recipes:"recipes",red:"red",redstone:"redstone",redumbrella:"redumbrella",rehab:"rehab",reise:"reise",reisen:"reisen",reit:"reit",reliance:"reliance",ren:"ren",rent:"rent",rentals:"rentals",repair:"repair",report:"report",republican:"republican",rest:"rest",restaurant:"restaurant",review:"review",reviews:"reviews",rexroth:"rexroth",rich:"rich",richardli:"richardli",ricoh:"ricoh",rightathome:"rightathome",ril:"ril",rio:"rio",rip:"rip",rmit:"rmit",ro:"ro",rocher:"rocher",rocks:"rocks",rodeo:"rodeo",rogers:"rogers",room:"room",rs:"rs",rsvp:"rsvp",ru:"ru",rugby:"rugby",ruhr:"ruhr",run:"run",rw:"rw",rwe:"rwe",ryukyu:"ryukyu",sa:"sa",saarland:"saarland",safe:"safe",safety:"safety",sakura:"sakura",sale:"sale",salon:"salon",samsclub:"samsclub",samsung:"samsung",sandvik:"sandvik",sandvikcoromant:"sandvikcoromant",sanofi:"sanofi",sap:"sap",sapo:"sapo",sarl:"sarl",sas:"sas",save:"save",saxo:"saxo",sb:"sb",sbi:"sbi",sbs:"sbs",sc:"sc",sca:"sca",scb:"scb",schaeffler:"schaeffler",schmidt:"schmidt",scholarships:"scholarships",school:"school",schule:"schule",schwarz:"schwarz",science:"science",scjohnson:"scjohnson",scor:"scor",scot:"scot",sd:"sd",se:"se",search:"search",seat:"seat",secure:"secure",security:"security",seek:"seek",select:"select",sener:"sener",services:"services",ses:"ses",seven:"seven",sew:"sew",sex:"sex",sexy:"sexy",sfr:"sfr",sg:"sg",sh:"sh",shangrila:"shangrila",sharp:"sharp",shaw:"shaw",shell:"shell",shia:"shia",shiksha:"shiksha",shoes:"shoes",shop:"shop",shopping:"shopping",shouji:"shouji",show:"show",showtime:"showtime",shriram:"shriram",si:"si",silk:"silk",sina:"sina",singles:"singles",site:"site",sj:"sj",sk:"sk",ski:"ski",skin:"skin",sky:"sky",skype:"skype",sl:"sl",sling:"sling",sm:"sm",smart:"smart",smile:"smile",sn:"sn",sncf:"sncf",so:"so",soccer:"soccer",social:"social",softbank:"softbank",software:"software",sohu:"sohu",solar:"solar",solutions:"solutions",song:"song",sony:"sony",soy:"soy",space:"space",spiegel:"spiegel",sport:"sport",spot:"spot",spreadbetting:"spreadbetting",sr:"sr",srl:"srl",srt:"srt",st:"st",stada:"stada",staples:"staples",star:"star",starhub:"starhub",statebank:"statebank",statefarm:"statefarm",statoil:"statoil",stc:"stc",stcgroup:"stcgroup",stockholm:"stockholm",storage:"storage",store:"store",stream:"stream",studio:"studio",study:"study",style:"style",su:"su",sucks:"sucks",supplies:"supplies",supply:"supply",support:"support",surf:"surf",surgery:"surgery",suzuki:"suzuki",sv:"sv",swatch:"swatch",swiftcover:"swiftcover",swiss:"swiss",sx:"sx",sy:"sy",sydney:"sydney",symantec:"symantec",systems:"systems",sz:"sz",tab:"tab",taipei:"taipei",talk:"talk",taobao:"taobao",target:"target",tatamotors:"tatamotors",tatar:"tatar",tattoo:"tattoo",tax:"tax",taxi:"taxi",tc:"tc",tci:"tci",td:"td",tdk:"tdk",team:"team",tech:"tech",technology:"technology",tel:"tel",telecity:"telecity",telefonica:"telefonica",temasek:"temasek",tennis:"tennis",teva:"teva",tf:"tf",tg:"tg",th:"th",thd:"thd",theater:"theater",theatre:"theatre",tiaa:"tiaa",tickets:"tickets",tienda:"tienda",tiffany:"tiffany",tips:"tips",tires:"tires",tirol:"tirol",tj:"tj",tjmaxx:"tjmaxx",tjx:"tjx",tk:"tk",tkmaxx:"tkmaxx",tl:"tl",tm:"tm",tmall:"tmall",tn:"tn",to:"to",today:"today",tokyo:"tokyo",tools:"tools",top:"top",toray:"toray",toshiba:"toshiba",total:"total",tours:"tours",town:"town",toyota:"toyota",toys:"toys",tr:"tr",trade:"trade",trading:"trading",training:"training",travel:"travel",travelchannel:"travelchannel",travelers:"travelers",travelersinsurance:"travelersinsurance",trust:"trust",trv:"trv",tt:"tt",tube:"tube",tui:"tui",tunes:"tunes",tushu:"tushu",tv:"tv",tvs:"tvs",tw:"tw",tz:"tz",ua:"ua",ubank:"ubank",ubs:"ubs",uconnect:"uconnect",ug:"ug",uk:"uk",unicom:"unicom",university:"university",uno:"uno",uol:"uol",ups:"ups",us:"us",uy:"uy",uz:"uz",va:"va",vacations:"vacations",vana:"vana",vanguard:"vanguard",vc:"vc",ve:"ve",vegas:"vegas",ventures:"ventures",verisign:"verisign",versicherung:"versicherung",vet:"vet",vg:"vg",vi:"vi",viajes:"viajes",video:"video",vig:"vig",viking:"viking",villas:"villas",vin:"vin",vip:"vip",virgin:"virgin",visa:"visa",vision:"vision",vista:"vista",vistaprint:"vistaprint",viva:"viva",vivo:"vivo",vlaanderen:"vlaanderen",vn:"vn",vodka:"vodka",volkswagen:"volkswagen",volvo:"volvo",vote:"vote",voting:"voting",voto:"voto",voyage:"voyage",vu:"vu",vuelos:"vuelos",wales:"wales",walmart:"walmart",walter:"walter",wang:"wang",wanggou:"wanggou",warman:"warman",watch:"watch",watches:"watches",weather:"weather",weatherchannel:"weatherchannel",webcam:"webcam",weber:"weber",website:"website",wed:"wed",wedding:"wedding",weibo:"weibo",weir:"weir",wf:"wf",whoswho:"whoswho",wien:"wien",wiki:"wiki",williamhill:"williamhill",win:"win",windows:"windows",wine:"wine",winners:"winners",wme:"wme",wolterskluwer:"wolterskluwer",woodside:"woodside",work:"work",works:"works",world:"world",wow:"wow",ws:"ws",wtc:"wtc",wtf:"wtf",xbox:"xbox",xerox:"xerox",xfinity:"xfinity",xihuan:"xihuan",xin:"xin","xn--11b4c3d":"कॉम","xn--1ck2e1b":"セール","xn--1qqw23a":"佛山","xn--2scrj9c":"ಭಾರತ","xn--30rr7y":"慈善","xn--3bst00m":"集团","xn--3ds443g":"在线","xn--3e0b707e":"한국","xn--3hcrj9c":"ଭାରତ","xn--3oq18vl8pn36a":"大众汽车","xn--3pxu8k":"点看","xn--42c2d9a":"คอม","xn--45br5cyl":"ভাৰত","xn--45brj9c":"ভারত","xn--45q11c":"八卦","xn--4gbrim":"موقع","xn--54b7fta0cc":"বাংলা","xn--55qw42g":"公益","xn--55qx5d":"公司","xn--5su34j936bgsg":"香格里拉","xn--5tzm5g":"网站","xn--6frz82g":"移动","xn--6qq986b3xl":"我爱你","xn--80adxhks":"москва","xn--80ao21a":"қаз","xn--80aqecdr1a":"католик","xn--80asehdb":"онлайн","xn--80aswg":"сайт","xn--8y0a063a":"联通","xn--90a3ac":"срб","xn--90ae":"бг","xn--90ais":"бел","xn--9dbq2a":"קום","xn--9et52u":"时尚","xn--9krt00a":"微博","xn--b4w605ferd":"淡马锡","xn--bck1b9a5dre4c":"ファッション","xn--c1avg":"орг","xn--c2br7g":"नेट","xn--cck2b3b":"ストア","xn--cg4bki":"삼성","xn--clchc0ea0b2g2a9gcd":"சிங்கப்பூர்","xn--czr694b":"商标","xn--czrs0t":"商店","xn--czru2d":"商城","xn--d1acj3b":"дети","xn--d1alf":"мкд","xn--e1a4c":"ею","xn--eckvdtc9d":"ポイント","xn--efvy88h":"新闻","xn--estv75g":"工行","xn--fct429k":"家電","xn--fhbei":"كوم","xn--fiq228c5hs":"中文网","xn--fiq64b":"中信","xn--fiqs8s":"中国","xn--fiqz9s":"中國","xn--fjq720a":"娱乐","xn--flw351e":"谷歌","xn--fpcrj9c3d":"భారత్","xn--fzc2c9e2c":"ලංකා","xn--fzys8d69uvgm":"電訊盈科","xn--g2xx48c":"购物","xn--gckr3f0f":"クラウド","xn--gecrj9c":"ભારત","xn--gk3at1e":"通販","xn--h2breg3eve":"भारतम्","xn--h2brj9c":"भारत","xn--h2brj9c8c":"भारोत","xn--hxt814e":"网店","xn--i1b6b1a6a2e":"संगठन","xn--imr513n":"餐厅","xn--io0a7i":"网络","xn--j1aef":"ком","xn--j1amh":"укр","xn--j6w193g":"香港","xn--jlq61u9w7b":"诺基亚","xn--jvr189m":"食品","xn--kcrx77d1x4a":"飞利浦","xn--kprw13d":"台湾","xn--kpry57d":"台灣","xn--kpu716f":"手表","xn--kput3i":"手机","xn--l1acc":"мон","xn--lgbbat1ad8j":"الجزائر","xn--mgb9awbf":"عمان","xn--mgba3a3ejt":"ارامكو","xn--mgba3a4f16a":"ایران","xn--mgba7c0bbn0a":"العليان","xn--mgbaakc7dvf":"اتصالات","xn--mgbaam7a8h":"امارات","xn--mgbab2bd":"بازار","xn--mgbai9azgqp6j":"پاکستان","xn--mgbayh7gpa":"الاردن","xn--mgbb9fbpob":"موبايلي","xn--mgbbh1a":"بارت","xn--mgbbh1a71e":"بھارت","xn--mgbc0a9azcg":"المغرب","xn--mgbca7dzdo":"ابوظبي","xn--mgberp4a5d4ar":"السعودية","xn--mgbgu82a":"ڀارت","xn--mgbi4ecexp":"كاثوليك","xn--mgbpl2fh":"سودان","xn--mgbt3dhd":"همراه","xn--mgbtx2b":"عراق","xn--mgbx4cd0ab":"مليسيا","xn--mix891f":"澳門","xn--mk1bu44c":"닷컴","xn--mxtq1m":"政府","xn--ngbc5azd":"شبكة","xn--ngbe9e0a":"بيتك","xn--ngbrx":"عرب","xn--node":"გე","xn--nqv7f":"机构","xn--nqv7fs00ema":"组织机构","xn--nyqy26a":"健康","xn--o3cw4h":"ไทย","xn--ogbpf8fl":"سورية","xn--otu796d":"招聘","xn--p1acf":"рус","xn--p1ai":"рф","xn--pbt977c":"珠宝","xn--pgbs0dh":"تونس","xn--pssy2u":"大拿","xn--q9jyb4c":"みんな","xn--qcka1pmc":"グーグル","xn--qxam":"ελ","xn--rhqv96g":"世界","xn--rovu88b":"書籍","xn--rvc1e0am3e":"ഭാരതം","xn--s9brj9c":"ਭਾਰਤ","xn--ses554g":"网址","xn--t60b56a":"닷넷","xn--tckwe":"コム","xn--tiq49xqyj":"天主教","xn--unup4y":"游戏","xn--vermgensberater-ctb":"vermögensberater","xn--vermgensberatung-pwb":"vermögensberatung","xn--vhquv":"企业","xn--vuq861b":"信息","xn--w4r85el8fhu5dnra":"嘉里大酒店","xn--w4rs40l":"嘉里","xn--wgbh1c":"مصر","xn--wgbl6a":"قطر","xn--xhq521b":"广东","xn--xkc2al3hye2a":"இலங்கை","xn--xkc2dl3a5ee0h":"இந்தியா","xn--y9a3aq":"հայ","xn--yfro4i67o":"新加坡","xn--ygbi2ammx":"فلسطين","xn--zfr164b":"政务",xperia:"xperia",xxx:"xxx",xyz:"xyz",yachts:"yachts",yahoo:"yahoo",yamaxun:"yamaxun",yandex:"yandex",ye:"ye",yodobashi:"yodobashi",yoga:"yoga",yokohama:"yokohama",you:"you",youtube:"youtube",yt:"yt",yun:"yun",za:"za",zappos:"zappos",zara:"zara",zero:"zero",zip:"zip",zippo:"zippo",zm:"zm",zone:"zone",zuerich:"zuerich",zw:"zw"};const Ae=class{static getElementFingerprint(e){return[e.getAttribute("id")||"",e.getAttribute("class")||"",e.getAttribute("type")||"",e.getAttribute("name")||"",e.getAttribute("aria-label")||"",e.getAttribute("title")||"",e.getAttribute("placeholder")||""]}static isDisplayed(e){if(this.isElement(e)&&"none"===window.getComputedStyle(e).display)return!1;const t=e.parentNode;return!(!t||9!==t.nodeType&&11!==t.nodeType)||t&&this.isDisplayed(t)}static isElementType(e,t){return e&&e.tagName.toLowerCase()===t.toLowerCase()}static isElement(e){return"object"==typeof e&&1===e.nodeType}static isPositiveSize(e){const t=e.getBoundingClientRect();if(t.height>0&&t.width>0)return!0;if(this.isElementType(e,"PATH")&&(t.height>0||t.width>0)){const{strokeWidth:t}=window.getComputedStyle(e);return t&&parseInt(t,10)>0}const{overflow:a}=window.getComputedStyle(e);if(!a.includes("hidden")){const{childNodes:t}=e;for(let e=0;e<t.length;e+=1){const a=t[e];if(3===a.nodeType||this.isElement(a)&&this.isPositiveSize(a))return!0}}return!1}static canBeOverflowed(e,t,a){if(a===e)return!0;const{display:s}=window.getComputedStyle(a);return!s.startsWith("inline")&&"contents"!==s&&("absolute"!==t||"static"!==window.getComputedStyle(a).position)}static getOverflowParent(e,t){const{documentElement:a}=e,{position:s}=window.getComputedStyle(t);if("fixed"===s)return a;let n=t.parentElement;for(;n&&!this.canBeOverflowed(a,s,n);)n=n.parentElement;return n}static getOverflowStyles(e,t){const{documentElement:a}=e,{body:s}=a;let n=t;if("visible"===window.getComputedStyle(a).overflow)if(t===a&&s)n=s;else if(t===s)return{x:"visible",y:"visible"};const{overflowX:o,overflowY:i}=window.getComputedStyle(n),r={x:o,y:i};return t===a&&(r.x="visible"===r.x?"auto":r.x,r.y="visible"===r.y?"auto":r.y),r}static getScroll(e){return{x:e.scrollLeft,y:e.scrollTop}}static getOverflowState(e,t){const a=t.getBoundingClientRect(),s=window.getComputedStyle(t).position;for(let n=this.getOverflowParent(e,t);n&&!this.isElementType(n,"HTML");n=this.getOverflowParent(e,n)){const o=this.getOverflowStyles(e,n);if("visible"===o.x&&"visible"===o.y)continue;const i=n.getBoundingClientRect();if(0===i.width||0===i.height)return"HIDDEN";const r=a.right<i.left,l=a.bottom<i.top;if(r&&"hidden"===o.x||l&&"hidden"===o.y)return"HIDDEN";if(r&&"visible"!==o.x||l&&"visible"!==o.y){const t=this.getScroll(n),s=a.right<i.left-t.x,r=a.bottom<i.top-t.y;if(s&&"visible"!==o.x||r&&"visible"!==o.y)return"HIDDEN";return"HIDDEN"===this.getOverflowState(e,n)?"HIDDEN":"SCROLL"}const c=a.left>=i.left+i.width,u=a.top>=i.top+i.height;if(c&&"hidden"===o.x||u&&"hidden"===o.y)return"HIDDEN";if(c&&"visible"!==o.x||u&&"visible"!==o.y){if("fixed"===s){const e=this.getScroll(n);if(a.left>=t.scrollWidth-e.x||a.right>=t.scrollHeight-e.y)return"HIDDEN"}return"HIDDEN"===this.getOverflowState(e,n)?"HIDDEN":"SCROLL"}}return"NONE"}static isHiddenByOverflow(e,t){if("HIDDEN"!==this.getOverflowState(e,t))return!1;const{childNodes:a}=t;for(let t=0;t<a.length;t+=1){const s=a[t];if(this.isElement(s)&&!this.isHiddenByOverflow(e,s)&&this.isPositiveSize(s))return!1}return!0}static isShown(e,t,a=!0){if(this.isElementType(t,"BODY"))return!0;const s=t.parentElement;if(s&&this.isElementType(s,"DETAILS")&&!s.hasAttribute("open")&&!this.isElementType(t,"SUMMARY"))return!1;if(this.isElementType(t,"INPUT")&&t.hasAttribute("hidden"))return!1;if(this.isElementType(t,"NOSCRIPT"))return!1;const{visibility:n}=window.getComputedStyle(t);return"collapse"!==n&&"hidden"!==n&&(!!this.isDisplayed(t)&&(!(!a&&0===t.style.opacity)&&(!!this.isPositiveSize(t)&&!this.isHiddenByOverflow(e,t))))}static isValidUrl(e=""){return!!e&&/^(?:https|http):\/\/[\w/\-?=%.]+\.[\w/\-&?=%.]+/gi.test(e)}static isUrlhttps(e=""){return!(!this.isValidUrl(e)||!this.isMatchWithRegex(e,"(^https://)"))}static isUrlhttp(e=""){return!(!this.isValidUrl(e)||!this.isMatchWithRegex(e,"(^http://)"))}static async hash256(e){if(!e||""===e)return"";try{const t="string"==typeof e?(new TextEncoder).encode(e):e,a=await crypto.subtle.digest("SHA-256",t),s=Array.from(new Uint8Array(a));return s.map((e=>e.toString(16).padStart(2,"0"))).join("")}catch(t){return Q.log(`Error in hash256 for ${e}`),e}}static isMatchWithRegex(e,t,a="g"){if(!e||!t)return!1;return new RegExp(t,a).test(e)}static getMatchedContentByRegex(e,t,a="g"){if(!e||!t)return[];const s=new RegExp(t,a);return e.match(s)||[]}};const Oe=class{static getTlds(){return fetch("https://publicsuffix.org/list/public_suffix_list.dat").then((e=>e.ok?e.text():null)).then((e=>this.parse(e))).catch((e=>(Q.error(`TopLevelDomain getTlds() error: ${e.message}`),null)))}static getIANATlds(){return fetch("https://data.iana.org/TLD/tlds-alpha-by-domain.txt").then((e=>e.ok?e.text():null)).then((e=>this.parseIANA(e))).catch((e=>(Q.error(`TopLevelDomain getIANATlds() error: ${e.message}`),null)))}static parse(e){const t={};if(!e)return null;const a=e.split(/\n/);for(let e=0;e<a.length;e+=1){let s=a[e];if(!s)continue;const n=s.indexOf("//");if(0===n)continue;n>0&&(s=s.substring(0,n));const o=s.replace(/^(\s|!|\*\.)/g,"");let i=(s.match(/\./g)||[]).length+1;i-=s.startsWith("!")?1:0,t[o]=i}return 0===Object.keys(t).length&&t.constructor===Object?null:t}static parseIANA(e){const t={};if(!e)return null;const a=e.split(/\n/);for(let e=0;e<a.length;e+=1){const s=a[e];if(!s)continue;if(s.indexOf("#")>=0)continue;t[s.replace(/^(\s|\r|!|\*\.)/g,"").toLowerCase()]=1}return 0===Object.keys(t).length&&t.constructor===Object?null:t}static extract(e,t){const a={subdomain:"",domain:"",suffix:""};if(!e||!t)return a;const s=t.split(".");let n="",o=1;for(let t=s.length-1;t>=0;t-=1){const a=s[t];if(n=n?`${a}.${n}`:a,!e[n])break;o=e[n]}return s.length<=o||(a.subdomain=s.slice(0,-o-1).join("."),a.domain=s.slice(-o-1,-o).join("."),a.suffix=s.slice(-o).join(".")),a}};const Ne=class{constructor(e,t){this.tlds=e,this.document=t,this.urlObj=null,this.tldDetails=null}init(){}generateTldsDetail(){try{return!(!this.document?.URL||!this.tlds)&&(this.urlObj=new URL(this.document.URL),this.tldDetails=Oe.extract(this.tlds,this.urlObj.host),!0)}catch(e){return!1}}isUrlOutbound(e){if(!e||!Ae.isValidUrl(e))return!1;const{host:t}=new URL(e);if(!t)return!1;const a=Oe.extract(this.tlds,t);return`${a.domain}.${a.suffix}`!==`${this.tldDetails.domain}.${this.tldDetails.suffix}`}};class Ie extends Ne{constructor(e=null,t=null){super(e,t),this.topTLD={com:"com",net:"net",org:"org",co:"co",us:"us"}}init(){return!!this.generateTldsDetail()}getTld(){return`.${this.tldDetails?.suffix}`}hasSecureUrlScheme(){return Ae.isUrlhttps(this.urlObj?.href)?1:0}domainStartsWithTld(){const{domain:e,suffix:t}=this.tldDetails||{},a=`${e}.${t}`.toLowerCase();let s=Object.keys(this.topTLD).join("|");return Ae.isMatchWithRegex(a,`^(${s}|www|http)`,"gi")?1:(s=Object.keys(Te).join("|"),Ae.isMatchWithRegex(a,`^(${s})`,"gi")?2:0)}urlInPath(){const e=`(((https?)(:\\/\\/|%3A%2F%2F))?([-A-Z0-9.]+)\\.(${Object.keys(this.tlds).join("|")})(\\/|%2F))`;return Ae.isMatchWithRegex(this.urlObj?.pathname,e,"gi")?1:0}getHyphenCountFromDomain(){const{subdomain:e,domain:t,suffix:a}=this.tldDetails||{},s=`${e}.${t}.${a}`;return Ae.getMatchedContentByRegex(s,"-").length}isAtSymbolInPath(){return Ae.isMatchWithRegex(this.urlObj?.href,"@")?1:0}urlHasTldAsSubdomain(){const{subdomain:e}=this.tldDetails||{},t=`(${["\\.com","\\.net","\\.org","\\.co","\\.us","co-jp","cn\\.jp","-com\\.","co-uk\\.","-net\\.","-co\\.","-fr\\.","\\.fr","-us"].join("|")})`;return Ae.isMatchWithRegex(e,t)?1:0}getSetOfConsecutiveNumbersFromUrl(){const{hostname:e}=this.urlObj||{};return Ae.getMatchedContentByRegex(e,"[\\d]+").length}getNumbersFromUrl(){const{hostname:e}=this.urlObj||{};return Ae.getMatchedContentByRegex(e,"\\d").length}getMaxConsecutiveConsonantsFromUrl(){const{hostname:e}=this.urlObj||{};let t=Ae.getMatchedContentByRegex(e,"[bcdfghjklmnpqrstvwxyz]+","gi");return t&&t.length>0?(t=t.sort(((e,t)=>e.length-t.length)),t[t.length-1].length):0}totalAlphaNumericSequence(){const{hostname:e}=this.urlObj||{};return Ae.getMatchedContentByRegex(e,"(([a-zA-z]+)([0-9]+)|([0-9]+)([a-zA-z]+))","gi").length}isPercentSymbolInUrl(){return Ae.isMatchWithRegex(this.urlObj?.origin,"%")?1:0}getSubDomainLength(){const{subdomain:e}=this.tldDetails||{},t=e&&e.split(".");let a=0;for(let e=0;e<t.length;e++){const s=t[e];a<s.length&&(a=s.length)}return a}getDomainLength(){const{domain:e}=this.tldDetails||{};return e?e.length:0}getSubDomainDepth(){const{subdomain:e}=this.tldDetails||{};return e?e.split(".").length:0}isDomainIsNumeric(){const{domain:e}=this.tldDetails||{};return Ae.isMatchWithRegex(e,"^\\d+$")?1:0}isLoginKeyWordsInUrl(){return Ae.isMatchWithRegex(this.urlObj?.href,"(login|log-in|signin|sign-in)","gi")?1:0}getDomain(e=null){if(e){if(!/^https?:\/\//.test(e))return Q.error("UrlParser getDomain() error: invalid url"),"";return this.parse(e).domain}if(this.tldDetails){const{domain:e,suffix:t}=this.tldDetails;return`${e}.${t}`}return""}getSuffix(e=null){if(e){if(!/^https?:\/\//.test(e))return Q.error("UrlParser getSuffix() error: invalid url"),"";return this.parse(e).suffix}return this.tldDetails?this.tldDetails.suffix:""}parse(e,t=!1){const a={hostname:"",subdomain:"",domain:"",domainOnly:"",suffix:""},s=new URL(e);if(!this.tlds||!s)return a;const{hostname:n}=s,o=n.split(".");let i="",r=1;for(let e=o.length-1;e>=0;e-=1){const t=o[e];if(i=i?`${t}.${i}`:t,!this.tlds[i])break;r=this.tlds[i]}return o.length<=r||(a.subdomain=o.slice(0,-r-1).join("."),a.domain=a.subdomain?o.slice(-r-1).join("."):s.hostname,a.domainOnly=o.slice(-r-1,-r).join("."),a.suffix=o.slice(-r).join("."),a.hostname=s.hostname,t&&(this.urlObj=s,this.tldDetails=a)),a}checkProtocol(e){if(!e)return"";return/^([a-z0-9.+-]+:)(?![0-9])/.test(e)?e:/^\/\//.test(e)?`http:${e}`:`http://${e}`}static removeProtocol(e){if(!e||!/^https?:\/\//.test(e))return Q.error("UrlParser removeProtocol() error: invalid url"),"";const t=`^${new URL(e).protocol}//`;return e.replace(new RegExp(t),"")}static async getInstance(){if(!Ie.instance){const e=await Oe.getTlds();Ie.instance=new Ie(e)}return Ie.instance}static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#"),t.length>1?t[0]:e)}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const a=e.indexOf("?");if(-1===a)return null;const s=e.substring(a+1).split("&");for(let e=0;e<s.length;++e){const a=s[e].indexOf("=");if(-1===a)continue;if(s[e].substring(0,a)===t){return s[e].substring(a+1)}}return null}static getHostname(e){if(e&&(Ae.isValidUrl(e)||/^https?:\/\//.test(e)&&e.includes("localhost"))){return new URL(e).hostname}return Q.error("UrlParser getHostname() error: invalid url"),""}static isPrivateIP(e){return!!(/^10\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])$/.test(e)||/^172\.(1[6-9]|2[0-9]|3[0-1])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])$/.test(e)||/^192\.168\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])$/.test(e))}static isLocalIP(e){return/^127\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])\.([0-1]?[0-9]?[0-9]?|2[0-4][0-9]|25[0-5])$/.test(e)}isSupportedTLD(e){const t=this.getSuffix(e);return this.tlds?1===this.tlds[t]?(Q.log(`PASSED isSupportedTLD check for feature collection on url: ${e}`),!0):(Q.log(`FAILED isSupportedTLD check for feature collection on url: ${e}`),!1):(Q.error("UrlParser isSupportedTLD() error: no tlds list found in parser."),!1)}}const Re=Ie,De=async(e,t,a,s)=>{try{chrome.tabs.sendMessage(s,{ipcId:e,command:t,...a},{},(()=>{chrome.runtime.lastError}))}catch(e){Q.warn(`[broadcast] Unexpected error when calling command: "${t}", err: ${e.message}`)}},Le=(e,t,a,s,n=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');const o={};return"number"==typeof n&&(o.frameId=n),chrome.tabs.sendMessage(s,{ipcId:e,command:t,...a},o)},Ce=(e,t={},a)=>(async(e,t,a={},s={})=>{try{if(s?.tabId){const{tabId:n,frameId:o}=s;return await Le(e,t,a,n,o)}if(s?.broadcast){const n=await chrome.tabs.query({}),{broadcastIgnoreId:o=[]}=s;return n.filter((({id:e})=>!o.includes(e))).forEach((({id:s})=>{De(e,t,a,s)})),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...a})}catch(e){return Q.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,a);(new class extends Z{constructor(){super(a)}async main(){const a=document.location.href,s=k.name,n=(await Ce(e,{action:l,data:{[s]:[]}}))[s],o=await Ce(t),{apsUrlList:i}=JSON.parse(o),r=i.email,c=Object.keys(r).find((e=>a.includes(e)));if(c){const e=r[c].selector;this.initEmailObserver(e,n)}else this.initEmailObserver()}initEmailObserver(t,a){const s=()=>{const s=document.querySelectorAll(t);s.length&&s.forEach((t=>{const s=t.getAttribute("href");"true"!==t.getAttribute("mcafee_aps")&&s&&_e.isProperWebURL(s)&&(t.setAttribute("mcafee_aps","true"),t.addEventListener("click",(()=>{const t=Re.getHostname(s);a.push(t),Ce(e,{action:r,data:{[k.name]:a}})})))}))},n=new MutationObserver((()=>{s()}));s(),n.observe(document,{childList:!0,subtree:!0})}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_aps_observer.js.map
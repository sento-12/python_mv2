/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2024 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="SEND_TELEMETRY",t="SHOW_MB_SIDEBAR",n="MB_VIDEO_FLAGGED",i="PING_CONTENT_MB_BANNER",s="MB_BANNER_SHOW",o="MB_BANNER_REMOVE",a="BROADCAST_MB_UPDATE_UI",r={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},_=(Object.values(r).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:l,...c}=r,d={name:"BLOCK_PAGE_WHITELIST",type:"array"},p={name:"POPUP_STATS",type:"object"},E={name:"RAT_DETECTION_WHITELIST",type:"array"},T={name:"LAST_ANTITRACKER_SCAN_RESULT",type:"object"},m={name:"FINGER_PRINT",type:"number"},N={name:"FIRST_PARTY",type:"number"},g={name:"THIRD_PARTY",type:"number"},u={name:"TRACKER_DOMAIN_LIST",type:"array"},h={name:"ANTITRACKER_WHITELIST",type:"array"},A={name:"TYPOSQUATTING_WHITELIST",type:"array"},S={name:"CACHE_TAB_DATA",type:"object"},y=chrome,I={GREEN:0,YELLOW:1,RED:2,GREY:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"GREY"!==e&&(yield this[e])}},O=1,C=2,b=3,D=0,R=1,L=3,f=2,w="1.0.0.35",v=-1,B=0,P=1,k=2,M=3,U=70,F=31,K=16,G=1,V=(e,t)=>Array.from(Array(t+1).keys()).slice(e),W=y.runtime.getURL(""),H={fingerPrintDomains:m.name,firstParty:N.name,thirdPartyTrackers:g.name},x="enabled";const $=e=>{"undefined"!=typeof document&&null!==document&&("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?e():document.addEventListener("DOMContentLoaded",e))};const Y=0,q="PRINT_IN_BACKGROUND",z={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4,ALL_IN_BACKGROUND:99},j=1,X=2,J=3,Q=4,Z={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},ee={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};const te=new class{constructor(){this.storageChecked=!1,this.logLevel=null,this.queue=[];const e="MCLOGLEVEL";chrome?.storage?.local.get([e]).then((t=>{const n=Object.values(z).includes(t[e]);this.logLevel=n?t[e]:Y,this.logLevel!==z.NONE&&this.queue.forEach((({callback:e,message:t,processType:n})=>{e(t,n)})),this.queue=[],this.storageChecked=!0}))}log(e,t=null){this.storageChecked?this.processLog(e,j,t,this.logLevel):this.queue.push({callback:this.log.bind(this),message:e,processType:t})}error(e,t=null){this.storageChecked?this.processLog(e,X,t,this.logLevel):this.queue.push({callback:this.error.bind(this),message:e,processType:t})}warn(e,t=null){this.storageChecked?this.processLog(e,J,t,this.logLevel):this.queue.push({callback:this.warn.bind(this),message:e,processType:t})}debug(e,t=null){this.storageChecked?this.processLog(e,Q,t,this.logLevel):this.queue.push({callback:this.debug.bind(this),message:e,processType:t})}processLog(e,t,n,i){if(i===z.NONE)return;let s="chrome-extension:"===location.protocol?Z.BACKGROUND:Z.CONTENT;n&&Z[n]&&(s=n);const o=new Date,a=t===X?e:`%c[${s} ${o.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}]: %c${e}`;s===Z.CONTENT&&this.logLevel===z.ALL_IN_BACKGROUND&&chrome.runtime.sendMessage({command:q,logMessage:a,processType:s,logType:t,logLevel:i}),this.printLog(a,s,t,i)}printLog(e,t,n,i){const s=ee.DEFAULT,o=ee[t]||s;if(i>=z.ERROR&&n===X&&console.error(e),i>=z.INFO&&n===j&&console.log(e,o,s),i>=z.WARN&&n===J){const t="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${e}`,t,o,s)}if(i>=z.DEBUG&&n===Q){const t="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${e}`,t,o,s)}}},ne=(e,t=null,n)=>{"function"==typeof n?chrome.runtime.onMessage.addListener(((i,s,o)=>{if(s.id===chrome.runtime.id&&"object"==typeof i&&!Array.isArray(i)&&i?.ipcId===e)return n({promises:t,request:i,sender:s,sendResponse:o})})):te.error("Provided with invalid callback function")};class ie{constructor(e){this.pingCommand=e,this.basePingListener(),this.addIdentifier()}basePingListener(e=null){ne("WA",null,(({request:t,sendResponse:n})=>{const{command:i}=t;if(i===this.pingCommand)return te.debug(`File Injection [pinged]: Received ${i} command`),n({content:!0}),"function"==typeof e&&e(),!0}))}addIdentifier(){$((()=>{const e=document.createElement("span");e.id=this.pingCommand,e.style.cssText="display:none",document.body.appendChild(e)}))}}const se=async(e,t,n,i)=>{try{chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},{},(()=>{chrome.runtime.lastError}))}catch(e){te.warn(`[broadcast] Unexpected error when calling command: "${t}", err: ${e.message}`)}},oe=(e,t,n,i,s=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');const o={};return"number"==typeof s&&(o.frameId=s),chrome.tabs.sendMessage(i,{ipcId:e,command:t,...n},o)},ae=(e,t={},n)=>(async(e,t,n={},i={})=>{try{if(i?.tabId){const{tabId:s,frameId:o}=i;return await oe(e,t,n,s,o)}if(i?.broadcast){const s=await chrome.tabs.query({}),{broadcastIgnoreId:o=[]}=i;return s.filter((({id:e})=>!o.includes(e))).forEach((({id:i})=>{se(e,t,n,i)})),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...n})}catch(e){return te.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,n);class re{static geti18nRes(e,t=[]){let n=y.i18n.getMessage(e,t);const i=y.i18n.getMessage("res_PRODUCT_NAME_TRADEMARKED");return n=n.replace(/%PRODUCTNAME%/g,i),n}static getResStr(e,t){const n=re.geti18nRes(e);t("??"===n?"":n)}static async getFileSource(e){try{return(await fetch(y.runtime.getURL(e))).text()}catch(e){return""}}}class _e{constructor(e=null,t=document){if(this.resourcerequestor=re,this.document=t,e){const t=this.document.querySelectorAll(`#${e}`);t&&(this.document=t[0].contentDocument)}this.localeData=this.localeData.bind(this),this.fillText=this.fillText.bind(this),this.fillLocalizedTexts=this.fillLocalizedTexts.bind(this),this.fillInputPlaceHolders=this.fillInputPlaceHolders.bind(this)}localeData(e,t=[]){return this.resourcerequestor.geti18nRes(e,t)}fillText(e,t){const n=this.document.getElementById(e);if(n){const e=n.getAttribute("x-mcinsertposition");if(e)return void n.insertAdjacentText(e,t);n.textContent=t,n.setAttribute("x-mcl10nprocessed",!0)}}fillLocalizedTexts(){for(const{id:e}of this.document.querySelectorAll("*[x-mclocalizedtext]:not([x-mcl10nprocessed=true])")){const t=this.localeData(e);if(null==t)return!1;this.fillText(e,t)}return!0}fillInputPlaceHolders(){for(const{id:e}of this.document.querySelectorAll("*[x-inputplaceholder]")){const t=this.localeData(e),n=this.document.getElementById(e);if(null==t)return!1;null!=n&&n.setAttribute("placeholder",t)}return!0}init(){this.fillLocalizedTexts(),this.fillInputPlaceHolders()}}const le=e=>{let{top:t,left:n}=ce(e);return t<0&&(t=0),n<0&&(n=0),{top:t,left:n}},ce=e=>{const t=e.getBoundingClientRect(),n=window.pageYOffset||window.scrollY,i=window.pageXOffset||window.scrollX;return{top:Math.round(t.top+n),left:Math.round(t.left+i),bottom:Math.round(t.bottom+n),right:Math.round(t.right+i)}},de="NO_VIDEO_PLAYING",pe="NO_AUDIO_PLAYING",Ee="FEATURE_OFF",Te="DISPLAYED";const me="unknown",Ne={EVENT_NAME:"wa_deepfake_detection",EVENT_ID:"wa_deepfake_detection"},ge="screen",ue="event",he="ai_audio_detected",Ae="ai_audio_not_detected",Se="no_suite",ye="unable_read_csp_id",Ie="impression",Oe="accepted",Ce="faq_request",be="closed",De="fades_away",Re="expand",Le="snoozed",fe="back_to_entry",we="support_request",ve="back_to_deepfake_side_panel",Be={ACTIVATION_ENROLLMENT_BANNER:"wa_deepfake_activation_enrollment_banner",ACTIVATION_ENROLLMENT_BANNER_SUCCESS:"wa_deepfake_activation_success",AI_ANNOTATION_BANNER:"wa_deepfake_banner_annotation",SIDEBAR_PANEL:"wa_deepfake_side_panel",SIDEBAR_FAQ_PANEL:"wa_deepfake_faq"},Pe={EMBEDED_BANNER:"embedded",PAGE_BANNER:"page",AI_ANNO_FULL_BANNER:"banner_only",AI_ANNO_HOVER_BANNER:"icon_and_banner_on_hover",AI_ANNO_ICON_BANNER:"icon_only"},ke={AUDIO_PLAYING:"audio_playing",X_CLICKED:"x_clicked",ACTIVATE_BTN_CLICKED:"activate_button_clicked",ACTIVATION_LEARM_MORE_CLICKED:"learn_more_clicked",ACTIVATION_ACCEPT:"deepfake_activation_accepted",ANNO_BANNER_CLICKED:"banner_clicked",ANNO_BANNER_FADE_AWAY:"time_elapsed",ANNO_BANNER_HOVER:"banner_hover",ANNO_BANNER_CLICKED_FOR_SIDEBAR:"deepfake_banner_annotation_clicked",MAIN_SIDEBAR_DFD_CLICKED:"sidebar_panel_deepfake_icon_clicked",FAQ_PANEL_BACK_CLICKED:"back_from_faq_clicked",SNOOZE_OPTION_SELECTED:"snooze_option_selected",AUDIO_DETECTION_TOGGLE_BTN_CLICKED:"audio_detection_toggle_switched",DFD_PANEL_BACK_CLICKED:"back_button_clicked",DFD_PANEL_BASICS_BTN_CLICKED:"deepfake_basics_button_clicked",DFD_PANEL_BUY_BTN_CLICK:"buy_now_button_clicked",DFD_PANEL_ON_TRIAL_BUY_BTN_CLICK:"buy_now_on_trial_clicked",DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED:"contact_support_link_clicked",DFD_FAQ_PANEL_BACK_CLICKED:"back_button_clicked"},Me={NO_ACTION:"no_action",WA_INTERACTION:"wa_interaction"},Ue={GENERIC_ERR:"generic_error",NO_AUDIO_PLAYING:"no_audio_playing",NO_VIDEO_PLAYING:"no_video_playing",DETECTION_OFF:"detection_off",NOTIFICATION_PAUSE:"notification_paused",GRAPH_DISPLAYED:"graph_displayed"};class Fe{static toTlmWpsCspClientId(e){let t=e;return null===t?t=Se:void 0===t&&(t=ye),t}static toTlmAudioGraphStatus(e,t){let n=Ue.NOTIFICATION_PAUSE;if(t)return n;if(n=Ue.GENERIC_ERR,!e)return n;switch(e){case de:n=Ue.NO_VIDEO_PLAYING;break;case pe:n=Ue.NO_AUDIO_PLAYING;break;case Ee:n=Ue.DETECTION_OFF;break;case Te:n=Ue.GRAPH_DISPLAYED}return n}static toTlmActivatedDays(e){let t=me;if(e<=0)return t;const n=Date.now()-e;return t=Math.ceil(n/864e5),t}}const Ke="whitelist",Ge="preference",Ve="statistics",We="about",He={BLOCK_PAGE:"Block_Page",BROWSER_ACTION_CLICKED:"BrowserAction_Clicked",BROWSER_NAVIGATE:"Browser_Navigate",CONTENT_SECURITY_POLICY_WASM:"Content_Security_Policy_Wasm",DARK_WEB_SCAN:"DarkWebMonitoring",DOWNLOAD_BLOCK:"Download_Block",GET_SEARCH_EXTENSION:"EmbedSearchExtension",PROFILE_INFO:"ProfileInfo",REMOTE_ACCESS_TROJAN:"RemoteAccessTrojan",SEARCH_SUGGEST_BLOCK_PAGE:"SearchSuggest_BlockPage",SEARCH_SUGGEST:"SearchSuggest",SECURE_SEARCH_HIT:"Secure_Search_Hit",SIDEBAR_PANEL:"SideBar_Panel",SITE_REPORT:"SiteReport",SMA_REPUTATION:"SMA_Reputation",TOAST:"Toast",TYPOSQUATTING:"Typosquatting",WSS_ANALYTICS:"WSS_Analytics",FORM_LOGIN_DETECTION:"FormLoginDetection",APS:{EVENT_NAME:"AdvancedProtectionSignals",IMPRESSION_BALLOON:"IMPRESSION_BALLOON",IMPRESSION_HOVER:"IMPRESSION_HOVER",CLOSE_BALLOON:"CLOSE_BALLOON",TOAST_CLOSE:"TOAST_CLOSE",TOAST:"toast",BALLOON:"balloon"}},xe="RegularToast",$e="BrowserActionClicked",Ye="Typosquatting",qe="BlockPage",ze="SecureSearchHit",je="SideBarPanel",Xe="SMAReputation",Je="DownloadBlock",Qe="Impression",Ze="WebAdvisor",et="Selection",tt="CloseClicked",nt={ACKNOWLEDGED:"Acknowledged",WHITELISTED:"Whitelisted"},it="AcceptRisk",st="Close",ot="GotIt",at="Hover",rt="Frame",_t="About",lt="Preferences",ct="Whitelist",dt="UserStatistics",pt="Green",Et="Yellow",Tt="Red",mt="Grey",Nt="UNKNOWN",gt="Typosquatting",ut="Phishing",ht="DefaultSearch",At={CLICK:"click",KEYDOWN:"keydown",RETURN_KEY_CODE:13,SHOW:"show",SEARCH_SUGGEST_KEY_CODES:[8,32,46,...V(48,57),...V(65,90),...V(96,107),...V(109,111),...V(186,192),...V(219,222)]},St={LOADED:"Loaded",CHECKED:"checked",UNKNOWN:"UNKNOWN",ACTION_PANEL:"ActionPanel",ACCEPTED:"Accepted",DECLINED:"Declined",SETTINGS_TAB_PREFIX:"settings_tab_",GREEN:"GREEN",YELLOW:"YELLOW",RED:"RED",PREFERENCE:"Preference",DEFAULT:"default"};class yt{static toTelemetryBlockState(e){let t=Nt;switch(e){case I.GREEN:t=pt;break;case I.YELLOW:t=Et;break;case I.RED:t=Tt;break;case I.GREY:t=mt;break;case I.TYPOSQUATTING:t=gt;break;case I.PHISHING:t=ut}return t}static toTelemetrySettingTab(e){let t=lt;switch(e){case Ke:t=ct;break;case Ve:t=dt;break;case We:t=_t}return t}}class It{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:n}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},i={};return i[b]=n,i[O]=t,i[C]=e,i[f]}}const{SYSTEM:Ot,USER:Ct}={SYSTEM:0,USER:1},bt=It.getBrowserSuffix(),Dt={DEV_MODE:{scope:Ot,name:"dev_mode",value:!1},AFF_ID:{scope:Ot,name:"*Affid",value:0},BINARY_VERSION:{scope:Ot,name:"version",value:null},EXTENSION_VERSION_CH:{scope:Ot,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:Ot,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:Ot,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:Ot,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:Ot,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:Ot,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:Ct,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${bt}`,value:""},SECURE_SEARCH_REGEXES:{scope:Ct,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:It.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:Ot,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:Ct,name:`*SSDateStampShowedToast${bt}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:Ot,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:Ct,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:Ct,name:`*SSToastChoice${bt}`,value:!1},SS_DEF:{scope:Ot,name:`*SS_DEF${bt}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:Ot,name:`*AnnotationsChoiceExplicit${bt}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:Ct,name:`*CurrentSAOInExtension${bt}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:Ct,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:Ct,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:Ot,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:Ot,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:Ot,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:Ot,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:Ot,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:Ot,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:Ot,name:"CryptojackingDisabled",value:!0},SMA_USER_TOGGLE:{scope:Ot,name:`sma_user_toggle${bt}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:Ot,name:`sma_annotation_options${bt}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:Ot,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:Ot,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:Ot,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:Ot,name:"*CounterDownloadsBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:Ct,name:"*WhiteList",value:""},TS_WHITELIST:{scope:Ct,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:Ot,name:"CSPIdValue",value:"__not_available__"},MTI_CLIENT_ID:{scope:Ot,name:"gti_client_id",value:""},JWT_TOKEN_ENABLED:{scope:Ot,name:"jwt_token_enabled",value:!1},UNINSTALL_SURVEY_ENABLED:{scope:Ot,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:Ot,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:Ot,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:Ot,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:Ot,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:Ot,name:"aps_toggle_setting",value:!0},ALT_TRIGGER:{scope:Ot,name:"alt_triggers_cohort",value:0},ANNOTATION_JOURNEY_COHORT:{scope:Ot,name:`annotation_journey_cohort${bt}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:Ct,name:`aj_toast${bt}`,value:null},DAILY_GREEN_URLS_TO_COLLECT:{scope:Ot,name:"daily_green_urls_to_collect",value:0},FEATURE_COLLECTION_ENABLED:{scope:Ot,name:"feature_collection_enabled",value:!1},DAILY_GREEN_URLS_RESET_RATE:{scope:Ot,name:"daily_green_urls_reset_rate",value:0},ANTITRACKER_UPSELL_ENABLED:{scope:Ot,name:"antitracker_upsell_enabled",value:!0},HERON_REPORT_ENABLED:{scope:Ot,name:"heron_report_enabled",value:!1},SAMPLING_RATE_BLOCK_DEFAULT:{scope:Ot,name:"sampling_rate_block_default",value:100},SAMPLING_RATE_USER_FEEDBACK:{scope:Ot,name:"sampling_rate_user_feedback",value:1},WA_EXTN_UUID:{scope:Ct,name:`wa_extn_uuid${bt}`,value:"",writeOnly:!0},MOCKINGBIRD_ENABLED:{scope:Ot,name:"mockingbird_enabled",value:!0},TYPOSQUAT_ENABLED:{scope:Ot,name:"typosquat_enabled",value:!0}};class Rt{static getResetValues(){return{blockedIframes:[],tabDomainTrusted:!1,mockingbird:{videoData:{}},mbVideoId:null}}static getDefaultValues(){return Rt.getResetValues()}reset(e){const t=Ht.localStore.get(S.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;Ht.htiReportHandler.checkBacklog(e,t[e],n),this.update(e,Rt.getResetValues())}get(e){return Ht.localStore.get(S.name,{})[e]||Rt.getDefaultValues()}set(e,t){const n=Ht.localStore.get(S.name,{});n[e]=t,Ht.localStore.set(S.name,n)}delete(e){const t=Ht.localStore.get(S.name,{}),n=t[e]&&t[e].blockedIframes&&Object.keys(t[e].blockedIframes).length>0;Ht.htiReportHandler.checkBacklog(e,t[e],n),delete t[e],Ht.localStore.set(S.name,t)}update(e,t){const n=this.get(e);this.set(e,{...n,...t})}setTabBlockPageData(e,t,n=!0){const i={...this.get(e),blockPageData:t};this.set(e,i),n&&!t.url.includes("chrome://extensions/")&&Ht.htiReportHandler.addReportToBacklog(e,i)}addBlockedFrame(e,t){const n=this.get(e);n.blockedIframes.push(t),this.update(e,n),Ht.htiReportHandler.addIFrameReportToBacklog(e,n)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){const t=this.get(e);t.blockedIframes=[],this.update(e,t)}}const Lt="ph",ft="www.siteadvisor.com/",wt="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",vt="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",Bt="https://sadownload.mcafee.com/products/SA/Win/extensions/sailor/condition.json",Pt="https://sadownload.mcafee.com/products/SA/Win/extensions/antitracker/all_trackers.json",kt="https://threat.api.mcafee.com/",Mt="https://sadownload.mcafee.com/products/SA/Win/extensions/waextension/condition.json",Ut=new Set(["www.mcafee.com"]),Ft="PAGES_SCANNED",Kt="PAGES_BLOCKED",Gt="DOWNLOADS_SCANNED",Vt="DOWNLOADS_BLOCKED";class Wt{static init(){const e=this.read(),{PAGES_SCANNED:t,PAGES_BLOCKED:n,DOWNLOADS_SCANNED:i,DOWNLOADS_BLOCKED:s}=Ht.nativeSettings,o={pagesScanned:t.value||e.pagesScanned,pagesBlocked:n.value||e.pagesBlocked,downloadsScanned:i.value||e.downloadsScanned,downloadsBlocked:s.value||e.downloadsBlocked};Ht.localStore.set(p.name,o)}static add(e){const t=this.read();switch(e){case Ft:t.pagesScanned++;break;case Kt:t.pagesBlocked++;break;case Gt:t.downloadsScanned++;break;case Vt:t.downloadsBlocked++;break;default:return}Ht.localStore.set(p.name,t)}static read(){const e={pagesScanned:0,pagesBlocked:0,downloadsScanned:0,downloadsBlocked:0},t=Ht.localStore.get(p.name);return t&&Object.assign(e,t),e}}const Ht={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:f,sessionStore:null,localStore:null,idb:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new Rt,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:wt,tldParser:null,trustedDomains:Ut,nativeSettings:Dt,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],preconditions:null,platform:class{static debounce(e,t,n){let i;return(...s)=>{const o=n&&!i;clearTimeout(i),i=setTimeout((()=>{i=null,n||e(...s)}),t),o&&e(...s)}}static isBrowserEN(){return y.i18n.getUILanguage().toLowerCase().startsWith("en")}static isChromeBrowser(){const e=navigator.userAgent.toLowerCase();return!(!e.includes("chrome")||!1==!!chrome)&&(!e.includes("opr")&&!e.includes("edg"))}static isWindowsOS(){const{platform:e}=navigator;return e&&-1!==e.search("Win")}static getPlatform(){const{platform:e}=navigator;let t=D;return-1!==e.search("Mac")?t=R:-1!==e.search("iPhone")&&(t=L),t}}.getPlatform(),wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:vt,engineCheckInterval:864e5,ENGINES_VERSION:w,AUTO_PLAY_NOTIFICATION_ENABLED:!1,DLS_POPUP_FOR_WA_NATIVE_ENABLED:!1,WA_EXTN_CONDITION_URL:Mt,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,typosquattingHandler:null,URL_DOWNLOAD_MAX_CACHE:100,URL_DOWNLOAD_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["buy/payselect/handlers","buy/addressselect/handlers"]}},email:{"mail.google.com/mail":{selector:"table[role=presentation] > tr div[data-message-id] a"},"outlook.live.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=complementary][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,wpsRequestedSettings:new Set(["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"]),permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com"],mtiRequestor:null,htiServer:kt,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6",sailer:null,sailorConditionUrl:Bt,allTrackerUrl:Pt,antitrackData:new class{isActive(){return Ht.nativeSettings.ANTITRACKER_UPSELL_ENABLED.value&&!Ht.isAntitrackerExtInstalled}isWhiteListed(e,t){return Ht.localStore.get(h.name,["mcafee.com"]).some((t=>e.includes(t)))||t.includes("fi")}addCountTo(e,t=1){const n=Ht.localStore.get(e,0);Ht.localStore.set(e,n+t)}getAndResetCount(e){const t=Ht.localStore.get(e,0);return Ht.localStore.set(e,0),t}addLatestDomain(e,t){try{this.addCountTo(t);const n=new Date,i=`${n.getFullYear()}${n.getMonth()}${n.getDate()}`,s=new URL(e).hostname.replace("www.",""),o=this.getDomainList();o.dataDate!==i&&(o.dataDate=i,o.domainHistoryMap={}),o.lastVisited=s,o.domainHistoryMap=o.domainHistoryMap||{},(o.domainHistoryMap[s]||Object.keys(o.domainHistoryMap).length<50)&&(o.domainHistoryMap[s]=(o.domainHistoryMap[s]||0)+1),Ht.localStore.set(u.name,o)}catch(e){te.log(`[AntitrackerData] Error adding last domain: ${e.message||e}`)}}getDomainList(){const e=Ht.localStore.get(u.name,{});return JSON.parse(JSON.stringify(e))}updateWPS(e){try{e=e?JSON.parse(e):{};const{pagesBlocked:t=0,pagesScanned:n=0}=Wt.read();let i=0;Object.values(H).forEach((t=>{const n=t.toLowerCase(),s=(e[n]||0)+this.getAndResetCount(t);e[n]=s,i+=s})),e.total_trackers=i,e.blocked_pages=t,e.scanned_pages=n;const s=this.getDomainList();e.last_visited=s.lastVisited||"",e.domain_history=this.getDomainHistory(s.domainHistoryMap),0===e.total_trackers&&0===e.blocked_pages&&0===e.scanned_pages&&""===e.last_visited&&""===e.domain_history||!this.isSameAsLastScan(e)&&Ht.wssMessageDispatcher&&(Ht.wssMessageDispatcher.nativeDispatcher.updateAntitrackerToWPS(e),Ht.localStore.set(T.name,e))}catch(e){te.log(`[AntitrackerData] Error sending AT updates to WPS: ${e.message}`)}}getDomainHistory(e={}){let t="";const n=Object.keys(e);if(0===n.length)return t;n.sort(((t,n)=>e[n]-e[t]));for(let i=0;i<n.length&&i<5&&n[i];i++){const s=n[i];t+=`${s},${e[s]},`}return t.slice(0,-1)}isSameAsLastScan(e){const t=Ht.localStore.get(T.name,{}),n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}},isAntitrackerExtInstalled:!1,sendDataToWpsFlag:!1,analyticsContentVersion:"1.0.1",htiReportHandler:null,mockingBirdHandler:null},xt=(d.name,A.name,d.name,E.name,"ADD"),$t="REMOVE",Yt={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class qt{static getResString(e,t){Yt.ANNOTATION.resourceRequestor.getResStr(e,(n=>{n?t(n):Yt.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class zt{static async toHTICategoriesString(e,t=!1){const n=e=>new Promise((t=>{qt.getResString(e,(e=>t(e)))})),i=async(e,t)=>{const i={},s=await n(`category_id_${e}_name`);if(i.name=s,t){const t=await n(`category_id_${e}_description`);i.description=t}return i},s=[];for(const n of e)s.push(i(n,t));return await Promise.all(s)}static browserTypeToString(e=!1){let t="";switch(f){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;case 4:t="SF";break;default:t="UN"}return e?t.toLowerCase():t}static toAnnotationImageClass(e){let t="";switch(zt.toColor(e)){case B:t="green";break;case k:t="red";break;case P:t="yellow";break;case M:t="grey"}return t}static isPhishingURI(e){return e&&e.includes(Lt)}static toBlockState(e){const t=zt.toColor(e);return t===P&&zt.isPhishingURI(e.category)?I.PHISHING:isNaN(t)?I.GREY:t}static toColor(e){let t=v;return e&&void 0!==e.trust?(t=e.trust>=U?B:e.trust>=F?M:e.trust>=K?P:e.trust>=G?k:v,t):t}static toSiteReportUrl(e){return`${y.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){return e.startsWith(W)}static isAnyExtensionUrl(e){return e.startsWith(`${W.split("://")[0]}://`)}static isSafeUrl(e){return zt.isSiteAdvisorUrl(e)||zt.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${ft}`)||e.startsWith(`https://${ft}`)}static isPropertRedirectUrl(e){return zt.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e=""){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static async blockRequest(e,t,n){const i=await y.declarativeNetRequest.getDynamicRules();0===i.filter((e=>e.condition.urlFilter===t)).length&&zt.addDynamicRule(e,t,n,i.length+1,0)}static async addDynamicRule(e,t,n,i,s){if(s>=10)te.error(`Unable to add dynamic rule for tabId:${e}, on url: ${t}. message: ${n}`);else try{await y.declarativeNetRequest.updateDynamicRules({addRules:[{id:i,condition:{urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]}),te.log(`${n} ${t} ${e}`)}catch(o){zt.addDynamicRule(e,t,n,i+1,s+1)}}static async updateExcludedTabInSession(e,t){try{const n=999999,i=(await y.declarativeNetRequest.getSessionRules()).find((e=>e.id===n));let s=i?.condition?.tabIds||[],o=!1;const a=s.indexOf(e);t===xt&&-1===a?(s.push(e),o=!0):t===$t&&-1!==a&&(s=s.filter((t=>t!==e)),o=!0),o&&y.declarativeNetRequest.updateSessionRules({removeRuleIds:[n],addRules:[{id:n,condition:{tabIds:s},action:{type:"allow"}}]})}catch(e){te.error(e.message)}}static updateHTIGlobalsAfterNativeConnection(){const e=Ht.nativeSettings.MTI_CLIENT_ID.value,t=Ht.nativeSettings.CSP_ID_SETTING.value,n=Ht.nativeSettings.JWT_TOKEN_ENABLED.value;""!==e&&Ht.mtiRequestor.setGlobals({clientIdGuid:e}),"__not_available__"!==t&&Ht.mtiRequestor.setGlobals({cspid:t}),"boolean"==typeof n&&Ht.mtiRequestor.setGlobals({jwtEnabled:n})}static newGuid(){const e=new Uint8Array(24);let t=Date.now().toString()+Math.random().toString().substring(2);for(let n=0;n<24;++n)t+=e[n].toString();let n="{";for(let e=0;e<36;++e)if(8===e||13===e||18===e||23===e)n+="-";else{n+=t[Math.floor(Math.random()*t.length)]}return n+="}",n}}class jt{constructor(e){this._options=e,this.TELEMETRY_HANDLERS=this.initializeTelemetryHandler()}fetchTelemetryHandlers(e){const t=[];return this.TELEMETRY_HANDLERS.forEach((n=>{n.trigger.identifier&&e!==n.trigger.identifier||t.push(n)})),t}initializeTelemetryHandler(){return[{trigger:{identifier:He.FORM_LOGIN_DETECTION,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:He.FORM_LOGIN_DETECTION,url:this._options.url,browser:zt.browserTypeToString(),type:this._options.type,_event_name:He.FORM_LOGIN_DETECTION}}]},{trigger:{identifier:He.BLOCK_PAGE,sendTelemetry:this._options.isFromBackground||!1},messages:[{template:{analyticsSDK:!0,name:qe,interaction_type:Qe,colour:yt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:this._options.level===rt?"UNKNOWN":this._options.blockPageStyle||"UNKNOWN",_event_name:He.BLOCK_PAGE,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.BLOCK_PAGE,sendTelemetry:this._options.isFromForeground||!1},messages:[{template:{analyticsSDK:!0,name:qe,interaction_type:it,colour:yt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:this._options.blockPageStyle||"UNKNOWN",_event_name:He.BLOCK_PAGE,browser:zt.browserTypeToString(),metadata:`url=${this._options.url}`}}]},{trigger:{identifier:He.BLOCK_PAGE,selector:"#sidebar-close",action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:qe,interaction_type:tt,colour:yt.toTelemetryBlockState(this._options.colour),level:this._options.level,style:this._options.blockPageStyle||"UNKNOWN",_event_name:He.BLOCK_PAGE,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.BROWSER_ACTION_CLICKED,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:$e,interaction_type:Ze,badge_count:this._options.count,_event_name:He.BROWSER_ACTION_CLICKED,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.BROWSER_NAVIGATE,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,url:this._options.url,browser:zt.browserTypeToString(),_event_name:He.BROWSER_NAVIGATE}}]},{trigger:{identifier:He.CONTENT_SECURITY_POLICY_WASM,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,colour:this._options.colour,browser:zt.browserTypeToString(),_event_name:He.CONTENT_SECURITY_POLICY_WASM,policy:this._options.wasmPolicy,url:this._options.url}}]},{trigger:{identifier:He.DOWNLOAD_BLOCK,state:St.LOADED,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Je,interaction_type:Qe,process_name:St.UNKNOWN,file_name:St.UNKNOWN,colour:St.UNKNOWN,ui_type:St.ACTION_PANEL,_event_name:He.DOWNLOAD_BLOCK,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.PROFILE_INFO,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:He.PROFILE_INFO,interaction_type:Qe,tab:yt.toTelemetrySettingTab(Ge),_event_name:He.PROFILE_INFO,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.PROFILE_INFO,selector:`#${St.SETTINGS_TAB_PREFIX}${Ge}`,action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.PROFILE_INFO,interaction_type:Qe,tab:yt.toTelemetrySettingTab(Ge),_event_name:He.PROFILE_INFO,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.PROFILE_INFO,selector:`#${St.SETTINGS_TAB_PREFIX}${Ke}`,action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.PROFILE_INFO,interaction_type:Qe,tab:yt.toTelemetrySettingTab(Ke),_event_name:He.PROFILE_INFO,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.PROFILE_INFO,selector:`#${St.SETTINGS_TAB_PREFIX}${We}`,action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.PROFILE_INFO,interaction_type:Qe,tab:yt.toTelemetrySettingTab(We),_event_name:He.PROFILE_INFO,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.PROFILE_INFO,selector:`#${St.SETTINGS_TAB_PREFIX}${Ve}`,action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.PROFILE_INFO,interaction_type:Qe,tab:yt.toTelemetrySettingTab(Ve),_event_name:He.PROFILE_INFO,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.SEARCH_SUGGEST_BLOCK_PAGE,selector:"#block_page_search_input",action:At.KEYDOWN},messages:[{template:{analyticsSDK:!0,name:He.SEARCH_SUGGEST,interaction_type:Qe,search_type:He.BLOCK_PAGE,browser:zt.browserTypeToString(),_event_name:He.SEARCH_SUGGEST}}]},{trigger:{identifier:He.SEARCH_SUGGEST_BLOCK_PAGE,sendTelemetry:this._options.selected},messages:[{template:{analyticsSDK:!0,name:He.SEARCH_SUGGEST,interaction_type:et,search_type:He.BLOCK_PAGE,browser:zt.browserTypeToString(),_event_name:He.SEARCH_SUGGEST}}]},{trigger:{identifier:He.SEARCH_SUGGEST_TYPOSQUATTING,selector:"#typosquatting_message_search_input",action:At.KEYDOWN},messages:[{template:{analyticsSDK:!0,name:He.SEARCH_SUGGEST,interaction_type:Qe,search_type:He.TYPOSQUATTING,browser:zt.browserTypeToString(),_event_name:He.SEARCH_SUGGEST}}]},{trigger:{identifier:He.SEARCH_SUGGEST_TYPOSQUATTING,sendTelemetry:this._options.selected},messages:[{template:{analyticsSDK:!0,name:He.SEARCH_SUGGEST,interaction_type:et,search_type:He.TYPOSQUATTING,browser:zt.browserTypeToString(),_event_name:He.SEARCH_SUGGEST}}]},{trigger:{identifier:He.SECURE_SEARCH_HIT,sendTelemetry:!0},messages:[{template:{name:ze,search_type:ht,_event_name:He.SECURE_SEARCH_HIT,browser:zt.browserTypeToString(),type_tag:this._options.typeTag,provider_type:this._options.engineName}}]},{trigger:{identifier:He.SIDEBAR_PANEL,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:je,interaction_type:this._options.interaction_type,_event_name:He.SIDEBAR_PANEL,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.SITE_REPORT,state:St.LOADED,sendTelemetry:!0},messages:[{template:{name:He.SITE_REPORT,interaction_type:Qe,block_state:yt.toTelemetryBlockState(this._options.blockState),site_categories:this._options.siteCategories,url:this._options.displayUrl,style:St.ACTION_PANEL,_event_name:He.SITE_REPORT,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.SITE_REPORT,selector:"#sidebar-close",action:At.CLICK},messages:[{template:{name:He.SITE_REPORT,interaction_type:tt,block_state:yt.toTelemetryBlockState(this._options.blockState),site_categories:this._options.siteCategories,url:this._options.displayUrl,style:St.ACTION_PANEL,_event_name:He.SITE_REPORT,browser:zt.browserTypeToString()}}]},{trigger:{identifier:He.SMA_REPUTATION,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:Xe,interaction_type:Qe,_event_name:He.SMA_REPUTATION,browser:zt.browserTypeToString(),site:this._options.site,color:St.GREEN,count:this._options[St.GREEN]}},{template:{analyticsSDK:!0,name:Xe,interaction_type:Qe,_event_name:He.SMA_REPUTATION,browser:zt.browserTypeToString(),site:this._options.site,color:St.RED,count:this._options[St.RED]}},{template:{analyticsSDK:!0,name:Xe,interaction_type:Qe,_event_name:He.SMA_REPUTATION,browser:zt.browserTypeToString(),site:this._options.site,color:St.YELLOW,count:this._options[St.YELLOW]}},{template:{analyticsSDK:!0,name:Xe,interaction_type:Qe,_event_name:He.SMA_REPUTATION,browser:zt.browserTypeToString(),site:this._options.site,color:St.UNKNOWN,count:this._options[St.UNKNOWN]}}]},{trigger:{identifier:He.TOAST,sendTelemetry:!0},messages:[{template:{_event_name:"ToastCheckCompleted",category:"ToastCheck",triggerType:"Impression",browser:zt.browserTypeToString()}},{template:{_event_name:"Secure_Search_Toast",category:"SecureSearchToast",action_type:"Impression",browser:zt.browserTypeToString(),provider:this._options.toastData?this._options.toastData.providerId:St.UNKNOWN,toastType:this._options.toastData?this._options.toastData.toastType:xe,metadata:this._options.toastData?this._options.toastData.metadata:St.DEFAULT}}]},{trigger:{identifier:He.TYPOSQUATTING,sendTelemetry:this._options.isFromBackground},messages:[{template:{analyticsSDK:!0,name:Ye,interaction_type:Qe,browser:zt.browserTypeToString(),_event_name:He.TYPOSQUATTING}}]},{trigger:{identifier:He.REMOTE_ACCESS_TROJAN,state:St.LOADED,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,name:He.REMOTE_ACCESS_TROJAN,interaction_type:Qe,browser:zt.browserTypeToString(!0),url:this._options.url,_event_name:He.REMOTE_ACCESS_TROJAN}}]},{trigger:{identifier:He.REMOTE_ACCESS_TROJAN,selector:"#rat_detection_got_it_btn",action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.REMOTE_ACCESS_TROJAN,interaction_type:nt.ACKNOWLEDGED,browser:zt.browserTypeToString(!0),url:this._options.url,_event_name:He.REMOTE_ACCESS_TROJAN}}]},{trigger:{identifier:He.REMOTE_ACCESS_TROJAN,selector:"#sidebar_rat_detection_whitelist_btn",action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.REMOTE_ACCESS_TROJAN,interaction_type:nt.WHITELISTED,browser:zt.browserTypeToString(!0),url:this._options.url,_event_name:He.REMOTE_ACCESS_TROJAN}}]},{trigger:{identifier:He.REMOTE_ACCESS_TROJAN,selector:"#sidebar-close",action:At.CLICK},messages:[{template:{analyticsSDK:!0,name:He.REMOTE_ACCESS_TROJAN,interaction_type:tt,browser:zt.browserTypeToString(!0),url:this._options.url,_event_name:He.REMOTE_ACCESS_TROJAN}}]},{trigger:{identifier:He.WSS_ANALYTICS,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.WSS_ANALYTICS,message:this._options.message}}]},{trigger:{identifier:He.DARK_WEB_SCAN,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.DARK_WEB_SCAN,category:He.DARK_WEB_SCAN,action_type:this._options.eventAction||St.UNKNOWN,browser:"un"===zt.browserTypeToString(!0)?St.UNKNOWN:zt.browserTypeToString(!0),count:this._options.count||St.UNKNOWN,type:this._options.type,flow_id:this._options.flowId}}]},{trigger:{identifier:He.APS.EVENT_NAME,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.APS.EVENT_NAME,name:He.APS.EVENT_NAME,action_type:Qe,browser:zt.browserTypeToString(!0),type:He.APS.TOAST,sequence:St.DEFAULT,trigger:St.DEFAULT,color:St.DEFAULT}}]},{trigger:{identifier:He.APS.IMPRESSION_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.APS.EVENT_NAME,name:He.APS.EVENT_NAME,action_type:Qe,browser:"un"===zt.browserTypeToString(!0)?St.UNKNOWN:zt.browserTypeToString(!0),type:He.APS.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:He.APS.IMPRESSION_HOVER,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.APS.EVENT_NAME,name:He.APS.EVENT_NAME,action_type:at,browser:"un"===zt.browserTypeToString(!0)?St.UNKNOWN:zt.browserTypeToString(!0),type:He.APS.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:He.APS.CLOSE_BALLOON,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.APS.EVENT_NAME,name:He.APS.EVENT_NAME,action_type:st,browser:"un"===zt.browserTypeToString(!0)?St.UNKNOWN:zt.browserTypeToString(!0),type:He.APS.BALLOON,sequence:this._options.sequence,trigger:this._options.trigger,color:this._options.color}}]},{trigger:{identifier:He.APS.TOAST_CLOSE,sendTelemetry:!0},messages:[{template:{analyticsSDK:!0,_event_name:He.APS.EVENT_NAME,name:He.APS.EVENT_NAME,action_type:this._options.gotItButton?ot:st,browser:"un"===zt.browserTypeToString(!0)?St.UNKNOWN:zt.browserTypeToString(!0),type:He.APS.TOAST,sequence:St.DEFAULT,trigger:St.DEFAULT,color:St.DEFAULT}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:this._options.isFromActivationPage||!1},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.ACTIVATION_ENROLLMENT_BANNER,trigger:ke.AUDIO_PLAYING,action:Me.NO_ACTION,is_interactive:!1,browser:zt.browserTypeToString(!0),interaction:Ie,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:"#mb_banner_activate_button",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.ACTIVATION_ENROLLMENT_BANNER,trigger:ke.ACTIVATE_BTN_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Oe,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:"#mb_banner_learn_more",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.ACTIVATION_ENROLLMENT_BANNER,trigger:ke.ACTIVATION_LEARM_MORE_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Ce,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:"#close_button",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:this._options.screenName,trigger:ke.X_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:be,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:this._options.isFromSuccessPage||!1},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.ACTIVATION_ENROLLMENT_BANNER_SUCCESS,trigger:ke.ACTIVATION_ACCEPT,action:Me.NO_ACTION,is_interactive:!1,browser:zt.browserTypeToString(!0),interaction:Ie,display_type:this._options.displayType,message_sequence:this._options.msgSequence,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"videoBannerShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.AI_ANNOTATION_BANNER,trigger:ke.AUDIO_PLAYING,action:Me.NO_ACTION,is_interactive:!1,browser:zt.browserTypeToString(!0),interaction:Ie,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.bannerNodeSelector||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.AI_ANNOTATION_BANNER,trigger:ke.ANNO_BANNER_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Oe,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.videoBannercloseBtn||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.AI_ANNOTATION_BANNER,trigger:ke.X_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:be,display_type:this._options.displayType,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"videoBannerHover"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.AI_ANNOTATION_BANNER,trigger:ke.ANNO_BANNER_HOVER,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Re,display_type:Pe.AI_ANNO_HOVER_BANNER,detection_status:this._options.aiAnnoType,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"videoBannerFadeAway"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.AI_ANNOTATION_BANNER,trigger:ke.ANNO_BANNER_FADE_AWAY,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:De,display_type:this._options.displayType,detection_status:Ae,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"dfdSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:this._options.initTriggerType,action:Me.NO_ACTION,is_interactive:!1,browser:zt.browserTypeToString(!0),interaction:Ie,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"snoozeOptionSelected"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:ke.SNOOZE_OPTION_SELECTED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Le,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.buyNowBtn||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:this._options.buyNowBtnClickedType,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Oe,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"dfdPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:ke.X_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:be,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"dfdToggleBtnClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:ke.AUDIO_DETECTION_TOGGLE_BTN_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:this._options.toggleType,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.backToEntryBtn||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:ke.DFD_PANEL_BACK_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:fe,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.mbBasicButton||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_PANEL,trigger:ke.DFD_PANEL_BASICS_BTN_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:Ce,audio_detection_state:this._options.audioDetectionState,time_scanned_minutes:this._options.scannedMinutes,time_flagged_minutes:this._options.flaggedMinutes,deepfake_detected_count:this._options.fakeDetectedCount,snooze_duration:this._options.snoozeDuration,is_trial:this._options.isTrial,days_to_expire:this._options.daysToExpire,graph_error_status:this._options.audioGraphStatus,number_of_days:this._options.totalActivatedDays,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"dfdFaqSidebarShow"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ge,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_FAQ_PANEL,trigger:this._options.triggerForMbFaq,action:Me.NO_ACTION,is_interactive:!1,browser:zt.browserTypeToString(!0),interaction:Ie,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,sendTelemetry:"dfdFaqPanelCloseClicked"===this._options.originFrom},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_FAQ_PANEL,trigger:ke.X_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:be,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.contactSupportLink||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_FAQ_PANEL,trigger:ke.DFD_FAQ_PANEL_SUPPORT_BTN_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:we,suite_csp_id:this._options.wpsCspClientId}}]},{trigger:{identifier:Ne.EVENT_NAME,selector:this._options.mbFaqBackBtn||"",action:At.CLICK},messages:[{template:{analyticsSDK:!0,_event_name:Ne.EVENT_NAME,type:ue,event_id:Ne.EVENT_ID,screen_name:Be.SIDEBAR_FAQ_PANEL,trigger:ke.DFD_FAQ_PANEL_BACK_CLICKED,action:Me.WA_INTERACTION,is_interactive:!0,browser:zt.browserTypeToString(!0),interaction:ve,suite_csp_id:this._options.wpsCspClientId}}]}]}}class Xt{static sendTelemetryMessages(t,n){const{sendTelemetry:i}=n.trigger,s=n.trigger.action,o=[At.CLICK];if(n.trigger.selector&&n.trigger.action)if(t.containerMeta){const e=t.containerMeta.query(n.trigger.selector);e&&e.addEventListener(n.trigger.action,a)}else $((()=>{const e=document.querySelector(n.trigger.selector);e&&e.addEventListener(n.trigger.action,a)}));else(i||n.trigger.state&&n.trigger.state===t.state)&&a();function a(a){n.messages.forEach((n=>{const r={...n.template},_=i&&(void 0===r.count||0!==r.count);let l=o.includes(s);if(s===At.KEYDOWN&&t.whitelistedKeys){const e=a.keyCode;l=t.whitelistedKeys.includes(e)}(_||l)&&(t.isFromBackground?Ht.messageDispatcher.sendTelemetry(JSON.stringify(r)):ae(e,{telemetry:JSON.stringify(r)}))}))}}static handle(e){new jt(e).fetchTelemetryHandlers(e.identifier).forEach((t=>{this.sendTelemetryMessages(e,t)}))}}const Jt="AI",Qt="NO_AI",Zt="FULL_BANNER",en="ON_HOVER",tn="ICON_ONLY",nn="afterend",sn="afterbegin";class on{constructor(e,t,n,i){this.waImageSecret=n,this.wpsCspClientId=i,this.strConvertor=new _e,this.colors={white:"#FFFFFF",red:"#C01818",black:"#343434"},this.bannerData={[Jt]:{bgc:this.colors.red,fontColor:this.colors.white,borderColor:"rgba(255, 255, 255, 0.4)",title:this.strConvertor.localeData("mb_video_banner_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_white.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/banner/ai_icon_white.svg")}?secret=${this.waImageSecret}`},[Qt]:{bgc:this.colors.white,fontColor:this.colors.black,borderColor:"rgba(110, 110, 110, 0.4)",title:this.strConvertor.localeData("mb_video_banner_no_AI_audio_title"),closeBtn:`${chrome.runtime.getURL("images/banner/close_icon_black.svg")}?secret=${this.waImageSecret}`,icon:`${chrome.runtime.getURL("images/banner/ai_icon_red.svg")}?secret=${this.waImageSecret}`}},this.bannerId=e,this.videoElement=t,this.bannerNode=null,this.payload=null,this.timer=null,this.bannerType=null,this.topParentNode=null,this.isParentDefaultP=!1,this.srcUrl=null,this.bannerDetails=null,this.options={identifier:Ne.EVENT_NAME,wpsCspClientId:Fe.toTlmWpsCspClientId(i)}}getBannerDetailsByVideoSize(){return this.videoElement.offsetWidth>=1081?(this.options.displayType=Pe.AI_ANNO_FULL_BANNER,{fontSize:22,lineHeight:37,bannerH:60,closeBtnH:30,aiIconSize:30,bannerAnimationType:Zt}):this.videoElement.offsetWidth>=721?(this.options.displayType=Pe.AI_ANNO_HOVER_BANNER,{fontSize:18,lineHeight:28,bannerH:46,closeBtnH:23,aiIconSize:23,bannerAnimationType:en}):this.videoElement.offsetWidth>=481?(this.options.displayType=Pe.AI_ANNO_HOVER_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:en}):(this.options.displayType=Pe.AI_ANNO_ICON_BANNER,{fontSize:15,lineHeight:23,bannerH:38,closeBtnH:19,aiIconSize:19,bannerAnimationType:tn})}init(e,t){this.payload=t,this.bannerType=e,this.bannerDetails=this.getBannerDetailsByVideoSize(),this.injectfont(),this.bannerNode=document.createElement("div"),this.bannerNode.setAttribute("id",`${this.bannerId}`),this.initBannerListeners(),this.setBannerElement(),this.appendBannerToVideoContainer(),window.addEventListener("resize",(()=>{this.updateBannerPosition()}),!1),window.addEventListener("scroll",(()=>{this.updateBannerPosition()}),!1);const{srcurl:n,topurl:i}=this.payload;this.srcUrl=n??i,this.options.originFrom="videoBannerShow",this.options.bannerNodeSelector=`#${this.bannerId}`,this.options.aiAnnoType=e===Jt?he:Ae,Xt.handle(this.options)}injectfont(){try{const e="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&family=Poppins:ital,wght@0,400;0,500;0,600;0,800;1,400;1,500;1,600;1,800&display=swap",t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)}catch(e){te.error(e)}}setBannerElement(){const{fontSize:e,closeBtnH:t,bannerH:i,lineHeight:s,aiIconSize:o,bannerAnimationType:a}=this.bannerDetails,r=this.bannerType;this.bannerType===Jt&&ae(n);const _=`\n      position: absolute;\n      top: 10px;\n      left: 10px;\n      padding-right: ${a===Zt?"8px":"0px"};\n      border-radius: ${i}px;\n      margin: 10px;\n      z-index: 2147483647;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      font-family: Poppins, Arial !important;\n      opacity: 1;\n      box-shadow: 0 4px 4px 0 rgba(0, 0, 0, 0.2);\n      height: ${i}px;\n      width:  ${i}px;\n      background-color: ${this.bannerData[r].bgc};\n      gap: 3px;\n      overflow: hidden;\n      -webkit-transition: all 0.3s ease-in-out;\n      -moz-transition: all 0.3s ease-in-out;\n      transition: all 0.3s ease-in-out;\n      -webkit-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n    `;this.bannerNode.style=_;const l=`\n      height: ${o}px;\n      width: ${o}px;\n    `,c=`\n      display: flex;\n      color: ${this.bannerData[r].fontColor}; \n      line-height: ${s}px; \n      font-size: ${e}px; \n      font-weight: 600;\n      text-wrap: nowrap;\n    `,d=`\n      display: flex; \n      align-items: center; \n      border-left: 1px solid ${this.bannerData[r].borderColor};\n      margin: 0px 13px;\n      min-width: ${t}px;\n      min-height: ${t}px;\n    `,p=`\n      <div style='position: relative; height: ${i}px; width: ${i}px;'>\n        <div style='position: absolute; height: ${i}px; width: ${i}px; display: flex; justify-content: center; align-items: center'>\n          <img id='videoBannerIcon' src='${this.bannerData[r].icon}' style='${l}' />\n        </div>\n        <div style='height: ${i}px; width: ${i}px;'></div>\n      </div>\n    `,E=`\n      <div id="videoBannerContentContainer" style='display: flex; align-items: center; opacity: 0;'>\n        <div id='videoBannerTitle' style='${c}'>${this.bannerData[r].title}</div>\n        <div id='videoBannerCloseBtn' style='${d}'>\n          <img src='${this.bannerData[r].closeBtn}' style='padding-left:${e-8}px; height:${t}px;'/>\n        </div>\n      </div>\n    `,T=`${p}${tn!==a?E:""}`;if(this.bannerNode.innerHTML=T,tn!==a){const e=this.bannerNode.querySelector("#videoBannerCloseBtn");e?.addEventListener("click",(e=>{this.options.closeBtnClicked=!0,e.stopPropagation(),this.hideBanner()})),e&&(this.options.videoBannercloseBtn="#videoBannerCloseBtn")}a===Zt&&setTimeout((()=>this.animateBanner(!0)),250),this.bannerType===Qt&&this.closeBannerOnTimeout(this.bannerType)}initBannerListeners(){this.bannerNode.addEventListener("click",(e=>{e.stopPropagation(),ae(t,{mbVideoId:this.payload.id});const{bannerAnimationType:n}=this.bannerDetails;tn===n&&this.hideBanner()})),this.bannerNode.addEventListener("mouseenter",(({currentTarget:e})=>{this.options.displayType===Pe.AI_ANNO_HOVER_BANNER&&(this.options.originFrom="videoBannerHover",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",Xt.handle(this.options)),this.handleMouseEnterLeave("mouseenter",e)})),this.bannerNode.addEventListener("mouseleave",(({currentTarget:e})=>{this.handleMouseEnterLeave("mouseleave",e)}))}handleMouseEnterLeave(e){const{bannerAnimationType:t}=this.bannerDetails;t===en&&this.animateBanner("mouseenter"===e),this.bannerType===Qt&&("mouseenter"===e&&clearTimeout(this.timer),"mouseleave"===e&&this.closeBannerOnTimeout(this.bannerType))}animateBanner(e=!0){const{bannerH:t}=this.bannerDetails,n=this.bannerNode.querySelector("#videoBannerContentContainer");n&&(this.bannerNode.style.width=e?`${n.offsetWidth+t}px`:`${t}px`,this.bannerNode.style.paddingRight=e?"8px":"0px",n.style.opacity=e?1:0)}closeBannerOnTimeout(){this.timer=setTimeout((()=>{this.hideBanner(),this.options.aiAnnoType!==Ae||this.options.closeBtnClicked||(this.options.originFrom="videoBannerFadeAway",this.options.bannerNodeSelector="",this.options.videoBannercloseBtn="",Xt.handle(this.options))}),3e3)}hideBanner(){const{bannerAnimationType:e}=this.bannerDetails;tn!==e&&this.animateBanner(!1),this.fadeOut(this.bannerNode,25,(()=>{this.bannerNode.innerHTML="",this.bannerNode.style.display="none"}))}updateBannerUI(e,t,n){this.srcUrl=t,this.payload=n,clearTimeout(this.timer),this.bannerType=e,this.setBannerElement(),this.updateBannerPosition()}appendBannerToVideoContainer(){this.topParentNode=(e=>{let t=e.parentElement;if(null===t)return e;let n=le(t);const i=le(e);let s=1,o=e;for(;null!==t&&i.top===n.top&&i.left===n.left&&s<3;)s++,o=t,t=t.parentElement,null!==t&&(n=le(t));return o})(this.videoElement),this.isParentDefaultP=["relative","fixed"].includes(window.getComputedStyle(this.topParentNode).getPropertyValue("position")),this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`;const e="VIDEO"===this.topParentNode.tagName?nn:sn;this.topParentNode.insertAdjacentElement(e,this.bannerNode)}fadeIn(e,t,n){this.fadeInTimer=setInterval((()=>{e.style.opacity<1?e.style.opacity+=.2:(clearInterval(this.fadeInTimer),n())}),t)}fadeOut(e,t,n){this.fadeOutTimer=setInterval((()=>{e.style.opacity>0?e.style.opacity-=.2:(clearInterval(this.fadeOutTimer),n())}),t)}updateBannerPosition(){this.bannerNode.style.top=`${this.isParentDefaultP?10:this.topParentNode.offsetTop}px`,this.bannerNode.style.left=`${this.isParentDefaultP?10:this.topParentNode.offsetLeft}px`}closeBanner(){this.bannerNode.innerHTML="",this.bannerNode.style.display="none"}}class an{constructor(){this.banners={}}showBannerOnVideo(e,t){const{finalresult:n,srcurl:i,topurl:s,waImageSecret:o,wpsCspClientId:a,id:r}=t;if(0===e.offsetWidth||0===e.offsetHeight)return;const _=this.convertToBannerId(r),l=n?Jt:Qt,{videoBanner:c}=this.getBannerById(_);if(!c){const n=new on(_,e,o,a);return n.init(l,t),this.banners[_]={videoElement:e,videoBanner:n},void te.log(`[MB:showBannerOnVideo] creating banner for bannerId=${_}, videoBanner.srcUrl=${n.srcUrl}`)}const d=i??s;e.src&&e.src!==d?te.log("[MB:showBannerOnVideo] video src changed, ignoring response from native to show banner."):c.bannerType!==l?d===c.srcUrl&&l!==Jt||(te.log(`[MB:showBannerOnVideo] already exists, updating UI for bannerId=${_}, updatedUrl=${d}, videoBanner.srcUrl=${c.srcUrl}`),c.updateBannerUI(l,d,t),this.banners[_]={videoElement:e,videoBanner:c}):te.debug("[MB:showBannerOnVideo] prevent same banner type from showing.")}getBannerById(e){for(const[t,{videoBanner:n}]of Object.entries(this.banners))if(e===t)return{videoBanner:n};return{}}removeBannerFromVideo(e){const t=this.convertToBannerId(e),{videoBanner:n}=this.getBannerById(t);n&&(delete this.banners[t],n.closeBanner())}convertToBannerId(e){return`m${e.replace(/[{} -]/g,"")}`}}(new class extends ie{constructor(){super(i),this.bannerHandler=new an,this.mockingbirdState=null}async main(){this.messageListener()}messageListener(){ne("WA",null,(({request:e,sendResponse:t})=>{switch(e.command){case s:{const{payload:n}=e;return this.showBanner(n),t({content:!0}),!0}case o:{const{payload:n}=e;return this.removeBanner(n.id),t({content:!0}),!0}case a:{const{status:t,enabled:n}=e;return this.mockingbirdState={status:t,enabled:n},void(!this.mockingbirdState||this.mockingbirdState.enabled&&this.mockingbirdState.status===x||this.removeAllBanners())}}}))}showBanner(e){try{const{id:t}=e,{element:n,capturing:i,permissionRequired:s}=window.audioMonitor.getById(t)||{};if(s)return;if(this.mockingbirdState&&(!this.mockingbirdState.enabled||this.mockingbirdState.status!==x))return;i&&n instanceof HTMLMediaElement?this.bannerHandler.showBannerOnVideo(n,e):i&&n instanceof HTMLAudioElement||n instanceof HTMLCanvasElement&&this.bannerHandler.showBannerOnVideo(n,e)}catch(e){te.warn(`[MB] showBanner err, ${e.message}`)}}removeBanner(e){try{this.bannerHandler.removeBannerFromVideo(e)}catch(e){te.warn(`[MB] removeBanner err, ${e.message}`)}}removeAllBanners(){(window.audioMonitor.audioInfos||[]).forEach((({id:e=null})=>this.removeBanner(e)))}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_mb_banner.js.map